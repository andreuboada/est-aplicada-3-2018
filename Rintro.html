<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Estadística Aplicada III</title>
  <meta name="description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)">
  <meta name="generator" content="bookdown 0.7.11 and GitBook 2.6.7">

  <meta property="og:title" content="Estadística Aplicada III" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)" />
  <meta name="github-repo" content="andreuboada/est-aplicada-3-2018" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Estadística Aplicada III" />
  
  <meta name="twitter:description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)" />
  

<meta name="author" content="Andreu Boada de Atela">


<meta name="date" content="2018-05-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="manipulacion-y-visualizacion-de-datos.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Aplicada III</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Temario y referencias</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluacion"><i class="fa fa-check"></i>Evaluación</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-r-y-rstudio"><i class="fa fa-check"></i>Software: R y Rstudio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#referencias-principales"><i class="fa fa-check"></i>Referencias principales</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#otras-referencias"><i class="fa fa-check"></i>Otras referencias</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#tareas"><i class="fa fa-check"></i>Tareas</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#por-que-un-analisis-multivariado"><i class="fa fa-check"></i><b>1.1</b> ¿Por qué un análisis multivariado?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#la-paradoja-de-simpson"><i class="fa fa-check"></i><b>1.2</b> La paradoja de Simpson</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#modelos-log-lineales"><i class="fa fa-check"></i><b>1.3</b> Modelos log-lineales</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#interpretacion-de-parametros"><i class="fa fa-check"></i><b>1.4</b> Interpretación de parámetros</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#ejemplo-dos-monedas"><i class="fa fa-check"></i><b>1.4.1</b> Ejemplo: dos monedas</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#otros-ejemplos"><i class="fa fa-check"></i><b>1.5</b> Otros ejemplos</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#discriminacion-de-residentes-hispanos-con-discapacidades"><i class="fa fa-check"></i><b>1.5.1</b> Discriminación de residentes hispanos con discapacidades</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#consumo-de-chocolate-y-premios-nobel"><i class="fa fa-check"></i><b>1.5.2</b> Consumo de chocolate y premios Nobel</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#tarea"><i class="fa fa-check"></i><b>1.6</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i><b>2</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="2.1" data-path="Rintro.html"><a href="Rintro.html#que-ventajas-tiene-r"><i class="fa fa-check"></i><b>2.1</b> ¿Qué ventajas tiene R?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="Rintro.html"><a href="Rintro.html#r-es-gratuito-y-de-codigo-abierto"><i class="fa fa-check"></i><b>2.1.1</b> R es gratuito y de código abierto</a></li>
<li class="chapter" data-level="2.1.2" data-path="Rintro.html"><a href="Rintro.html#r-tiene-una-comunidad-comprometida"><i class="fa fa-check"></i><b>2.1.2</b> R tiene una comunidad comprometida</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="Rintro.html"><a href="Rintro.html#flujo-basico-de-trabajo-para-el-analisis-de-datos-en-r."><i class="fa fa-check"></i><b>2.2</b> Flujo básico de trabajo para el análisis de datos en R.</a></li>
<li class="chapter" data-level="2.3" data-path="Rintro.html"><a href="Rintro.html#introduccion-a-r-como-lenguaje-de-programacion-y-la-plataforma-interactiva-de-rstudio."><i class="fa fa-check"></i><b>2.3</b> Introducción a R como lenguaje de programación, y la plataforma interactiva de RStudio.</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Rintro.html"><a href="Rintro.html#como-entender-r"><i class="fa fa-check"></i><b>2.3.1</b> ¿Cómo entender R?</a></li>
<li class="chapter" data-level="2.3.2" data-path="Rintro.html"><a href="Rintro.html#por-que-r"><i class="fa fa-check"></i><b>2.3.2</b> ¿Por qué R?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Rintro.html"><a href="Rintro.html#estructuras-de-datos"><i class="fa fa-check"></i><b>2.4</b> Estructuras de datos</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Rintro.html"><a href="Rintro.html#vectores"><i class="fa fa-check"></i><b>2.4.1</b> Vectores</a></li>
<li class="chapter" data-level="2.4.2" data-path="Rintro.html"><a href="Rintro.html#data-frames"><i class="fa fa-check"></i><b>2.4.2</b> Data Frames</a></li>
<li class="chapter" data-level="2.4.3" data-path="Rintro.html"><a href="Rintro.html#listas"><i class="fa fa-check"></i><b>2.4.3</b> Listas</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Rintro.html"><a href="Rintro.html#r-markdown"><i class="fa fa-check"></i><b>2.5</b> R Markdown</a><ul>
<li class="chapter" data-level="2.5.1" data-path="Rintro.html"><a href="Rintro.html#que-es-r-markdown"><i class="fa fa-check"></i><b>2.5.1</b> ¿Qué es R Markdown?</a></li>
<li class="chapter" data-level="2.5.2" data-path="Rintro.html"><a href="Rintro.html#estructura-basica-de-r-markdown"><i class="fa fa-check"></i><b>2.5.2</b> Estructura básica de R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="Rintro.html"><a href="Rintro.html#proyectos-de-rstudio"><i class="fa fa-check"></i><b>2.6</b> Proyectos de RStudio</a></li>
<li class="chapter" data-level="2.7" data-path="Rintro.html"><a href="Rintro.html#otros-aspectos-importantes-de-r"><i class="fa fa-check"></i><b>2.7</b> Otros aspectos importantes de R</a><ul>
<li class="chapter" data-level="2.7.1" data-path="Rintro.html"><a href="Rintro.html#valores-faltantes"><i class="fa fa-check"></i><b>2.7.1</b> Valores faltantes</a></li>
<li class="chapter" data-level="2.7.2" data-path="Rintro.html"><a href="Rintro.html#funciones"><i class="fa fa-check"></i><b>2.7.2</b> Funciones</a></li>
<li class="chapter" data-level="2.7.3" data-path="Rintro.html"><a href="Rintro.html#funcionales"><i class="fa fa-check"></i><b>2.7.3</b> Funcionales</a></li>
<li class="chapter" data-level="2.7.4" data-path="Rintro.html"><a href="Rintro.html#rendimiento-en-r"><i class="fa fa-check"></i><b>2.7.4</b> Rendimiento en R</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="Rintro.html"><a href="Rintro.html#tarea-1"><i class="fa fa-check"></i><b>2.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y visualización de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#el-principio-de-datos-limpios"><i class="fa fa-check"></i><b>3.1</b> El principio de datos limpios</a></li>
<li class="chapter" data-level="3.2" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#limpieza-de-datos"><i class="fa fa-check"></i><b>3.2</b> Limpieza de datos</a></li>
<li class="chapter" data-level="3.3" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#separa-aplica-combina"><i class="fa fa-check"></i><b>3.3</b> <em>Separa-aplica-combina</em></a></li>
<li class="chapter" data-level="3.4" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#muertes-por-armas-de-fuego-en-eua"><i class="fa fa-check"></i><b>3.4</b> Muertes por armas de fuego en EUA</a></li>
<li class="chapter" data-level="3.5" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#el-cuarteto-de-anscombe"><i class="fa fa-check"></i><b>3.5</b> El Cuarteto de Anscombe</a></li>
<li class="chapter" data-level="3.6" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#the-grammar-of-graphics-de-leland-wilkinson"><i class="fa fa-check"></i><b>3.6</b> The <em>Grammar of Graphics</em> de Leland Wilkinson</a></li>
<li class="chapter" data-level="3.7" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#ggplot"><i class="fa fa-check"></i><b>3.7</b> ggplot</a></li>
<li class="chapter" data-level="3.8" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#un-histograma-de-las-muertes-en-iraq"><i class="fa fa-check"></i><b>3.8</b> Un histograma de las muertes en Iraq</a></li>
<li class="chapter" data-level="3.9" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#inglehartwelzel-un-mapa-cultural-del-mundo"><i class="fa fa-check"></i><b>3.9</b> Inglehart–Welzel: un mapa cultural del mundo</a><ul>
<li class="chapter" data-level="3.9.1" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#creando-un-ggplot"><i class="fa fa-check"></i><b>3.9.1</b> Creando un ggplot</a></li>
<li class="chapter" data-level="3.9.2" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#mapeos-aesthetics"><i class="fa fa-check"></i><b>3.9.2</b> Mapeos: Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#poniendo-todo-junto"><i class="fa fa-check"></i><b>3.10</b> Poniendo todo junto</a></li>
<li class="chapter" data-level="3.11" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#tarea-2"><i class="fa fa-check"></i><b>3.11</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html"><i class="fa fa-check"></i><b>4</b> Teorema del Límite Central</a><ul>
<li class="chapter" data-level="4.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#la-distribucion-de-la-media"><i class="fa fa-check"></i><b>4.1</b> La distribución de la media</a></li>
<li class="chapter" data-level="4.2" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#de-donde-proviene-la-distribucion-normal"><i class="fa fa-check"></i><b>4.2</b> ¿De dónde proviene la distribución normal?</a><ul>
<li class="chapter" data-level="4.2.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#que-signo-tiene-c"><i class="fa fa-check"></i><b>4.2.1</b> ¿Qué signo tiene c?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#otras-observaciones"><i class="fa fa-check"></i><b>4.3</b> Otras observaciones</a></li>
<li class="chapter" data-level="4.4" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#diagramas-de-caja-y-brazos"><i class="fa fa-check"></i><b>4.4</b> Diagramas de caja y brazos</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-de-cuantiles-teoricos"><i class="fa fa-check"></i><b>4.5</b> Gráficas de cuantiles teóricos</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-normal"><i class="fa fa-check"></i>Ejemplo: normal</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-de-cuantiles-para-un-conjunto-de-datos"><i class="fa fa-check"></i><b>4.6</b> Gráficas de cuantiles para un conjunto de datos</a><ul>
<li class="chapter" data-level="4.6.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#que-buscar-en-una-grafica-de-cuantiles"><i class="fa fa-check"></i><b>4.6.1</b> ¿Qué buscar en una gráfica de cuantiles?</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-qq-normales"><i class="fa fa-check"></i><b>4.7</b> Gráficas qq-normales</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-cantantes"><i class="fa fa-check"></i>Ejemplo: cantantes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#el-tlc-y-errores-estandar"><i class="fa fa-check"></i><b>4.8</b> El TLC y errores estándar</a></li>
<li class="chapter" data-level="4.9" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-1"><i class="fa fa-check"></i><b>4.9</b> Ejemplo</a></li>
<li class="chapter" data-level="4.10" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#tarea-3"><i class="fa fa-check"></i><b>4.10</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html"><i class="fa fa-check"></i><b>5</b> Análisis de datos categóricos</a><ul>
<li class="chapter" data-level="5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#repaso-y-algunos-conceptos"><i class="fa fa-check"></i><b>5.1</b> Repaso y algunos conceptos</a><ul>
<li class="chapter" data-level="5.1.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#caso-binomial"><i class="fa fa-check"></i><b>5.1.1</b> Caso binomial</a></li>
<li class="chapter" data-level="" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#estimacion-de-parametros-multinomiales"><i class="fa fa-check"></i>Estimación de parámetros multinomiales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-chi2-de-pearson-de-una-multinomial"><i class="fa fa-check"></i><b>5.2</b> La <span class="math inline">\(\chi^2\)</span> de Pearson de una multinomial</a><ul>
<li class="chapter" data-level="5.2.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#cociente-de-verosimilitud-de-una-multinomial"><i class="fa fa-check"></i><b>5.2.1</b> Cociente de verosimilitud de una multinomial</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#definiciones"><i class="fa fa-check"></i><b>5.3</b> Definiciones</a><ul>
<li class="chapter" data-level="5.3.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#notacion"><i class="fa fa-check"></i><b>5.3.1</b> Notación</a></li>
<li class="chapter" data-level="5.3.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#razon-de-momios"><i class="fa fa-check"></i><b>5.3.2</b> Razón de momios</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#asociacion-en-tablas-de-tamano-itimes-j"><i class="fa fa-check"></i><b>5.4</b> Asociación en tablas de tamaño <span class="math inline">\(I\times J\)</span></a><ul>
<li class="chapter" data-level="5.4.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#razones-de-momios-en-tablas-itimes-j"><i class="fa fa-check"></i><b>5.4.1</b> Razones de momios en tablas <span class="math inline">\(I\times J\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-mushrooms"><i class="fa fa-check"></i><b>5.4.2</b> Ejemplo: mushrooms</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#intervalos-de-confianza-para-los-parametros-de-asociacion"><i class="fa fa-check"></i><b>5.5</b> Intervalos de confianza para los parámetros de asociación</a><ul>
<li class="chapter" data-level="5.5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#error-estandar-de-la-razon-de-momios"><i class="fa fa-check"></i><b>5.5.1</b> Error estándar de la razón de momios</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-de-independencia"><i class="fa fa-check"></i><b>5.6</b> Prueba de independencia</a><ul>
<li class="chapter" data-level="5.6.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-prueba-chi2-de-pearson"><i class="fa fa-check"></i><b>5.6.1</b> La prueba <span class="math inline">\(\chi^2\)</span> de Pearson</a></li>
<li class="chapter" data-level="5.6.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-brecha-de-genero"><i class="fa fa-check"></i><b>5.6.2</b> Ejemplo: brecha de género</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#general-social-survey-1972---2016"><i class="fa fa-check"></i><b>5.7</b> General Social Survey 1972 - 2016</a></li>
<li class="chapter" data-level="5.8" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-catadora-de-te"><i class="fa fa-check"></i><b>5.8</b> La catadora de té</a></li>
<li class="chapter" data-level="5.9" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-multinomiales-para-conteos"><i class="fa fa-check"></i><b>5.9</b> Modelos multinomiales para conteos</a></li>
<li class="chapter" data-level="5.10" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-log-lineales-con-tres-variables-categoricas"><i class="fa fa-check"></i><b>5.10</b> Modelos log lineales con tres variables categóricas</a><ul>
<li class="chapter" data-level="5.10.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tipos-de-independencia"><i class="fa fa-check"></i><b>5.10.1</b> Tipos de independencia</a></li>
<li class="chapter" data-level="5.10.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#asociacion-homogenea-e-interacciones-de-3-factores"><i class="fa fa-check"></i><b>5.10.2</b> Asociación homogénea e interacciones de 3 factores</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-sensitividad-y-especificidad"><i class="fa fa-check"></i><b>5.11</b> Ejemplo: sensitividad y especificidad</a></li>
<li class="chapter" data-level="5.12" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-horoscopos"><i class="fa fa-check"></i><b>5.12</b> Ejemplo: horóscopos</a></li>
<li class="chapter" data-level="5.13" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tarea-opcional"><i class="fa fa-check"></i><b>5.13</b> Tarea (opcional)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html"><i class="fa fa-check"></i><b>6</b> Regresión logística 1</a><ul>
<li class="chapter" data-level="6.1" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#regresion-logistica-con-un-solo-predictor"><i class="fa fa-check"></i><b>6.1</b> Regresión logística con un solo predictor</a></li>
<li class="chapter" data-level="6.2" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#el-modelo-de-regresion-logistica"><i class="fa fa-check"></i><b>6.2</b> El modelo de regresión logística</a><ul>
<li class="chapter" data-level="6.2.1" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#funcion-logistica"><i class="fa fa-check"></i><b>6.2.1</b> Función logística</a></li>
<li class="chapter" data-level="" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#tarea-4"><i class="fa fa-check"></i><b>6.3</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html"><i class="fa fa-check"></i><b>7</b> Regresión logística 2</a><ul>
<li class="chapter" data-level="7.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#incertidumbre-en-la-estimacion"><i class="fa fa-check"></i><b>7.1</b> Incertidumbre en la estimación</a></li>
<li class="chapter" data-level="7.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#funcion-logistica-1"><i class="fa fa-check"></i><b>7.2</b> Función logística</a></li>
<li class="chapter" data-level="7.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes"><i class="fa fa-check"></i><b>7.3</b> Interpretación de los coeficientes</a><ul>
<li class="chapter" data-level="7.3.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#evaluar-en-o-alrededor-de-la-media"><i class="fa fa-check"></i><b>7.3.1</b> Evaluar en (o alrededor de) la media</a></li>
<li class="chapter" data-level="7.3.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#la-regla-de-dividir-entre-4"><i class="fa fa-check"></i><b>7.3.2</b> La regla de “dividir entre 4”</a></li>
<li class="chapter" data-level="7.3.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes-como-cocientes-de-momios"><i class="fa fa-check"></i><b>7.3.3</b> Interpretación de los coeficientes como cocientes de momios</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ejemplo-pozos-en-bangladesh"><i class="fa fa-check"></i><b>7.4</b> Ejemplo: pozos en Bangladesh</a><ul>
<li class="chapter" data-level="7.4.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#descripcion-del-problema"><i class="fa fa-check"></i><b>7.4.1</b> Descripción del problema</a></li>
<li class="chapter" data-level="7.4.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#antecedentes-del-problema"><i class="fa fa-check"></i><b>7.4.2</b> Antecedentes del problema</a></li>
<li class="chapter" data-level="7.4.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#metodologia-para-abordar-el-problema"><i class="fa fa-check"></i><b>7.4.3</b> Metodología para abordar el problema</a></li>
<li class="chapter" data-level="7.4.4" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ajuste-y-resultados-del-modelo"><i class="fa fa-check"></i><b>7.4.4</b> Ajuste y resultados del modelo</a></li>
<li class="chapter" data-level="7.4.5" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes-1"><i class="fa fa-check"></i><b>7.4.5</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="7.4.6" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#agregamos-una-segunda-variable-de-entrada"><i class="fa fa-check"></i><b>7.4.6</b> Agregamos una segunda variable de entrada</a></li>
<li class="chapter" data-level="7.4.7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#comparacion-de-coeficientes-cuando-anades-un-predictor"><i class="fa fa-check"></i><b>7.4.7</b> Comparación de coeficientes cuando añades un predictor</a></li>
<li class="chapter" data-level="7.4.8" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#graficar-el-modelo-ajustado-con-dos-predictores"><i class="fa fa-check"></i><b>7.4.8</b> Graficar el modelo ajustado con dos predictores</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ajuste-de-coeficientes-para-regresion-logistica-binomial."><i class="fa fa-check"></i><b>7.5</b> Ajuste de coeficientes para regresión logística (binomial).</a></li>
<li class="chapter" data-level="7.6" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#descenso-en-gradiente"><i class="fa fa-check"></i><b>7.6</b> Descenso en gradiente</a><ul>
<li class="chapter" data-level="7.6.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#seleccion-de-tamano-de-paso-eta"><i class="fa fa-check"></i><b>7.6.1</b> Selección de tamaño de paso <span class="math inline">\(\eta\)</span></a></li>
<li class="chapter" data-level="7.6.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#funciones-de-varias-variables"><i class="fa fa-check"></i><b>7.6.2</b> Funciones de varias variables</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ejemplo-diabetes"><i class="fa fa-check"></i><b>7.7</b> Ejemplo: diabetes</a></li>
<li class="chapter" data-level="7.8" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#observaciones-adicionales"><i class="fa fa-check"></i><b>7.8</b> Observaciones adicionales</a></li>
<li class="chapter" data-level="7.9" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#regresion-logistica-para-problemas-de-mas-de-2-clases"><i class="fa fa-check"></i><b>7.9</b> Regresión logística para problemas de más de 2 clases</a></li>
<li class="chapter" data-level="7.10" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#regresion-logistica-multinomial"><i class="fa fa-check"></i><b>7.10</b> Regresión logística multinomial</a></li>
<li class="chapter" data-level="7.11" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#identificabilidad-y-separacion"><i class="fa fa-check"></i><b>7.11</b> Identificabilidad y separación</a></li>
<li class="chapter" data-level="7.12" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#tarea-5"><i class="fa fa-check"></i><b>7.12</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html"><i class="fa fa-check"></i><b>8</b> Regresión logística 3</a><ul>
<li class="chapter" data-level="8.1" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#ejemplo-oscares"><i class="fa fa-check"></i><b>8.1</b> Ejemplo óscares</a></li>
<li class="chapter" data-level="8.2" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#repaso-de-regresion-logistica"><i class="fa fa-check"></i><b>8.2</b> Repaso de regresión logística</a></li>
<li class="chapter" data-level="8.3" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#regresion-logistica-con-interacciones"><i class="fa fa-check"></i><b>8.3</b> Regresión logística con interacciones</a></li>
<li class="chapter" data-level="8.4" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#graficas-del-modelo-con-interacciones"><i class="fa fa-check"></i><b>8.4</b> Gráficas del modelo con interacciones</a></li>
<li class="chapter" data-level="8.5" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#agregar-mas-predictores"><i class="fa fa-check"></i><b>8.5</b> Agregar más predictores</a></li>
<li class="chapter" data-level="8.6" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#evaluacion-de-modelos-de-regresion-logistica"><i class="fa fa-check"></i><b>8.6</b> Evaluación de modelos de regresión logística</a><ul>
<li class="chapter" data-level="8.6.1" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#graficas-de-residuales-agrupados-vs-predictores"><i class="fa fa-check"></i><b>8.6.1</b> Gráficas de residuales agrupados vs predictores</a></li>
<li class="chapter" data-level="8.6.2" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#transformaciones"><i class="fa fa-check"></i><b>8.6.2</b> Transformaciones</a></li>
<li class="chapter" data-level="8.6.3" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#tasa-de-error-y-comparacion-contra-el-modelo-nulo"><i class="fa fa-check"></i><b>8.6.3</b> Tasa de error y comparación contra el modelo nulo</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#diferencias-predictivas-promedio-en-la-escala-de-probabilidad"><i class="fa fa-check"></i><b>8.7</b> Diferencias predictivas promedio en la escala de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#diferencias-predictivas-promedio-en-presencia-de-interacciones"><i class="fa fa-check"></i>Diferencias predictivas promedio en presencia de interacciones</a></li>
<li class="chapter" data-level="" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#notacion-general-para-diferencias-predictivas"><i class="fa fa-check"></i>Notación general para diferencias predictivas</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#tarea-6"><i class="fa fa-check"></i><b>8.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regularizacion.html"><a href="regularizacion.html"><i class="fa fa-check"></i><b>9</b> Regularización</a><ul>
<li class="chapter" data-level="9.1" data-path="regularizacion.html"><a href="regularizacion.html#repaso"><i class="fa fa-check"></i><b>9.1</b> Repaso</a></li>
<li class="chapter" data-level="9.2" data-path="regularizacion.html"><a href="regularizacion.html#otras-medidas-de-clasificacion"><i class="fa fa-check"></i><b>9.2</b> Otras medidas de clasificación</a></li>
<li class="chapter" data-level="9.3" data-path="regularizacion.html"><a href="regularizacion.html#analisis-de-error-en-clasificacion-binaria"><i class="fa fa-check"></i><b>9.3</b> Análisis de error en clasificación binaria</a><ul>
<li class="chapter" data-level="9.3.1" data-path="regularizacion.html"><a href="regularizacion.html#punto-de-corte-para-un-clasificador-binario"><i class="fa fa-check"></i><b>9.3.1</b> Punto de corte para un clasificador binario</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regularizacion.html"><a href="regularizacion.html#curvas-roc"><i class="fa fa-check"></i><b>9.4</b> Curvas ROC</a><ul>
<li class="chapter" data-level="9.4.1" data-path="regularizacion.html"><a href="regularizacion.html#espacio-roc"><i class="fa fa-check"></i><b>9.4.1</b> Espacio ROC</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-1"><i class="fa fa-check"></i><b>9.5</b> Regularización</a><ul>
<li class="chapter" data-level="9.5.1" data-path="regularizacion.html"><a href="regularizacion.html#reduciendo-varianza-de-los-coeficientes"><i class="fa fa-check"></i><b>9.5.1</b> Reduciendo varianza de los coeficientes</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-ridge"><i class="fa fa-check"></i><b>9.6</b> Regularización Ridge</a><ul>
<li class="chapter" data-level="9.6.1" data-path="regularizacion.html"><a href="regularizacion.html#seleccion-de-coeficiente-de-regularizacion"><i class="fa fa-check"></i><b>9.6.1</b> Selección de coeficiente de regularización</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-lasso"><i class="fa fa-check"></i><b>9.7</b> Regularización Lasso</a></li>
<li class="chapter" data-level="9.8" data-path="regularizacion.html"><a href="regularizacion.html#tarea-7"><i class="fa fa-check"></i><b>9.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>10</b> Modelos lineales generalizados</a><ul>
<li class="chapter" data-level="10.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#regresion-lineal-y-logistica"><i class="fa fa-check"></i><b>10.1</b> Regresión lineal y logística</a></li>
<li class="chapter" data-level="10.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#otros-modelos"><i class="fa fa-check"></i><b>10.2</b> Otros modelos</a></li>
<li class="chapter" data-level="10.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-accidentes-de-trafico"><i class="fa fa-check"></i><b>10.3</b> Ejemplo: accidentes de tráfico</a></li>
<li class="chapter" data-level="10.4" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#interpretacion-de-coeficientes-poisson"><i class="fa fa-check"></i><b>10.4</b> Interpretación de coeficientes Poisson</a></li>
<li class="chapter" data-level="10.5" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#diferencias-entre-el-modelo-binomial-y-poisson"><i class="fa fa-check"></i><b>10.5</b> Diferencias entre el modelo binomial y Poisson</a></li>
<li class="chapter" data-level="10.6" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-fertilidad-en-fiji"><i class="fa fa-check"></i><b>10.6</b> Ejemplo: fertilidad en Fiji</a></li>
<li class="chapter" data-level="10.7" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#variable-de-expuestos-offset"><i class="fa fa-check"></i><b>10.7</b> Variable de expuestos (offset)</a></li>
<li class="chapter" data-level="10.8" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplos-seguros"><i class="fa fa-check"></i><b>10.8</b> Ejemplos: seguros</a><ul>
<li class="chapter" data-level="" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#numero-de-expuestos-interpretacion"><i class="fa fa-check"></i>Número de expuestos (interpretación)</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-arboles"><i class="fa fa-check"></i><b>10.9</b> Ejemplo: árboles</a></li>
<li class="chapter" data-level="10.10" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#sobredispersion"><i class="fa fa-check"></i><b>10.10</b> Sobredispersión</a></li>
<li class="chapter" data-level="10.11" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-numero-de-publicaciones"><i class="fa fa-check"></i><b>10.11</b> Ejemplo: número de publicaciones</a></li>
<li class="chapter" data-level="10.12" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#tarea-8"><i class="fa fa-check"></i><b>10.12</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html"><i class="fa fa-check"></i><b>11</b> Discriminante Lineal (LDA) 1</a><ul>
<li class="chapter" data-level="11.1" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#problemas-de-clasificacion"><i class="fa fa-check"></i><b>11.1</b> Problemas de clasificación</a></li>
<li class="chapter" data-level="11.2" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#funciones-de-discriminante"><i class="fa fa-check"></i><b>11.2</b> Funciones de discriminante</a></li>
<li class="chapter" data-level="11.3" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#regresion-lineal-en-una-matriz-indicadora"><i class="fa fa-check"></i><b>11.3</b> Regresión lineal en una matriz indicadora</a></li>
<li class="chapter" data-level="11.4" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#discriminante-lineal-de-fisher"><i class="fa fa-check"></i><b>11.4</b> Discriminante lineal de Fisher</a><ul>
<li class="chapter" data-level="11.4.1" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#ejemplo-separacion-entre-clases"><i class="fa fa-check"></i><b>11.4.1</b> Ejemplo: separación entre clases</a></li>
<li class="chapter" data-level="11.4.2" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#ejemplo-iris-de-fisher"><i class="fa fa-check"></i><b>11.4.2</b> Ejemplo: iris de Fisher</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#tarea-9"><i class="fa fa-check"></i><b>11.5</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html"><i class="fa fa-check"></i><b>12</b> Discriminante Lineal (LDA) 2</a><ul>
<li class="chapter" data-level="12.1" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#aplicaciones"><i class="fa fa-check"></i><b>12.1</b> Aplicaciones</a></li>
<li class="chapter" data-level="12.2" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#ejemplo-vinos"><i class="fa fa-check"></i><b>12.2</b> Ejemplo: vinos</a></li>
<li class="chapter" data-level="12.3" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#ejemplo-admisiones-al-mba"><i class="fa fa-check"></i><b>12.3</b> Ejemplo: admisiones al MBA</a></li>
<li class="chapter" data-level="12.4" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#repaso-1"><i class="fa fa-check"></i><b>12.4</b> Repaso</a><ul>
<li><a href="discriminante-lineal-lda-2.html#caso-k2">Caso <span class="math inline">\(k=2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#supuestos-probabilisticos"><i class="fa fa-check"></i><b>12.5</b> Supuestos probabilísticos</a></li>
<li class="chapter" data-level="12.6" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#relacion-con-minimos-cuadrados"><i class="fa fa-check"></i><b>12.6</b> Relación con mínimos cuadrados</a></li>
<li class="chapter" data-level="12.7" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#tarea-10"><i class="fa fa-check"></i><b>12.7</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html"><i class="fa fa-check"></i><b>13</b> Componentes Principales 1</a><ul>
<li class="chapter" data-level="13.1" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#motivacion"><i class="fa fa-check"></i><b>13.1</b> Motivación</a></li>
<li class="chapter" data-level="13.2" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#formulacion-de-maxima-varianza"><i class="fa fa-check"></i><b>13.2</b> Formulación de máxima varianza</a></li>
<li class="chapter" data-level="13.3" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#formulacion-de-error-minimo"><i class="fa fa-check"></i><b>13.3</b> Formulación de error mínimo</a></li>
<li class="chapter" data-level="13.4" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#aplicaciones-de-pca"><i class="fa fa-check"></i><b>13.4</b> Aplicaciones de PCA</a><ul>
<li class="chapter" data-level="13.4.1" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#compresion-de-datos"><i class="fa fa-check"></i><b>13.4.1</b> Compresión de datos</a></li>
<li class="chapter" data-level="13.4.2" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#ejemplo-compresion-de-una-imagen"><i class="fa fa-check"></i><b>13.4.2</b> Ejemplo: compresión de una imagen</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#tarea-11"><i class="fa fa-check"></i><b>13.5</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html"><i class="fa fa-check"></i><b>14</b> Componentes Principales 2</a><ul>
<li class="chapter" data-level="14.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#pca-probabilistico-y-analisis-de-factores"><i class="fa fa-check"></i><b>14.1</b> PCA probabilístico y Análisis de Factores</a><ul>
<li class="chapter" data-level="14.1.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores"><i class="fa fa-check"></i><b>14.1.1</b> Análisis de factores</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores-descripcion-tradicional"><i class="fa fa-check"></i><b>14.2</b> Análisis de factores (descripción tradicional)</a><ul>
<li class="chapter" data-level="14.2.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#el-modelo"><i class="fa fa-check"></i><b>14.2.1</b> El modelo</a></li>
<li class="chapter" data-level="14.2.2" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#estimacion-del-modelo"><i class="fa fa-check"></i><b>14.2.2</b> Estimación del modelo</a></li>
<li class="chapter" data-level="14.2.3" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores-de-maxima-verosimilitud"><i class="fa fa-check"></i><b>14.2.3</b> Análisis de factores de máxima verosimilitud</a></li>
<li class="chapter" data-level="14.2.4" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#evaluacion-del-modelo"><i class="fa fa-check"></i><b>14.2.4</b> Evaluación del modelo</a></li>
<li class="chapter" data-level="14.2.5" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#visualizacion"><i class="fa fa-check"></i><b>14.2.5</b> Visualización</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#tarea-12"><i class="fa fa-check"></i><b>14.3</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html"><i class="fa fa-check"></i><b>15</b> Correlación Canónica (CCA)</a><ul>
<li class="chapter" data-level="15.1" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#cca-vs-pca"><i class="fa fa-check"></i><b>15.1</b> CCA vs PCA</a></li>
<li class="chapter" data-level="15.2" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#variables-y-correlaciones-canonicas"><i class="fa fa-check"></i><b>15.2</b> Variables y correlaciones canónicas</a><ul>
<li class="chapter" data-level="15.2.1" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#combinaciones-lineaes-de-factores"><i class="fa fa-check"></i><b>15.2.1</b> Combinaciones lineaes de factores</a></li>
<li class="chapter" data-level="15.2.2" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#ejemplo-simple"><i class="fa fa-check"></i><b>15.2.2</b> Ejemplo simple</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#ejemplo-test-psicologico"><i class="fa fa-check"></i><b>15.3</b> Ejemplo: test psicológico</a></li>
<li class="chapter" data-level="15.4" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#ejemplo-fenomenos-meteorologicos"><i class="fa fa-check"></i><b>15.4</b> Ejemplo: fenómenos meteorológicos</a></li>
<li class="chapter" data-level="15.5" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#tarea-13"><i class="fa fa-check"></i><b>15.5</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html"><i class="fa fa-check"></i><b>16</b> Conglomerados (clustering) 1</a><ul>
<li class="chapter" data-level="16.1" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#introduccion"><i class="fa fa-check"></i><b>16.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#enfoques-combinatorio-y-basado-en-modelos."><i class="fa fa-check"></i><b>16.2</b> Enfoques: combinatorio y basado en modelos.</a></li>
<li class="chapter" data-level="16.3" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#k-medias"><i class="fa fa-check"></i><b>16.3</b> K-medias</a><ul>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#algoritmo-de-k-medias"><i class="fa fa-check"></i>Algoritmo de k-medias</a></li>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
<li><a href="conglomerados-clustering-1.html#usando-la-funcion-kmeans">Usando la funcion <code>kmeans</code></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#seleccion-de-numero-de-clusters."><i class="fa fa-check"></i><b>16.4</b> Selección de número de clusters.</a><ul>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#variacion-dentro-de-clusters-para-distintas-soluciones"><i class="fa fa-check"></i>Variación dentro de clusters para distintas soluciones</a></li>
<li class="chapter" data-level="16.4.1" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#criterios-especificos"><i class="fa fa-check"></i><b>16.4.1</b> Criterios específicos</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#dificultades-en-segmentacionclustering."><i class="fa fa-check"></i><b>16.5</b> Dificultades en segmentación/clustering.</a><ul>
<li class="chapter" data-level="16.5.1" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#estructuras-no-compactas"><i class="fa fa-check"></i><b>16.5.1</b> Estructuras no compactas</a></li>
<li class="chapter" data-level="16.5.2" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#existencia-o-no-de-grupos-naturales"><i class="fa fa-check"></i><b>16.5.2</b> Existencia o no de grupos “naturales”</a></li>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#grupos-en-dimension-alta"><i class="fa fa-check"></i>Grupos en dimensión alta</a></li>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#dificultades-en-la-seleccion-de-metrica"><i class="fa fa-check"></i>Dificultades en la selección de métrica</a></li>
</ul></li>
<li class="chapter" data-level="16.6" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#tarea-14"><i class="fa fa-check"></i><b>16.6</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html"><i class="fa fa-check"></i><b>17</b> Conglomerados (clustering) 2</a><ul>
<li class="chapter" data-level="17.1" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#clustering-jerarquico"><i class="fa fa-check"></i><b>17.1</b> Clustering jerárquico</a></li>
<li class="chapter" data-level="17.2" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#metodos-de-enlace-cluster-linkage"><i class="fa fa-check"></i><b>17.2</b> Métodos de enlace (Cluster Linkage)</a><ul>
<li class="chapter" data-level="17.2.1" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#enlace-simple"><i class="fa fa-check"></i><b>17.2.1</b> Enlace simple</a></li>
<li class="chapter" data-level="17.2.2" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#enlace-completo"><i class="fa fa-check"></i><b>17.2.2</b> Enlace completo</a></li>
<li class="chapter" data-level="17.2.3" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#enlace-promedio"><i class="fa fa-check"></i><b>17.2.3</b> Enlace promedio</a></li>
</ul></li>
<li class="chapter" data-level="17.3" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#ejemplo-genes-de-tejidos"><i class="fa fa-check"></i><b>17.3</b> Ejemplo: genes de tejidos</a></li>
<li class="chapter" data-level="17.4" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#mapas-de-calor"><i class="fa fa-check"></i><b>17.4</b> Mapas de calor</a></li>
<li class="chapter" data-level="17.5" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#metodo-de-ward"><i class="fa fa-check"></i><b>17.5</b> Método de Ward</a></li>
<li class="chapter" data-level="17.6" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#tarea-15"><i class="fa fa-check"></i><b>17.6</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Aplicada III</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Rintro" class="section level1">
<h1><span class="header-section-number">Clase 2</span> Temas selectos de R</h1>
<style>
  .espacio {
     margin-bottom: 1cm;
  }
</style>
<style>
  .espacio3 {
     margin-bottom: 3cm;
  }
</style>
<p>El lenguaje de programación <a href="https://cran.r-project.org">R</a> ha surgido como un avance en el desarrollo de software para análisis estadítico. Hace unos años era común el uso de productos de software proprietario, tales como <a href="https://www.aptech.com/">GAUSS</a>, <a href="https://estima.com/ratsmain.shtml">RATS</a>, <a href="http://www.eviews.com/home.html">EVIEWS</a>, <a href="https://www.ibm.com/products/spss-statistics">SPSS</a>, <a href="https://www.sas.com/es_mx/home.html">SAS</a>, <a href="https://www.mathworks.com/products/matlab.html">Matlab</a>, <a href="http://www.minitab.com/en-us/products/minitab/">Minitab</a>, <a href="https://www.stata.com/">Stata</a> y software que en principio ni siquiera es apropiado para el análisis de datos, como Microsoft Excel. Estos programas generalmente son demasiado costosos y tienen un rendimiento bajo. Si es necesario hacer un análisis más complejo, entonces los archivos se vuelven demasiado grandes y el todo el proceso se vuelve infactible.</p>
<div id="que-ventajas-tiene-r" class="section level2">
<h2><span class="header-section-number">2.1</span> ¿Qué ventajas tiene R?</h2>
<p>R es la herramienta más sobresaliente para la estadística, el análisis de datos y el aprendizaje estadístico. Es más que un paquete estadístico; es un <em>lenguaje de programación</em>, por lo que puede crear sus propios objetos, funciones y paquetes.</p>
<p>Hablando de paquetes, hay más de 12,000 innovadores paquetes aportados por los usuarios, y que están disponibles en <a href="https://cran.r-project.org/">CRAN</a> (The Comprehensive R Archive Network), eso sin mencionar <a href="https://www.bioconductor.org/">Bioconductor</a>. Para tener una idea de qué paquetes hay disponibles, puedes leer posts en <a href="https://www.r-bloggers.com/">R-bloggers</a> y ver el <a href="https://www.rstudio.com/products/shiny/shiny-user-showcase/"></a>. Muchos paquetes son enviados por miembros prominentes de sus respectivos campos.</p>
<p>Al igual que todos los programas, los programas de R documentan explícitamente los pasos de su análisis y esto facilita la reproducibilidad del análisis estadístico. Además, provee de herramientas para probar rápidamente muchas ideas y corregir fácilmente los problemas que puedan surgir.</p>
<p>R puedes usarlo fácilmente en cualquier lugar. Es independiente de la plataforma, por lo que puede usarlo en cualquier sistema operativo. Y es gratis, por lo que puede usarlo en cualquier empleador sin tener que persuadir a su jefe para comprar una licencia.</p>
<div id="r-es-gratuito-y-de-codigo-abierto" class="section level3">
<h3><span class="header-section-number">2.1.1</span> R es gratuito y de código abierto</h3>
<p>R está disponible bajo una licencia de código abierto, lo que significa que cualquiera puede descargar y modificar el código. Esta libertad a menudo se conoce como la de software libre (“free as in speech”). R también está disponible de manera gratuita (“free as in beer”). En términos prácticos, esto significa que podemos descargar y usar R gratis.</p>
<p>Otro beneficio, aunque un poco más indirecto, es que cualquiera puede acceder al código fuente, modificarlo y mejorarlo. Como resultado, muchos programadores excelentes han contribuido con mejoras y correcciones al código de R. Por esta razón, R es muy <em>estable</em> y <em>confiable</em>.</p>
<p>Cualquier libertad también tiene asociadas ciertas obligaciones. En el caso de R, estas obligaciones se describen en las condiciones de la licencia bajo la cual se publica: Licencia Pública General de GNU (GPL), Versión 2. Estas obligaciones te pertienen si solamente haces <em>uso</em> de R. Sin embargo, si haces cambios en su código fuente R y lo <em>redistribuyes</em>, entonces estos cambios se deben poner a disposición de todos los usuarios.</p>
</div>
<div id="r-tiene-una-comunidad-comprometida" class="section level3">
<h3><span class="header-section-number">2.1.2</span> R tiene una comunidad comprometida</h3>
<p>Muchas personas que usan R eventualmente comienzan a ayudar a los nuevos usuarios y proponen el uso de R en sus lugares de trabajo y círculos profesionales. Por ejemplo, si tienes dudas sobre algún aspecto de R, podrás encontrar ayuda en <a href="http://www.stackoverflow.com/questions/tagged/r">Stack Overflow</a>. <a href="https://www.meetup.com/rladiescdmx/">R-Ladies CDMX</a> es parte de <a href="https://rladies.org/">R-Ladies Global</a>, una organización mundial que busca generar una comunidad fuerte para compartir dudas, habilidades y apoyo sobre #RStats en una comunidad con perspectiva de género.</p>
</div>
</div>
<div id="flujo-basico-de-trabajo-para-el-analisis-de-datos-en-r." class="section level2">
<h2><span class="header-section-number">2.2</span> Flujo básico de trabajo para el análisis de datos en R.</h2>
<p>En el análisis de datos nos interesan técnicas cuantitativas cómo: recolectar, organizar, entender, interpretar y extraer información de colecciones de datos predominantemente numéricos. Estas tareas se resumen en el proceso de análisis del siguiente diagrama:</p>
<p><img src="figuras/data-science.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
<p>Primero debe <strong>importar</strong> los datos en R. Esto generalmente significa llevar los datos almacenados en un archivo, una base de datos, o uan Web API, a un <strong>data frame</strong> de R.</p>
<p><strong>Limpiar</strong> y <strong>transformar</strong> los datos es necesario, para que la forma en que se almacenan los datos coincida con la semántica de los datos. En términos generales, cada columna debe ser una variable y cada rengón una observación.</p>
<p>La <strong>visualización</strong> es una actividad fundamentalmente humana. Una buena visualización te puede mostrar cosas que no esperabas y puede ayudarte a plantear nuevas preguntas acerca de los datos. Una buena visualización también puede ayudar a determinar si se está haciendo una pregunta equivocada sobre los datos, o si es encesario recolectar más datos, o bien, obtener datos de fuentes distintas. Las visualizaciones pueden sorprenderte, pero requieren de un ser humano para interpretarlas.</p>
<p>Por otro lado, los <strong>modelos</strong> son una herramienta para complementar las visualizaciones. Los modelos los utilizamos como un instrumento matemático y computacional para responder preguntas precisas acerca de los datos.</p>
<p>Por último, la <strong>comunicación</strong> de los resultados es una parte absolutamente crítica para cualquier proyecto de análisis de datos.</p>
</div>
<div id="introduccion-a-r-como-lenguaje-de-programacion-y-la-plataforma-interactiva-de-rstudio." class="section level2">
<h2><span class="header-section-number">2.3</span> Introducción a R como lenguaje de programación, y la plataforma interactiva de RStudio.</h2>
<hr />
<blockquote>
<p>Notas basadas en el material de <a href="https://github.com/tereom">Teresa Ortiz</a> y <a href="https://github.com/songeo">Sonia Mendizábal</a> y en el libro “R for Data Science” escrito por Hadley Wickham y Garret Grolemund <span class="citation">(Wickham and Grolemund <a href="#ref-wickham2016r">2016</a>)</span>.</p>
</blockquote>
<hr />
<p>Hay cuatro cosas que necesitan para ejecutar el código en este taller: R, RStudio, una colección de paquetes de R, llamada <strong>tidyverse</strong>, y otros paquetes que vamos a ir instalando progresivamente. Los paquetes son la unidad fundamental del código reproducible en R. Incluyen funciones que se pueden utilizar en un ámbito general, su documentación que describe cómo usarlas y datos de ejemplo con código de ejemplo como ayuda para los usuarios.</p>
<div id="como-entender-r" class="section level3">
<h3><span class="header-section-number">2.3.1</span> ¿Cómo entender R?</h3>
<ul>
<li><p>Hay una sesión de R corriendo. La consola de R es la interfaz entre R y nosotros.</p></li>
<li><p>En la sesión hay objetos. Todo en R es un objeto: vectores, tablas, funciones, etc.</p></li>
<li><p>Operamos aplicando funciones a los objetos y creando nuevos objetos.</p></li>
</ul>
</div>
<div id="por-que-r" class="section level3">
<h3><span class="header-section-number">2.3.2</span> ¿Por qué R?</h3>
<ul>
<li><p>R funciona en casi todas las plataformas (Mac, Windows, Linux e incluso en Playstation 3).</p></li>
<li><p>R promueve la investigación reproducible.</p></li>
<li><p>R está actualizado gracias a que tiene una activa comunidad.</p></li>
<li><p>R se puede combinar con otras herramientas. R permite integrar otros lenguajes (C/C++, Java, Julia, Python) y puede interactuar con muchas fuentes de datos: bases de datos compatibles con ODBC y paquetes estadísticos.</p></li>
</ul>
<div id="descargar-r-version-3.4.3" class="section level4">
<h4><span class="header-section-number">2.3.2.1</span> Descargar R: versión 3.4.3</h4>
<p>Sigue las instrucciones del instalador:</p>
<ul>
<li><p>OSX: <a href="http://cran.stat.ucla.edu/bin/macosx/R-3.4.3.pkg" class="uri">http://cran.stat.ucla.edu/bin/macosx/R-3.4.3.pkg</a></p></li>
<li><p>Windows: <a href="http://cran.stat.ucla.edu/bin/windows/base/R-3.4.3-win.exe" class="uri">http://cran.stat.ucla.edu/bin/windows/base/R-3.4.3-win.exe</a></p></li>
</ul>
</div>
<div id="descargar-rstudio-version-1.1.414" class="section level4">
<h4><span class="header-section-number">2.3.2.2</span> Descargar RStudio: versión 1.1.414</h4>
<ul>
<li><p>OSX: <a href="https://download1.rstudio.org/RStudio-1.1.414.dmg" class="uri">https://download1.rstudio.org/RStudio-1.1.414.dmg</a></p></li>
<li><p>Windows: <a href="https://download1.rstudio.org/RStudio-1.1.414.exe" class="uri">https://download1.rstudio.org/RStudio-1.1.414.exe</a></p></li>
</ul>
<p>RStudio es libre y gratis. Es un ambiente de desarrollo integrado para R: incluye una consola, un editor de texto y un conjunto de herramientas para administrar el espacio de trabajo cuando se utiliza R.</p>
<p><img src="figuras/rstudio-console-descr.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
<p>Algunos <em>shortcuts</em> útiles en RStudio son:</p>
<p><strong>En el editor</strong></p>
<ul>
<li>command/ctrl + enter: enviar código a la consola<br />
</li>
<li>ctrl + 2: mover el cursor a la consola</li>
</ul>
<p><strong>En la consola</strong></p>
<ul>
<li>flecha hacia arriba: recuperar comandos pasados<br />
</li>
<li>ctrl + flecha hacia arriba: búsqueda en los comandos<br />
</li>
<li>ctrl + 1: mover el cursor al editor</li>
</ul>
<p><strong>Más</strong></p>
<ul>
<li>alt + shift + k: muestra los <em>shortcuts</em> disponibles.</li>
</ul>
<p class="espacio">
</p>
<p>Para que el código sea <strong>reproducible</strong> es importante que RStudio únicamente guarde lo relevante para hacer los cálculos, es decir, los scripts y <em>no los cálculos en sí</em>. Con tus scripts de R (y los datos), siempre podemos volver a crear las variables de ambiente. Sin embargo, es casi imposible recuperar un script únicamente a partir de tus variables de ambiente. Por lo tanto, se recomienda ampliamente configurar RStudio para que jamás guarde el ambiente en memoria.</p>
<p><img src="figuras/rstudio-workspace.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
</div>
<div id="paquetes-de-r" class="section level4">
<h4><span class="header-section-number">2.3.2.3</span> Paquetes de R</h4>
<p>Una de las ventajas de R es la gran comunidad que aporta al desarrollo por medio de paquetes que dan funcionalidad adicional. Esta es la mejor manera de usar R para análisis de datos.</p>
<p>Existen dos formas de instalar paquetes:</p>
<ul>
<li>Desde RStudio:</li>
</ul>
<p><img src="figuras/install_packages.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
<ul>
<li>Desde la consola:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&#39;tidyverse&#39;</span>)</code></pre></div>
<p>Una vez instalados los paquetes, se cargan a la sesión de R mediante <code>library</code>. Por ejemplo, para cargar el paquete <code>readr</code> que instalamos anteriormente, hacemos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;tidyverse&#39;</span>)
<span class="kw">print</span>(read_csv)
<span class="co">#&gt; function (file, col_names = TRUE, col_types = NULL, locale = default_locale(), </span>
<span class="co">#&gt;     na = c(&quot;&quot;, &quot;NA&quot;), quoted_na = TRUE, quote = &quot;\&quot;&quot;, comment = &quot;&quot;, </span>
<span class="co">#&gt;     trim_ws = TRUE, skip = 0, n_max = Inf, guess_max = min(1000, </span>
<span class="co">#&gt;         n_max), progress = show_progress()) </span>
<span class="co">#&gt; {</span>
<span class="co">#&gt;     tokenizer &lt;- tokenizer_csv(na = na, quoted_na = TRUE, quote = quote, </span>
<span class="co">#&gt;         comment = comment, trim_ws = trim_ws)</span>
<span class="co">#&gt;     read_delimited(file, tokenizer, col_names = col_names, col_types = col_types, </span>
<span class="co">#&gt;         locale = locale, skip = skip, comment = comment, n_max = n_max, </span>
<span class="co">#&gt;         guess_max = guess_max, progress = progress)</span>
<span class="co">#&gt; }</span>
<span class="co">#&gt; &lt;bytecode: 0x62c9840&gt;</span>
<span class="co">#&gt; &lt;environment: namespace:readr&gt;</span></code></pre></div>
<p>Como el paquete <code>readr</code> está cargado en la sesión podemos llamar a la función <code>read_csv</code> que se usará más adelante.</p>
<p><strong>Importante</strong>: Los paquetes se instalan una vez únicamente después de descargar una nueva versión de R. Las librerías se cargan en cada sesión de R nueva.</p>
<p><br></p>
<p><br></p>
</div>
<div id="ayuda-en-r" class="section level4">
<h4><span class="header-section-number">2.3.2.4</span> Ayuda en R</h4>
<p>Existen diferentes formas de pedir ayuda en R.</p>
<ul>
<li><p><code>help.start()</code>: ayuda en general</p></li>
<li><p><code>help(fun)</code> o <code>?fun</code>: ayuda sobre la función <em>fun</em></p></li>
<li><p><code>apropos(&quot;fun&quot;)</code>: lista de funciones que contiene la palabra <em>fun</em></p></li>
<li><p><code>example(fun)</code>: muestra un ejemplo de la función <em>fun</em></p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">help</span>(read_csv)
?read_csv2</code></pre></div>
<p><br></p>
<p><br></p>
</div>
</div>
</div>
<div id="estructuras-de-datos" class="section level2">
<h2><span class="header-section-number">2.4</span> Estructuras de datos</h2>
<blockquote>
<p>Todo lo que existe en R es un objeto.</p>
</blockquote>
<p>En R se puede trabajar con distintas estructuras de datos, algunas son de una sola dimensión y otras permiten más, como indica el siguiente diagrama:</p>
<p><img src="figuras/data-estructure.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
<div id="vectores" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Vectores</h3>
<p>Los vectores son estructuras de datos de una dimensión. Un vector se define con la función <code>c()</code>, que <em>concatena</em> diferentes elementos del mismo tipo, esto determina el tipo del vector.</p>
<p><strong>Nota:</strong> En R, la asignación de un nombre al vector, o en general a cualquier objeto, se realiza con el símbolo <code>&lt;-</code>. Se recomienda usar el shortcut <strong>alt -</strong> genera <code>&lt;-</code>.</p>
<p><br></p>
<p>Los vectores en R pueden ser de diferentes tipos o clases, a continuación se presentan algunos casos. En R, la clase de cada vector se extrae con la función <code>class()</code>.</p>
<ul>
<li><strong>Vectores numéricos</strong>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">2.5</span>,<span class="dv">3</span>,<span class="fl">4.5</span>,<span class="dv">5</span>,<span class="fl">6.9</span>)
a
<span class="co">#&gt; [1] 1.0 2.5 3.0 4.5 5.0 6.9</span>
<span class="co"># clase del vector</span>
<span class="kw">class</span>(a)
<span class="co">#&gt; [1] &quot;numeric&quot;</span></code></pre></div>
<ul>
<li><strong>Vectores lógicos</strong>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bool &lt;-<span class="st"> </span><span class="kw">c</span>(T, F, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>)
bool
<span class="co">#&gt; [1]  TRUE FALSE  TRUE FALSE</span>
<span class="co"># clase del vector</span>
<span class="kw">class</span>(bool)
<span class="co">#&gt; [1] &quot;logical&quot;</span></code></pre></div>
<ul>
<li><strong>Vectores de caracteres</strong>:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fruits &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;pineapple&quot;</span>, <span class="st">&quot;lemon&quot;</span>, <span class="st">&quot;kiwi&quot;</span>)
fruits
<span class="co">#&gt; [1] &quot;apple&quot;     &quot;banana&quot;    &quot;orange&quot;    &quot;pineapple&quot; &quot;lemon&quot;     &quot;kiwi&quot;</span>
<span class="kw">class</span>(fruits)
<span class="co">#&gt; [1] &quot;character&quot;</span></code></pre></div>
<p>Para la manipulación de caracteres es recomendable el paquete <strong>stringr</strong> que permite realizar operaciones sobre este tipo de elementos. Más adelante se presenta un ejemplo.</p>
<p><br></p>
<p>La <strong>selección de elementos</strong> de un vector se realiza con <strong><code>[ ]</code></strong> para indicar la posición. A diferencia de otros lenguajes de programación las posiciones en R incian en 1.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># elemento en la posición 1</span>
fruits[<span class="dv">1</span>]
<span class="co">#&gt; [1] &quot;apple&quot;</span>
<span class="co"># elemento en la posición 1 y 5</span>
fruits[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)]
<span class="co">#&gt; [1] &quot;apple&quot; &quot;lemon&quot;</span></code></pre></div>
<p><br></p>
<p>En R es posible extraer un valor del vector indexándolo con posiciones negativas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># omitir el elemento en la primera posición</span>
fruits[<span class="op">-</span><span class="dv">1</span>]
<span class="co">#&gt; [1] &quot;banana&quot;    &quot;orange&quot;    &quot;pineapple&quot; &quot;lemon&quot;     &quot;kiwi&quot;</span></code></pre></div>
<p><br></p>
<p>Una característica particular de vectores en R, es que cada elemento puede ser nombrado. Para hacer esto se usa la función <code>names()</code>. Por ejemplo, al vector <em>fruits</em> agregemos el nombre en español de la fruta para como el nombre de cada elemento.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(fruits) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;manzana&#39;</span>, <span class="st">&#39;platano&#39;</span>, <span class="st">&#39;naranja&#39;</span>, <span class="st">&#39;piña&#39;</span>, <span class="st">&#39;limón&#39;, &#39;</span>kiwi<span class="st">&#39;)</span>
<span class="st">fruits</span>
<span class="st">#&gt;     manzana     platano     naranja        piña       limón        kiwi </span>
<span class="st">#&gt;     &quot;apple&quot;    &quot;banana&quot;    &quot;orange&quot; &quot;pineapple&quot;     &quot;lemon&quot;      &quot;kiwi&quot;</span>
<span class="st"># cada elemento tiene un nombre asignado</span>
<span class="st">fruits[5]</span>
<span class="st">#&gt;   limón </span>
<span class="st">#&gt; &quot;lemon&quot;</span></code></pre></div>
<p><br></p>
<p>Para eliminar los nombres asignados a cada elemento, se asigna <code>NULL</code> a los nombres del vector:</p>
<pre><code>#&gt; NULL
#&gt; [1] &quot;apple&quot;     &quot;banana&quot;    &quot;orange&quot;    &quot;pineapple&quot; &quot;lemon&quot;     &quot;kiwi&quot;</code></pre>
<p><br></p>
<p><br></p>
<p>Los tipos que pueden tener los vectores se muestran en la siguiente figura.</p>
<p class="espacio">
</p>
<p><img src="figuras/data-structures-overview.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
<p>Veamos que regresan los siguientes comandos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(<span class="ot">TRUE</span>)
<span class="kw">typeof</span>(1L)
<span class="kw">typeof</span>(<span class="fl">1.5</span>)
<span class="kw">typeof</span>(<span class="st">&quot;a&quot;</span>)</code></pre></div>
<p>Cada vector tiene 3 propiedades:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">5</span></code></pre></div>
<ul>
<li>Tipo</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">typeof</span>(x)
<span class="co">#&gt; [1] &quot;integer&quot;</span></code></pre></div>
<ul>
<li>Longitud</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(x)
<span class="co">#&gt; [1] 5</span></code></pre></div>
<ul>
<li>Atributos</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">attributes</span>(x)
<span class="co">#&gt; NULL</span></code></pre></div>
<p>Existe la función <code>is.vector(x)</code> para determinar si un objeto es un vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.vector</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
<p><br></p>
<img src="figuras/manicule2.jpg" />
<div class="centered">
<p class="espacio">
</p>
<p>¿Qué regresa <code>ìs.vector(factor(1:3))</code>?</p>
<ol style="list-style-type: lower-alpha">
<li><p>TRUE</p></li>
<li><p>FALSE</p></li>
<li><p>NA</p></li>
<li><p>Ninguna de las anteriores</p></li>
</ol>
<p class="espacio3">
</p>
</div>
<p><br></p>
<p><br></p>
<p><strong>Ejemplo</strong></p>
<p>Del vector de seis frutas diferentes llamado <em>fruits</em>, localiza únicamente las frutas que tengan la letra <strong>w</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Cargamos la librería</span>
<span class="kw">library</span>(stringr)
fruits &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;pineapple&quot;</span>, <span class="st">&quot;lemon&quot;</span>, <span class="st">&quot;kiwi&quot;</span>)
fruits
<span class="co">#&gt; [1] &quot;apple&quot;     &quot;banana&quot;    &quot;orange&quot;    &quot;pineapple&quot; &quot;lemon&quot;     &quot;kiwi&quot;</span></code></pre></div>
<p>Esto es posible con la función <code>str_detect()</code>, que regresa un vector booleano para cada elemento del vector donde encontró el patron <strong>w</strong>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str_detect</span>(fruits, <span class="dt">pattern =</span> <span class="st">&#39;w&#39;</span>)
<span class="co">#&gt; [1] FALSE FALSE FALSE FALSE FALSE  TRUE</span></code></pre></div>
<p>Ahora, seleccionamos únicamente los elementos del vector que tienen la letra <strong>w</strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Selecciona el elemento con valor TRUE: kiwi</span>
fruits[<span class="kw">str_detect</span>(fruits, <span class="dt">pattern =</span> <span class="st">&#39;w&#39;</span>)]
<span class="co">#&gt; [1] &quot;kiwi&quot;</span></code></pre></div>
<p><br></p>
<div id="operaciones-de-vectores" class="section level4">
<h4><span class="header-section-number">2.4.1.1</span> Operaciones de vectores</h4>
<p>En R las <strong>operaciones de vectores</strong> son componente a componente.</p>
<ul>
<li>Sumas, multiplicaciones y potencias:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Suma del vector longitud 6 y un vector longitud 1</span>
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, <span class="fl">6.9</span>)
b &lt;-<span class="st"> </span><span class="dv">1</span>
a <span class="op">+</span><span class="st"> </span>b 
<span class="co">#&gt; [1] 2.0 3.5 4.0 5.5 6.0 7.9</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Multiplicaciones componente a componente misma longitud</span>
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, <span class="fl">6.9</span>)
a<span class="op">*</span>a
<span class="co">#&gt; [1]  1.00  6.25  9.00 20.25 25.00 47.61</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Multiplicaciones y potencias</span>
a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, <span class="fl">6.9</span>)
c &lt;-<span class="st"> </span>(a<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span>)<span class="op">*</span><span class="dv">3</span>
c
<span class="co">#&gt; [1]  18.0  33.8  42.0  75.8  90.0 157.8</span></code></pre></div>
<p><br></p>
<ul>
<li>Comparaciones: En este tipo de operación se obtiene un vector lógico dependiendo si la condición se cumple o no.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Comparar el vector dado un valor específico</span>
a <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span> 
<span class="co">#&gt; [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE</span>
a[a <span class="op">&gt;</span><span class="st"> </span><span class="dv">3</span>] <span class="co"># únicamente elementos que cumple la condicion de ser mayores a 3</span>
<span class="co">#&gt; [1] 4.5 5.0 6.9</span>
fruits <span class="op">!=</span><span class="st"> &#39;apple&#39;</span>
<span class="co">#&gt; [1] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE</span>
fruits[fruits <span class="op">!=</span><span class="st"> &#39;apple&#39;</span>] <span class="co"># únicamente elementos que no son apple</span>
<span class="co">#&gt; [1] &quot;banana&quot;    &quot;orange&quot;    &quot;pineapple&quot; &quot;lemon&quot;     &quot;kiwi&quot;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Comparar el vector dado otro vector de la misma dimensión</span>
x &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>)
a <span class="op">==</span><span class="st"> </span>x
<span class="co">#&gt; [1]  TRUE FALSE  TRUE FALSE  TRUE FALSE</span>
a[a <span class="op">==</span><span class="st"> </span>x] <span class="co"># unicamente los elementos iguales y en la misma posición entre a y x</span>
<span class="co">#&gt; [1] 1 3 5</span></code></pre></div>
<p><br></p>
<ul>
<li>Funciones predeterminadas:</li>
</ul>
<p>Algunas funciones predeterminadas del paquete básico de R son muy útiles para la manipulación de vectores y el análisis de datos. A continuación se enlistan algunasde las más comúnes:</p>
<ul>
<li><p><code>length</code>: número de elementos en el vector</p></li>
<li><p><code>class</code>: clase del vector</p></li>
<li><p><code>summary</code>: resumen de información del vector</p></li>
<li><p><code>unique</code>: valores unicos del vector</p></li>
<li><p><code>table</code>: tabla de frecuencias para cada elemento del vector</p></li>
<li><p><code>sum</code>: suma de los elementos del vector</p></li>
<li><p><code>mean</code>: promedio de elementos del vector</p></li>
<li><p><code>sd</code>: desviación estándar de los elementos del vector</p></li>
<li><p><code>cumsum</code>: suma acumulada de elemento anterior del vector</p></li>
</ul>
<p><br></p>
<p><br></p>
<p><img src="figuras/manicule.jpg" /> Aplica las funciones comúnes enlistadas antes en el vector <code>x &lt;- c(1, 2, 3, 4, 5, 6)</code></p>
<p><br></p>
<p><br></p>
</div>
<div id="otros-tipos-de-vectores" class="section level4">
<h4><span class="header-section-number">2.4.1.2</span> Otros tipos de vectores:</h4>
<p>Existen tipos de vectores con características importantes:</p>
<ul>
<li><strong>Secuencias</strong>: los vectores de secuencias se pueden crear con la función <code>seq()</code> o con <code>:</code>, de la siguiente forma:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># secuecia de 1 al 10 </span>
<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>
<span class="co">#&gt;  [1]  1  2  3  4  5  6  7  8  9 10</span>
<span class="co"># secuecia de pares de 0 al 10 </span>
<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="dt">by =</span> <span class="dv">2</span>)
<span class="co">#&gt; [1]  0  2  4  6  8 10</span></code></pre></div>
<p><br></p>
<ul>
<li><strong>Vectores de fechas</strong>: se pueden hacer operaciones y algunas funciones definidas de fechas. El paquete <em>lubridate</em> permite manejar fechas con mayor facilidad.</li>
</ul>
<p>Se incia la secuencia el 08 de agosto de 2016 y se asigna la clase de fecha con la función <code>as.Date()</code>. Se generan en total 10 fechas <code>length.out = 10</code> y con una distancua semanal <code>by=&quot;1 week&quot;</code>, es decir, se tiene la fecha de 10 semanas consecutivas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lubridate)
tenweeks &lt;-<span class="st"> </span><span class="kw">seq</span>( <span class="kw">as.Date</span>(<span class="st">&quot;2016-08-08&quot;</span>), <span class="dt">length.out =</span> <span class="dv">10</span>,  <span class="dt">by=</span><span class="st">&quot;1 week&quot;</span>)
tenweeks
<span class="co">#&gt;  [1] &quot;2016-08-08&quot; &quot;2016-08-15&quot; &quot;2016-08-22&quot; &quot;2016-08-29&quot; &quot;2016-09-05&quot;</span>
<span class="co">#&gt;  [6] &quot;2016-09-12&quot; &quot;2016-09-19&quot; &quot;2016-09-26&quot; &quot;2016-10-03&quot; &quot;2016-10-10&quot;</span>
<span class="kw">class</span>(tenweeks)
<span class="co">#&gt; [1] &quot;Date&quot;</span></code></pre></div>
<p>Se pueden hacer algunas operaciones como se ejemplifica en el siguiente código.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Aumenta un día a cada fecha</span>
tenweeks <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
<span class="co">#&gt;  [1] &quot;2016-08-09&quot; &quot;2016-08-16&quot; &quot;2016-08-23&quot; &quot;2016-08-30&quot; &quot;2016-09-06&quot;</span>
<span class="co">#&gt;  [6] &quot;2016-09-13&quot; &quot;2016-09-20&quot; &quot;2016-09-27&quot; &quot;2016-10-04&quot; &quot;2016-10-11&quot;</span>
<span class="co"># Aumenta un día a cada fecha</span>
tenweeks 
<span class="co">#&gt;  [1] &quot;2016-08-08&quot; &quot;2016-08-15&quot; &quot;2016-08-22&quot; &quot;2016-08-29&quot; &quot;2016-09-05&quot;</span>
<span class="co">#&gt;  [6] &quot;2016-09-12&quot; &quot;2016-09-19&quot; &quot;2016-09-26&quot; &quot;2016-10-03&quot; &quot;2016-10-10&quot;</span>
<span class="kw">weekdays</span>(tenweeks) <span class="co"># Día de la semana de cada fecha</span>
<span class="co">#&gt;  [1] &quot;Monday&quot; &quot;Monday&quot; &quot;Monday&quot; &quot;Monday&quot; &quot;Monday&quot; &quot;Monday&quot; &quot;Monday&quot;</span>
<span class="co">#&gt;  [8] &quot;Monday&quot; &quot;Monday&quot; &quot;Monday&quot;</span></code></pre></div>
<p><br></p>
<ul>
<li><strong>Vectores de factores</strong>: este tipo de vector es usado comúnmente para variables categóricas. En R existe la clase <strong>factor</strong> que se asigna con la función homónima <code>factor()</code> o <code>as.factor()</code>.</li>
</ul>
<p>Un vector de factores tiene dos elementos importantes, <em>levels</em> o niveles y <em>labels</em> o etiquetas. Los niveles determinan las categorías únicas del vector y pueden ser etiquetadas, como se muestra en le siguiente código para un vector de frutas.</p>
<p>En este ejemplo se tienen valores de frutas repetidos, se asigna un orden de niveles específicos y etiquetas específicas para cada nivel.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fruits &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;banana&quot;</span>, <span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;pineapple&quot;</span>, <span class="st">&quot;lemon&quot;</span>, <span class="st">&quot;kiwi&quot;</span>, <span class="st">&quot;apple&quot;</span>)
<span class="co"># Vector de caracteres a vector de factores</span>
fruits.fac &lt;-<span class="st"> </span><span class="kw">factor</span>(fruits, 
                   <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;pineapple&quot;</span>, <span class="st">&quot;lemon&quot;</span>, <span class="st">&quot;kiwi&quot;</span>),
                   <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;manzana&#39;</span>, <span class="st">&#39;platano&#39;</span>, <span class="st">&#39;naranja&#39;</span>, <span class="st">&#39;piña&#39;</span>, <span class="st">&#39;limón&#39;, &#39;</span>kiwi<span class="st">&#39;)</span>
<span class="st">)</span>
<span class="st">fruits.fac</span>
<span class="st">#&gt; [1] platano manzana platano naranja piña    limón   kiwi    manzana</span>
<span class="st">#&gt; Levels: manzana platano naranja piña limón kiwi</span>
<span class="st"># Clase</span>
<span class="st">class(fruits.fac)</span>
<span class="st">#&gt; [1] &quot;factor&quot;</span>
<span class="st"># Niveles etiquetados</span>
<span class="st">levels(fruits.fac)</span>
<span class="st">#&gt; [1] &quot;manzana&quot; &quot;platano&quot; &quot;naranja&quot; &quot;piña&quot;    &quot;limón&quot;   &quot;kiwi&quot;</span>
<span class="st"># Niveles únicos</span>
<span class="st">as.numeric(fruits.fac)</span>
<span class="st">#&gt; [1] 2 1 2 3 4 5 6 1</span>
<span class="st"># Agregar un nuevo valor</span>
<span class="st">fruits.fac[7] &lt;- &#39;</span>melon<span class="st">&#39;</span>
<span class="st">#&gt; Warning in `[&lt;-.factor`(`*tmp*`, 7, value = &quot;melon&quot;): invalid factor level,</span>
<span class="st">#&gt; NA generated</span>
<span class="st">fruits.fac</span>
<span class="st">#&gt; [1] platano manzana platano naranja piña    limón   &lt;NA&gt;    manzana</span>
<span class="st">#&gt; Levels: manzana platano naranja piña limón kiwi</span></code></pre></div>
<p><br></p>
<p><strong>Importante:</strong> En R los vectores no pueden combinar diferentes tipos de elementos. El tipo de elementos es lo que define la clase del vector. Es por esto que en el ejemplo, al sustituir la posición 7 por <em>melon</em> se obtiene un <code>NA</code>, melón no está incluído en los niveles definidos del vector.</p>
<p>Existen también los <strong>factores ordenados</strong>. Por ejemplo, consideremos los datos de flores de iris de Fisher:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(forcats)
iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>13</td>
<td align="right">4.8</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td>125</td>
<td align="right">6.7</td>
<td align="right">3.3</td>
<td align="right">5.7</td>
<td align="right">2.1</td>
<td align="left">virginica</td>
</tr>
<tr class="odd">
<td>89</td>
<td align="right">5.6</td>
<td align="right">3.0</td>
<td align="right">4.1</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>24</td>
<td align="right">5.1</td>
<td align="right">3.3</td>
<td align="right">1.7</td>
<td align="right">0.5</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td>2</td>
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td>68</td>
<td align="right">5.8</td>
<td align="right">2.7</td>
<td align="right">4.1</td>
<td align="right">1.0</td>
<td align="left">versicolor</td>
</tr>
<tr class="odd">
<td>72</td>
<td align="right">6.1</td>
<td align="right">2.8</td>
<td align="right">4.0</td>
<td align="right">1.3</td>
<td align="left">versicolor</td>
</tr>
<tr class="even">
<td>42</td>
<td align="right">4.5</td>
<td align="right">2.3</td>
<td align="right">1.3</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td>105</td>
<td align="right">6.5</td>
<td align="right">3.0</td>
<td align="right">5.8</td>
<td align="right">2.2</td>
<td align="left">virginica</td>
</tr>
<tr class="even">
<td>109</td>
<td align="right">6.7</td>
<td align="right">2.5</td>
<td align="right">5.8</td>
<td align="right">1.8</td>
<td align="left">virginica</td>
</tr>
</tbody>
</table>
<p>Este conjunto de datos multivariados fue presentado por el estadístico y biólogo británico Ronald Fisher en su artículo de 1936 “El uso de mediciones múltiples en problemas taxonómicos como un ejemplo de análisis discriminante lineal”. Edgar Anderson recopiló los datos para cuantificar la variación morfológica de las flores de iris de tres especies relacionadas. Los datos fueron recolectadas en la Península de Gaspé. <span class="citation">(Fisher <a href="#ref-fisher1936use">1936</a>)</span></p>
<p class="espacio">
</p>
<p><img src="figuras/iris_flowers.jpg" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
<p>El conjunto de datos consiste de 50 observaciones de <em>cada</em> una de las tres especies de Iris (Iris setosa, Iris virginica e Iris versicolor). Se midieron cuatro características de cada muestra: la longitud y el ancho de los sépalos y pétalos, en centímetros. Con base en la combinación de estas cuatro características, Fisher desarrolló un modelo discriminante lineal para distinguir las especies entre sí.</p>
<p>Supongamos que queremos analizar la distribución del ancho del sépalo por especie de flor de iris:</p>
<p><img src="02-temas_selectos_R_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Esto ocurre porque los factores están ordenados alfabéticamente:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(iris<span class="op">$</span>Species)
<span class="co">#&gt; [1] &quot;setosa&quot;     &quot;versicolor&quot; &quot;virginica&quot;</span></code></pre></div>
<p>Sería mejor que las especies estuvieran <em>ordenadas</em> por la mediana de la distribución para poder hacer mejores comparaciones. Notemos el uso de la función <code>fct_reorder</code> del paquete <code>forcats</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(forcats)
iris<span class="op">$</span>Species_ord &lt;-<span class="st"> </span><span class="kw">fct_reorder</span>(iris<span class="op">$</span>Species, iris<span class="op">$</span>Sepal.Width, <span class="dt">fun =</span> median)
<span class="kw">levels</span>(iris<span class="op">$</span>Species_ord)
<span class="co">#&gt; [1] &quot;versicolor&quot; &quot;virginica&quot;  &quot;setosa&quot;</span></code></pre></div>
<p><img src="02-temas_selectos_R_files/figure-html/unnamed-chunk-21-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="data-frames" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Data Frames</h3>
<p>Un <strong>data.frame</strong> es un conjunto de vectores del mismo tamaño agrupado en una tabla. Son estructuras rectangulares donde cada columna tiene elementos de la misma clase, pero columnas distintas pueden tener diferentes clases.</p>
<p>Por ejemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tabla &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
<span class="dt">n =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,
<span class="dt">frutas =</span> fruits[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], 
<span class="dt">valor =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">4.5</span>, <span class="dv">5</span>, <span class="fl">6.9</span>)
)
tabla
<span class="co">#&gt;   n    frutas valor</span>
<span class="co">#&gt; 1 1    banana   1.0</span>
<span class="co">#&gt; 2 2     apple   2.5</span>
<span class="co">#&gt; 3 3    banana   3.0</span>
<span class="co">#&gt; 4 4    orange   4.5</span>
<span class="co">#&gt; 5 5 pineapple   5.0</span>
<span class="co">#&gt; 6 6     lemon   6.9</span></code></pre></div>
<p>Similar a las funciones de vectores, en <em>data.frames</em> existen funciones predeterminadas que ayudan a su manipulación.</p>
<ul>
<li><code>head</code> permite ver los primeros 6 elemento del data.frame:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(mtcars)
<span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span>
<span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span>
<span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span>
<span class="co">#&gt; Datsun 710        22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span>
<span class="co">#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span>
<span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span>
<span class="co">#&gt; Valiant           18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span></code></pre></div>
<ul>
<li><code>str</code> describe el tipo de variables en el data.frame:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(mtcars)
<span class="co">#&gt; &#39;data.frame&#39;:    32 obs. of  11 variables:</span>
<span class="co">#&gt;  $ mpg : num  21 21 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 ...</span>
<span class="co">#&gt;  $ cyl : num  6 6 4 6 8 6 8 4 4 6 ...</span>
<span class="co">#&gt;  $ disp: num  160 160 108 258 360 ...</span>
<span class="co">#&gt;  $ hp  : num  110 110 93 110 175 105 245 62 95 123 ...</span>
<span class="co">#&gt;  $ drat: num  3.9 3.9 3.85 3.08 3.15 2.76 3.21 3.69 3.92 3.92 ...</span>
<span class="co">#&gt;  $ wt  : num  2.62 2.88 2.32 3.21 3.44 ...</span>
<span class="co">#&gt;  $ qsec: num  16.5 17 18.6 19.4 17 ...</span>
<span class="co">#&gt;  $ vs  : num  0 0 1 1 0 1 0 1 1 1 ...</span>
<span class="co">#&gt;  $ am  : num  1 1 1 0 0 0 0 0 0 0 ...</span>
<span class="co">#&gt;  $ gear: num  4 4 4 3 3 3 3 4 4 4 ...</span>
<span class="co">#&gt;  $ carb: num  4 4 1 1 2 1 4 2 2 4 ...</span></code></pre></div>
<ul>
<li><code>dim</code> muestra la dimensión (renglones, columnas) del data.frame:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(mtcars)
<span class="co">#&gt; [1] 32 11</span></code></pre></div>
<ul>
<li><code>colnames</code> y <code>names</code> muestran los nombres de las columnas del data.frame:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(mtcars)
<span class="co">#&gt;  [1] &quot;mpg&quot;  &quot;cyl&quot;  &quot;disp&quot; &quot;hp&quot;   &quot;drat&quot; &quot;wt&quot;   &quot;qsec&quot; &quot;vs&quot;   &quot;am&quot;   &quot;gear&quot;</span>
<span class="co">#&gt; [11] &quot;carb&quot;</span></code></pre></div>
<ul>
<li><code>rownames</code> muestra el nombre de los renglones del data.frame:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(mtcars)
<span class="co">#&gt;  [1] &quot;Mazda RX4&quot;           &quot;Mazda RX4 Wag&quot;       &quot;Datsun 710&quot;         </span>
<span class="co">#&gt;  [4] &quot;Hornet 4 Drive&quot;      &quot;Hornet Sportabout&quot;   &quot;Valiant&quot;            </span>
<span class="co">#&gt;  [7] &quot;Duster 360&quot;          &quot;Merc 240D&quot;           &quot;Merc 230&quot;           </span>
<span class="co">#&gt; [10] &quot;Merc 280&quot;            &quot;Merc 280C&quot;           &quot;Merc 450SE&quot;         </span>
<span class="co">#&gt; [13] &quot;Merc 450SL&quot;          &quot;Merc 450SLC&quot;         &quot;Cadillac Fleetwood&quot; </span>
<span class="co">#&gt; [16] &quot;Lincoln Continental&quot; &quot;Chrysler Imperial&quot;   &quot;Fiat 128&quot;           </span>
<span class="co">#&gt; [19] &quot;Honda Civic&quot;         &quot;Toyota Corolla&quot;      &quot;Toyota Corona&quot;      </span>
<span class="co">#&gt; [22] &quot;Dodge Challenger&quot;    &quot;AMC Javelin&quot;         &quot;Camaro Z28&quot;         </span>
<span class="co">#&gt; [25] &quot;Pontiac Firebird&quot;    &quot;Fiat X1-9&quot;           &quot;Porsche 914-2&quot;      </span>
<span class="co">#&gt; [28] &quot;Lotus Europa&quot;        &quot;Ford Pantera L&quot;      &quot;Ferrari Dino&quot;       </span>
<span class="co">#&gt; [31] &quot;Maserati Bora&quot;       &quot;Volvo 142E&quot;</span></code></pre></div>
<ul>
<li>La forma de indexar data.frames es similar a la de un vector <strong><code>[ ]</code></strong>, pero en este caso es posible indexar renglones y columnas:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># por posiciones de renglones</span>
mtcars[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, ]
<span class="co">#&gt;                 mpg cyl disp  hp drat   wt qsec vs am gear carb</span>
<span class="co">#&gt; Mazda RX4      21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span>
<span class="co">#&gt; Mazda RX4 Wag  21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span>
<span class="co">#&gt; Datsun 710     22.8   4  108  93 3.85 2.32 18.6  1  1    4    1</span>
<span class="co">#&gt; Hornet 4 Drive 21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span>
<span class="co"># por posiciones de columnas</span>
mtcars[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">6</span>)]
<span class="co">#&gt;                 mpg  hp   wt</span>
<span class="co">#&gt; Mazda RX4      21.0 110 2.62</span>
<span class="co">#&gt; Mazda RX4 Wag  21.0 110 2.88</span>
<span class="co">#&gt; Datsun 710     22.8  93 2.32</span>
<span class="co">#&gt; Hornet 4 Drive 21.4 110 3.21</span>
<span class="co"># por nombre de renglones específico</span>
mtcars[<span class="kw">c</span>(<span class="st">&#39;Mazda RX4&#39;</span>, <span class="st">&#39;Mazda RX4 Wag&#39;</span>), ]
<span class="co">#&gt;               mpg cyl disp  hp drat   wt qsec vs am gear carb</span>
<span class="co">#&gt; Mazda RX4      21   6  160 110  3.9 2.62 16.5  0  1    4    4</span>
<span class="co">#&gt; Mazda RX4 Wag  21   6  160 110  3.9 2.88 17.0  0  1    4    4</span>
mtcars[<span class="kw">str_detect</span>(<span class="kw">rownames</span>(mtcars), <span class="st">&quot;Mazda&quot;</span> ), ]
<span class="co">#&gt;               mpg cyl disp  hp drat   wt qsec vs am gear carb</span>
<span class="co">#&gt; Mazda RX4      21   6  160 110  3.9 2.62 16.5  0  1    4    4</span>
<span class="co">#&gt; Mazda RX4 Wag  21   6  160 110  3.9 2.88 17.0  0  1    4    4</span></code></pre></div>
<ul>
<li>También se puede seleccionar o filtrar el data.frame dado una condición:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mtcars[mtcars<span class="op">$</span>cyl <span class="op">==</span><span class="st"> </span><span class="dv">6</span>, ] <span class="co"># Selecciona los carros con número de cilindros mayor a 6</span>
<span class="co">#&gt;                 mpg cyl disp  hp drat   wt qsec vs am gear carb</span>
<span class="co">#&gt; Mazda RX4      21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span>
<span class="co">#&gt; Mazda RX4 Wag  21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span>
<span class="co">#&gt; Hornet 4 Drive 21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span>
<span class="co">#&gt; Valiant        18.1   6  225 105 2.76 3.46 20.2  1  0    3    1</span>
<span class="co">#&gt; Merc 280       19.2   6  168 123 3.92 3.44 18.3  1  0    4    4</span>
<span class="co">#&gt; Merc 280C      17.8   6  168 123 3.92 3.44 18.9  1  0    4    4</span>
<span class="co">#&gt; Ferrari Dino   19.7   6  145 175 3.62 2.77 15.5  0  1    5    6</span></code></pre></div>
<ul>
<li><code>rbind</code> permite unir dos data.frames por renglones, si y solo si, tiene el mismo número de columnas:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rbind</span>(mtcars[<span class="kw">str_detect</span>(<span class="kw">rownames</span>(mtcars), <span class="st">&quot;Mazda&quot;</span> ), ],
      mtcars[<span class="kw">str_detect</span>(<span class="kw">rownames</span>(mtcars), <span class="st">&quot;Hornet&quot;</span>), ])
<span class="co">#&gt;                    mpg cyl disp  hp drat   wt qsec vs am gear carb</span>
<span class="co">#&gt; Mazda RX4         21.0   6  160 110 3.90 2.62 16.5  0  1    4    4</span>
<span class="co">#&gt; Mazda RX4 Wag     21.0   6  160 110 3.90 2.88 17.0  0  1    4    4</span>
<span class="co">#&gt; Hornet 4 Drive    21.4   6  258 110 3.08 3.21 19.4  1  0    3    1</span>
<span class="co">#&gt; Hornet Sportabout 18.7   8  360 175 3.15 3.44 17.0  0  0    3    2</span></code></pre></div>
<ul>
<li><code>cbind</code> permite unir dos data.frames por columna, si y solo si, tiene el mismo número de renglones:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">tabla &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
<span class="dt">n =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>,
<span class="dt">frutas =</span> <span class="kw">c</span>(<span class="st">&quot;apple&quot;</span>, <span class="st">&quot;banana&quot;</span>, <span class="st">&quot;orange&quot;</span>, <span class="st">&quot;pineapple&quot;</span>, <span class="st">&quot;lemon&quot;</span>, <span class="st">&quot;apple&quot;</span>), 
<span class="dt">valor =</span> <span class="kw">runif</span>(<span class="dv">6</span>)
)
tabla
<span class="co">#&gt;   n    frutas  valor</span>
<span class="co">#&gt; 1 1     apple 0.8746</span>
<span class="co">#&gt; 2 2    banana 0.1749</span>
<span class="co">#&gt; 3 3    orange 0.0342</span>
<span class="co">#&gt; 4 4 pineapple 0.3204</span>
<span class="co">#&gt; 5 5     lemon 0.4023</span>
<span class="co">#&gt; 6 6     apple 0.1957</span>
tabla.color &lt;-<span class="st">  </span><span class="kw">data.frame</span>(
<span class="dt">peso =</span> <span class="kw">rnorm</span>(<span class="dv">6</span>),
<span class="dt">color =</span>   <span class="kw">c</span>(<span class="st">&#39;rojo&#39;</span>, <span class="st">&#39;amarillo&#39;</span>, <span class="st">&#39;naranje&#39;</span>, <span class="st">&#39;amarillo&#39;</span>, <span class="st">&#39;amarillo&#39;</span>, <span class="st">&#39;rojo&#39;</span>)
)
tabla.color
<span class="co">#&gt;     peso    color</span>
<span class="co">#&gt; 1 -0.244     rojo</span>
<span class="co">#&gt; 2 -0.283 amarillo</span>
<span class="co">#&gt; 3 -0.554  naranje</span>
<span class="co">#&gt; 4  0.629 amarillo</span>
<span class="co">#&gt; 5  2.065 amarillo</span>
<span class="co">#&gt; 6 -1.631     rojo</span>
<span class="kw">cbind</span>(tabla, tabla.color)
<span class="co">#&gt;   n    frutas  valor   peso    color</span>
<span class="co">#&gt; 1 1     apple 0.8746 -0.244     rojo</span>
<span class="co">#&gt; 2 2    banana 0.1749 -0.283 amarillo</span>
<span class="co">#&gt; 3 3    orange 0.0342 -0.554  naranje</span>
<span class="co">#&gt; 4 4 pineapple 0.3204  0.629 amarillo</span>
<span class="co">#&gt; 5 5     lemon 0.4023  2.065 amarillo</span>
<span class="co">#&gt; 6 6     apple 0.1957 -1.631     rojo</span></code></pre></div>
<p><strong>Nota:</strong> Una forma de seleccionar una columna es con el símbolo <strong>$</strong> (pesitos) y el nombre de la columna.</p>
<p><br></p>
<p><br></p>
<p><img src="figuras/manicule.jpg" /> <code>Ejercicio</code>: Del data.frame <strong>mtcars</strong> realiza lo siguiente:</p>
<ol style="list-style-type: decimal">
<li><p>Calcula el promedio de cilindros <em>cyl</em> en los datos.</p></li>
<li><p>Calcula el número de autos con peso <em>wt</em> mayor a 2.</p></li>
<li><p>Extrae la información de los coches <em>Merc</em>.</p></li>
<li><p>Calcula el promedio de millas por galón <em>mpg</em> de los autos <em>Merc</em>.</p></li>
</ol>
<p><br></p>
</div>
<div id="listas" class="section level3">
<h3><span class="header-section-number">2.4.3</span> Listas</h3>
<p>La lista es una estructura de datos de una dimensión que permite distintas clases de elementos en el objeto. La función <code>list()</code> permite crear objetos de esta clase. Por ejemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lista &lt;-<span class="st"> </span><span class="kw">list</span>( <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">x =</span> <span class="st">&#39;hello&#39;</span>, 
             <span class="dt">frutas =</span> fruits, <span class="dt">tabla =</span> tabla, 
             <span class="dt">ejemlista =</span> <span class="kw">list</span>(<span class="dt">a =</span> <span class="dv">15</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)
)
lista
<span class="co">#&gt; $n</span>
<span class="co">#&gt; [1] 100</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $x</span>
<span class="co">#&gt; [1] &quot;hello&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $frutas</span>
<span class="co">#&gt; [1] &quot;banana&quot;    &quot;apple&quot;     &quot;banana&quot;    &quot;orange&quot;    &quot;pineapple&quot; &quot;lemon&quot;    </span>
<span class="co">#&gt; [7] &quot;kiwi&quot;      &quot;apple&quot;    </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $tabla</span>
<span class="co">#&gt;   n    frutas  valor</span>
<span class="co">#&gt; 1 1     apple 0.8746</span>
<span class="co">#&gt; 2 2    banana 0.1749</span>
<span class="co">#&gt; 3 3    orange 0.0342</span>
<span class="co">#&gt; 4 4 pineapple 0.3204</span>
<span class="co">#&gt; 5 5     lemon 0.4023</span>
<span class="co">#&gt; 6 6     apple 0.1957</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ejemlista</span>
<span class="co">#&gt; $ejemlista$a</span>
<span class="co">#&gt; [1] 15 16 17 18 19 20</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ejemlista$b</span>
<span class="co">#&gt; [1] 1 2 3 4 5</span></code></pre></div>
<p>La lista anterior contiene numeros, caracteres, vectores, data.frames e incluso otra lista con distintas secuencias.</p>
<p>Se puede indexar una lista de varias formas:</p>
<ul>
<li>Usando <strong><code>[ ]</code></strong>: extrae el objeto como una lista, incluyendo el nombre asignado:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lista[<span class="dv">1</span>]
<span class="co">#&gt; $n</span>
<span class="co">#&gt; [1] 100</span></code></pre></div>
<ul>
<li>Usando <strong><code>[[ ]]</code></strong>: extrae únicamente el objeto respetando la clase de éste y sin incluir nombres:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lista[[<span class="dv">1</span>]]
<span class="co">#&gt; [1] 100</span></code></pre></div>
<ul>
<li>Usando <strong>$</strong> mas el nombre: extrae únicamente el objeto:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lista<span class="op">$</span>ejemlista<span class="op">$</span>a
<span class="co">#&gt; [1] 15 16 17 18 19 20</span></code></pre></div>
<p><br></p>
</div>
</div>
<div id="r-markdown" class="section level2">
<h2><span class="header-section-number">2.5</span> R Markdown</h2>
<p>R Markdown es un sistema para crear documentos, en los cuales se combina tu código de R, los resultados y el texto que escribes como comentario en forma de prosa.</p>
<p>Algunas ventajas y características de R Markdown son:</p>
<ul>
<li><p>cualquier R markdown <strong>Rmd</strong> es totalmente reproducible</p></li>
<li><p>admite docenas de formatos de salida, como archivos PDF, Word, presentaciones de diapositivas y más.</p></li>
<li><p>es muy útil para los tomadores de decisiones, quienes quieren enfocarse en las conclusiones, no en el código detrás del análisis.</p></li>
<li><p>permite colaborar con otras personas de estadística que estén interesadas en tus conclusiones y cómo llegaste a ellas</p></li>
</ul>
<div id="que-es-r-markdown" class="section level3">
<h3><span class="header-section-number">2.5.1</span> ¿Qué es R Markdown?</h3>
<p>R Markdown integra código de R, comandos de TeX y muchas herramientas externas. Cuando construyes el documento, R Markdown envía un archivo con formato .Rmd a otro paquete llamado <strong>knitr</strong>, <a href="http://yihui.name/knitr/" class="uri">http://yihui.name/knitr/</a>, que ejecuta el código de todos los chunks y crea un nuevo archivo de <strong>markdown</strong> con formato <em>md</em> que ya incluye el código y los resultados. Este archivo de markdown generado por knitr después es procesado por <strong>pandoc</strong>, <a href="http://pandoc.org/" class="uri">http://pandoc.org/</a>, que es el que crea el archivo final. La ventaja de este flujo de trabajo de dos pasos es que te permite crear una amplia gama de formatos de salida.</p>
<p><img src="figuras/RMarkdownFlow.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
</div>
<div id="estructura-basica-de-r-markdown" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Estructura básica de R Markdown</h3>
<p>Éste es un R Markdown, un archivo de texto sin formato que tiene la extensión <code>.Rmd</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cat</span>(htmltools<span class="op">::</span><span class="kw">includeText</span>(<span class="st">&quot;rmarkdown/ejemplo.Rmd&quot;</span>))
<span class="co">#&gt; ---</span>
<span class="co">#&gt; title: &quot;Ejemplo de R Markdown&quot;</span>
<span class="co">#&gt; date: 2018-01-22</span>
<span class="co">#&gt; output: html_document</span>
<span class="co">#&gt; ---</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Veamos unos datos de diamantes para analizar la distribución</span>
<span class="co">#&gt; del quilataje de aquellos diamantes que tiene quilataje </span>
<span class="co">#&gt; menor a 2.5: </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ```{r setup, include = FALSE}</span>
<span class="co">#&gt; library(ggplot2)</span>
<span class="co">#&gt; library(dplyr)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; smaller &lt;- diamonds %&gt;% </span>
<span class="co">#&gt;   filter(carat &lt;= 2.5)</span>
<span class="co">#&gt; ```</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; En el __chunk__ de arriba se hizo el filtro adecuado, ahora</span>
<span class="co">#&gt; veamos una muestra de tamaño 10 de los datos:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ```{r, echo = FALSE}</span>
<span class="co">#&gt; smaller %&gt;%</span>
<span class="co">#&gt;   sample_n(10) %&gt;%</span>
<span class="co">#&gt;   knitr::kable()</span>
<span class="co">#&gt; ```</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Los datos corresponde a `r nrow(diamonds)` diamantes. Solamente</span>
<span class="co">#&gt; `r nrow(diamonds) - nrow(smaller)` son de más de 2.5 quilates.</span>
<span class="co">#&gt; La distribución de los diamantes de menor quilataje se muestra abajo:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ```{r, echo = FALSE}</span>
<span class="co">#&gt; smaller %&gt;% </span>
<span class="co">#&gt;   ggplot(aes(carat)) + </span>
<span class="co">#&gt;   geom_freqpoly(binwidth = 0.01)</span>
<span class="co">#&gt; ```</span></code></pre></div>
<p>Contiene tres tipos importantes de contenido:</p>
<p>1 Un encabezado en formato <strong>YAML</strong> rodeado por <code>---</code>s..</p>
<ol start="2" style="list-style-type: decimal">
<li><p><strong>Chunks</strong> de código de R rodeados por <code>```</code>.</p></li>
<li><p>Texto mezclado con formato de texto simple como <code># heading</code> y <code>_italics_</code>.</p></li>
</ol>
<p>Cuando abres un <code>.Rmd</code>, RStudio muestra una interfaz de tipo <em>notebook</em> en la cual tanto el código como la salida están intercalados. Puedes ejecutars cada <em>chunk</em> de código presionando el botón de “Run” (en la parte superior derecha de la ventana de script), o bien, Cmd/Ctrl + Shift + Enter. RStudio ejecuta el código y muestra los resultados junto con el código.</p>
<p>Para generar un informe completo que contenga todo el texto, el código y los resultados, presiona el botón “Knit”, o bien, Cmd/Ctrl + Shift + K. Esto generará un reporte en una nueva ventana y creará un archivo HTML independiente que podrás compartir con los demás.</p>
<p><img src="rmarkdown/ejemplo.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Para comenzar con tu propio archivo <code>.Rmd</code>, selecciona <em>File &gt; New File &gt; R Markdown…</em> en la barra superior. RStudio te mostrará un asistente que puedes usar para crear un archivo de R Markdown con ejemplos básicos.</p>
<p>Como R Markdown integara varias herramientas, entonces no es posible que la ayuda esté autocontenida en RStudio. Esto significa que gran parte de la ayuda no la podrás encontrar a través de <code>?</code>. Hay mucha documentación en línea y un recurso es particularmente útil son los <em>cheatsheets</em> de RStudio, que están disponibles en <a href="http://rstudio.com/cheatsheets">http://rstudio.com/cheatsheets.</a></p>
</div>
</div>
<div id="proyectos-de-rstudio" class="section level2">
<h2><span class="header-section-number">2.6</span> Proyectos de RStudio</h2>
<p>Los proyectos de RStudio son útiles para mantener juntos todos los archivos asociados a un análisis (o proyecto) específico: datos de entrada, scripts de R, resultados, gráficas, datos de salida. Ésta es una práctica limpia y ordenada de trabajar y RStudio tiene soporte integrado para esto a través de los <em>proyectos</em>.</p>
<p>Hagamos un proyecto. Para esto debes presionar <em>File &gt; New Project</em>, luego:</p>
<p><img src="figuras/rstudio-project-1.png" width="50%" style="display: block; margin: auto;" /></p>
<p><img src="figuras/rstudio-project-2.png" width="50%" style="display: block; margin: auto;" /></p>
<p><img src="figuras/rstudio-project-3.png" width="50%" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>Puedes cerrar el proyecto y después hacer doble click en el archivo <code>.Rproj</code> para volver a abrir el proyecto. Observa que regresas a donde estabas, en el mismo directorio de trabajo, con el mismo historial de comandos, y todos los archivos en los que estaba trabajando siguen abiertos.</p>
<p>En resumen, los proyectos de RStudio te brindan un flujo de trabajo sólido que te servirá en el futuro:</p>
<ul>
<li><p>Creas un proyecto de RStudio para cada proyecto de análisis de datos.</p></li>
<li><p>Mantienes los archivos de datos ahí mismo para después cargarlos en un script.</p></li>
<li><p>Mantienes tus scripts organizados en el mismo directorio, y los puedes encontrar fácilmente para editarlos y ejecutarlos.</p></li>
<li><p>Puedes guardar ahí mismo las salidas del código, como gráficas y datos limpios.</p></li>
<li><p>Solamente utilizas rutas relativas, no absolutas.</p></li>
</ul>
<p>Todo lo que necesitas está en un solo lugar y separado de los demás proyectos en los que estés trabajando.</p>
</div>
<div id="otros-aspectos-importantes-de-r" class="section level2">
<h2><span class="header-section-number">2.7</span> Otros aspectos importantes de R</h2>
<div id="valores-faltantes" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Valores faltantes</h3>
<p>En R los datos faltantes se expresan como <code>NA</code>. La función <code>is.na()</code> regresa un vector lógico sobre los valores que son o no <code>NA</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.na</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="ot">NA</span>))
<span class="co">#&gt; [1] FALSE FALSE  TRUE</span></code></pre></div>

<div class="comentario">
El default de R es propagar los valores faltantes, esto es, si se desconoce el valor de una de las componentes de un vector, también se desconoce la suma del mismo, en general, cualquier operación.
</div>

<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="ot">NA</span>))
<span class="co">#&gt; [1] NA</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="ot">NA</span>))
<span class="co">#&gt; [1] NA</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="dv">3</span> <span class="op">&gt;</span><span class="st"> </span><span class="ot">NA</span>
<span class="co">#&gt; [1] NA</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(<span class="ot">NA</span> <span class="op">==</span><span class="st"> </span><span class="ot">NA</span>)
<span class="co">#&gt; [1] NA</span></code></pre></div>
<p>Sin embargo, muchas funciones tienen un argumento <code>na.rm</code> para removerlos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="ot">NA</span>), <span class="dt">na.rm =</span> T)
<span class="co">#&gt; [1] 6</span>
<span class="kw">mean</span>(<span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="ot">NA</span>), <span class="dt">na.rm =</span> T)
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p><br></p>
<hr />
</div>
<div id="funciones" class="section level3">
<h3><span class="header-section-number">2.7.2</span> Funciones</h3>
<blockquote>
<p>Todo lo que sucede en R es una función.</p>
</blockquote>
<p>R es un <em>lenguaje de programación funcional</em>. Es decir, proporciona muchas herramientas para la creación y manipulación de funciones.</p>
<p>En R las funciones, al igual que los vectores, se pueden asignar a variables, guardarlas en listas, usarlas como argumentos en otras funciones, crearlas dentro de otras funciones, e incluso regresar como resultado de una función más funciones.</p>
<div id="una-caja-negra" class="section level4 unnumbered">
<h4>Una caja negra</h4>

<div class="information">
Una función puede verse como una caja negra que realiza un proceso o serie de instrucciones condicionadas a un valor de entrada, y cuyo resultado es un valor de salida.
</div>

<p>En R existen algunas funciones pre cargadas que ya hemos usado, por ejemplo, .la función <code>mean()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">input &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)
output &lt;-<span class="st"> </span><span class="kw">mean</span>( input )
output
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p>Sin embargo, también es posible escribir nuestras propias funciones.</p>
<p><br></p>
</div>
<div id="escibir-una-funcion" class="section level4 unnumbered">
<h4>Escibir una función</h4>
<p>En R es posible escribir funciones y es muy recomendable para dar soluciones a problemas simples.</p>
<p>Existen ocasiones en las que al programar copias y pegas cierto código varias veces para una meta en especial. En ese momento, es necesario pasar el código a una función.</p>

<div class="nota">
Una función soluciona un problema en particular.
</div>

<p>La función <code>function()</code> nos permite crear funciones con la siguiente estructura:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_fun &lt;-<span class="st"> </span><span class="cf">function</span>( arg1 ){
  
  body
  
  <span class="kw">return</span>()
}</code></pre></div>

<div class="warning">
En general, esta estructura se respeta en las funciones predeterminadas de R.
</div>

<p>Creamos una función que sume uno a cualquier número.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">suma_uno_fun &lt;-<span class="st"> </span><span class="cf">function</span>( x ){
   y =<span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
   <span class="kw">return</span>(y)
}</code></pre></div>
<p>Aplicamos la función:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">suma_uno_fun</span>(<span class="dv">5</span>)
<span class="co">#&gt; [1] 6</span></code></pre></div>
<p>Podemos ver que en nuestra sesión ya existe la función con la función <code>ls()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ls</span>()
<span class="co">#&gt;  [1] &quot;a&quot;            &quot;b&quot;            &quot;bool&quot;         &quot;c&quot;           </span>
<span class="co">#&gt;  [5] &quot;fruits&quot;       &quot;fruits.fac&quot;   &quot;input&quot;        &quot;iris&quot;        </span>
<span class="co">#&gt;  [9] &quot;lista&quot;        &quot;output&quot;       &quot;suma_uno_fun&quot; &quot;tabla&quot;       </span>
<span class="co">#&gt; [13] &quot;tabla.color&quot;  &quot;tenweeks&quot;     &quot;x&quot;</span></code></pre></div>
<p>Esta función en lista los objetos existente en la sesión actual.</p>
<p><br></p>
</div>
<div id="argumentos-de-funciones" class="section level4 unnumbered">
<h4>Argumentos de funciones</h4>
<p>En R los argumentos de las funciones pueden llamarse por <strong>posición</strong> o <strong>nombre</strong>. Consideremos la siguiente función en la que se eleva un numero a un exponente determinado.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">potencia_fun &lt;-<span class="st"> </span><span class="cf">function</span>(base, exponente){
  base<span class="op">^</span>exponente
}</code></pre></div>
<p>Los argumentos pueden indicarse por posición:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">potencia_fun</span>(<span class="dv">2</span>, <span class="dv">3</span>)
<span class="co">#&gt; [1] 8</span></code></pre></div>
<p>O bien por nombre:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">potencia_fun</span>(<span class="dt">exponente =</span> <span class="dv">2</span>, <span class="dt">base =</span> <span class="dv">3</span>)
<span class="co">#&gt; [1] 9</span></code></pre></div>
<p><br></p>
</div>
<div id="argumentos-predeterminados" class="section level4 unnumbered">
<h4>Argumentos predeterminados</h4>
<p>En una función es posible asignar valores predeterminados a los argumentos.</p>
<p>Por ejemplo, modificamos la función para asignar un valor predeterminado del exponente.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">potencia_default_fun &lt;-<span class="st"> </span><span class="cf">function</span>(base, <span class="dt">exponente =</span> <span class="dv">2</span>){
  base<span class="op">^</span>exponente
}</code></pre></div>
<p>Al llamar la función, no es necesario definir un valor para el exponente y en automático tomará el valor <code>exponente = 2</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">potencia_default_fun</span>(<span class="dv">2</span>)
<span class="co">#&gt; [1] 4</span></code></pre></div>
<p><br></p>
</div>
<div id="argumentos-nulos" class="section level4 unnumbered">
<h4>Argumentos nulos</h4>
<p>Una función puede no tener argumentos y simplemente correr un proceso.</p>
<p>En este caso, usaremos la función <code>sample()</code> que elige una muestra aleatoria de tamaño 1 de un vector de 1 a 6 imitando un dado dentro la la función <code>lanza_dado()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lanza_dado &lt;-<span class="st"> </span><span class="cf">function</span>() {
  numero &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">1</span>)
  numero
}</code></pre></div>
<p>Ahora tiraremos dos veces los dados.</p>
<p><strong>Primer lanzamiento:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lanza_dado</span>()
<span class="co">#&gt; [1] 5</span></code></pre></div>
<p><strong>Segundo lanzamiento:</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lanza_dado</span>()
<span class="co">#&gt; [1] 5</span></code></pre></div>
<hr />
<p><br></p>
</div>
<div id="alcance-de-la-funcion" class="section level4 unnumbered">
<h4>Alcance de la función</h4>
<p>Es importante mencionar que las variables que son definidas dentro de la función no son accesibles fuera de la función. Es decir, las funciones en R tienen un <strong>ambiente local</strong>.</p>
<p>Por ejemplo, al correr la siguiente función e intentar imprimir el objeto <code>x</code> regresa un error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xs_fun &lt;-<span class="st"> </span><span class="cf">function</span>(a){
  x &lt;-<span class="st"> </span><span class="dv">2</span>
  a<span class="op">*</span>x
}
<span class="kw">xs_fun</span>(<span class="dv">2</span>)
<span class="co">#&gt; [1] 4</span>
<span class="co"># print(x)</span></code></pre></div>
<p>La función crea un ambiente nuevo dentro de la misma, en caso de no encontrar el valor de la variable en el ambiente local, <strong>sube un nivel</strong>.</p>
<p>Este nuevo nivel puede ser el ambiente global. Por ejemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="dv">10</span>
ys_fun &lt;-<span class="st"> </span><span class="cf">function</span>(a){
  a<span class="op">*</span>y
}
<span class="kw">ys_fun</span>(<span class="dv">2</span>)
<span class="co">#&gt; [1] 20</span></code></pre></div>
<p>Si la función está contenida en otra función, primero buscará en el ambiente local, después en el ambiente local de la función superior y luego en el ambiente global.</p>
<p>Por ejemplo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="dv">10</span>
mas_uno_fun &lt;-<span class="st"> </span><span class="cf">function</span>(a){
  c &lt;-<span class="st"> </span><span class="dv">1</span>
  y &lt;-<span class="st"> </span><span class="dv">1</span>
  ys_add_fun &lt;-<span class="st"> </span><span class="cf">function</span>(a){
    a<span class="op">*</span>y <span class="op">+</span><span class="st"> </span>c
  }
  <span class="kw">ys_add_fun</span>(a)
}</code></pre></div>
<p>Si llamamos la función con un valor <code>a = 2</code> al igual que en el ejemplo anterior, ¿por qué da el siguiente resultado y no 21 o 20?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mas_uno_fun</span>(<span class="dt">a =</span> <span class="dv">2</span>)
<span class="co">#&gt; [1] 3</span></code></pre></div>
<p><br></p>
<hr />
</div>
<div id="funciones-para-funciones" class="section level4 unnumbered">
<h4>Funciones para funciones</h4>
<p>O bien funciones para entender las partes de la función.</p>
<ul>
<li><code>body()</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">body</span>(suma_uno_fun)
<span class="co">#&gt; {</span>
<span class="co">#&gt;     y = x + 1</span>
<span class="co">#&gt;     return(y)</span>
<span class="co">#&gt; }</span></code></pre></div>
<ul>
<li><code>args()</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(mean.default)
<span class="co">#&gt; function (x, trim = 0, na.rm = FALSE, ...) </span>
<span class="co">#&gt; NULL</span></code></pre></div>
<ul>
<li><code>if()</code> Una función que se usa al programar funciones es <code>if()</code> que permite agregar una condición.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">divide_fun &lt;-<span class="st"> </span><span class="cf">function</span>(num, den){
  <span class="cf">if</span>(den <span class="op">==</span><span class="st"> </span><span class="dv">0</span>){
    <span class="kw">return</span>(<span class="st">&quot;Denominador es cero&quot;</span>)
  }<span class="cf">else</span>{
    <span class="kw">return</span>(num<span class="op">/</span>den)
  }
}</code></pre></div>
<p>Al ejecutar la función y tener cero en el denominador imprime el string.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">divide_fun</span>(<span class="dv">10</span>, <span class="dv">0</span>)
<span class="co">#&gt; [1] &quot;Denominador es cero&quot;</span></code></pre></div>
<p>Al no tener cero en el denominador la operación se ejecuta.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">divide_fun</span>(<span class="dv">10</span>, <span class="dv">2</span>)
<span class="co">#&gt; [1] 5</span></code></pre></div>
<p><br></p>
<hr />
<p><br></p>
<p>Todas las operaciones en R son producto de la llamada a una función, esto incluye operaciones como +, operadores que controlan flujo como for, if y while, e incluso operadores para obtener subconjuntos como <code>[ ]</code> y <code>$</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">3</span>
y &lt;-<span class="st"> </span><span class="dv">4</span>
<span class="st">`</span><span class="dt">+</span><span class="st">`</span>(x, y)
<span class="co">#&gt; [1] 7</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>) <span class="kw">print</span>(i)
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; [1] 2</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="st">`</span><span class="dt">for</span><span class="st">`</span>(i, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>, <span class="kw">print</span>(i))
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; [1] 2</span></code></pre></div>
<p><br></p>
<p>Cuando llamamos a una función podemos especificar los argumentos con base en la posición, el nombre completo o el nombre parcial:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(abcdef, bcde1, bcde2) {
  <span class="kw">list</span>(<span class="dt">a =</span> abcdef, <span class="dt">b1 =</span> bcde1, <span class="dt">b2 =</span> bcde2)
}
<span class="kw">str</span>(<span class="kw">f</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ a : num 1</span>
<span class="co">#&gt;  $ b1: num 2</span>
<span class="co">#&gt;  $ b2: num 3</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">f</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dt">abcdef =</span> <span class="dv">1</span>))
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ a : num 1</span>
<span class="co">#&gt;  $ b1: num 2</span>
<span class="co">#&gt;  $ b2: num 3</span></code></pre></div>
<p><br></p>
<p>Podemos abreviar el nombre de los argumentos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">f</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dt">a =</span> <span class="dv">1</span>))
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ a : num 1</span>
<span class="co">#&gt;  $ b1: num 2</span>
<span class="co">#&gt;  $ b2: num 3</span></code></pre></div>
<p>Siempre y cuando la abreviación no sea ambigua:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#f(1, 3, b = 1)</span></code></pre></div>
<p>Los argumentos de las funciones en R se evaluan conforme se necesitan:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f &lt;-<span class="st"> </span><span class="cf">function</span>(a, b){
  a <span class="op">^</span><span class="st"> </span><span class="dv">2</span>
}
<span class="kw">f</span>(<span class="dv">2</span>)
<span class="co">#&gt; [1] 4</span></code></pre></div>
<p>La función anterior nunca utiliza el argumento b, de tal manera que f(2) no produce ningún error.</p>
<p><br></p>
</div>
</div>
<div id="funcionales" class="section level3">
<h3><span class="header-section-number">2.7.3</span> Funcionales</h3>
<p>La familia de funciones <strong>apply</strong> pertenece a la librería <code>base</code> en R y facilitan la manipulación de datos de forma repetitiva.</p>
<p>Las funciones de esta familia son: <code>apply()</code>, <code>lapply()</code>, <code>sapply()</code>, <code>vapply()</code>, <code>mapply()</code>, <code>rapply()</code>, y <code>tapply()</code>.</p>

<div class="comentario">
La estructura de los datos de entrada y el formato del resultado o salida determinarán cual función usar.
</div>

<p>En este taller solo se verán las primeras tres funciones.</p>
<hr />
<div id="apply" class="section level4 unnumbered">
<h4>apply()</h4>
<p>Esta es la función que manipula arreglos homogéneos, en particular, se revisa el caso de matrices que son arreglos de dos dimensiones.</p>
<p>La función tiene los siguientes argumentos: <code>apply(X, MARGIN, FUN, ...)</code></p>
<ul>
<li><p><code>X</code> representa el arreglo de dos dimensiones.</p></li>
<li><p><code>MARGIN</code> representa la dimensión sobre la que se va a resumir la información. Donde <strong>1 = renglon o primera dimensión</strong> y <strong>2 = columna o segunda dimensión</strong>.</p></li>
<li><p><code>FUN</code> representa la función que resume la información.</p></li>
</ul>
<p>Tomemos la siguiente matriz de simulaciones:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
mat_norm &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">24</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>), <span class="dt">nrow =</span> <span class="dv">4</span>, <span class="dt">ncol =</span> <span class="dv">6</span>)
mat_norm
<span class="co">#&gt;        [,1]   [,2]   [,3]    [,4]    [,5]    [,6]</span>
<span class="co">#&gt; [1,] -0.626  0.330  0.576 -0.6212 -0.0162  0.9190</span>
<span class="co">#&gt; [2,]  0.184 -0.820 -0.305 -2.2147  0.9438  0.7821</span>
<span class="co">#&gt; [3,] -0.836  0.487  1.512  1.1249  0.8212  0.0746</span>
<span class="co">#&gt; [4,]  1.595  0.738  0.390 -0.0449  0.5939 -1.9894</span></code></pre></div>
<p><br></p>
<p><strong>Deseamos obtener la suma de cada columna de la matriz.</strong></p>
<p><br></p>
<p>El primer método, quizá el mas intuitivo en este momento, es obtener cada elemento o columna, aplicar la función a cada elemento y concatenar:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prom_col_m1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(mat_norm[, <span class="dv">1</span>]), 
                 <span class="kw">sum</span>(mat_norm[, <span class="dv">2</span>]), 
                 <span class="kw">sum</span>(mat_norm[, <span class="dv">3</span>]), 
                 <span class="kw">sum</span>(mat_norm[, <span class="dv">4</span>]),
                 <span class="kw">sum</span>(mat_norm[, <span class="dv">5</span>]),
                 <span class="kw">sum</span>(mat_norm[, <span class="dv">6</span>]))
prom_col_m1
<span class="co">#&gt; [1]  0.317  0.735  2.172 -1.756  2.343 -0.214</span></code></pre></div>
<p>Segundo método:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prom_col_m2 &lt;-<span class="st"> </span><span class="kw">vector</span>( <span class="dt">length =</span> <span class="kw">ncol</span>(mat_norm))
<span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(mat_norm)){
  prom_col_m2[j] &lt;-<span class="st"> </span><span class="kw">sum</span>(mat_norm[, j])
}
prom_col_m2
<span class="co">#&gt; [1]  0.317  0.735  2.172 -1.756  2.343 -0.214</span></code></pre></div>
<p>Tercer método:</p>
<p><img src="figuras/applycol.png" width="70%" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prom_col_m3 &lt;-<span class="st"> </span><span class="kw">apply</span>(<span class="dt">X =</span> mat_norm, <span class="dt">MARGIN =</span> <span class="dv">2</span>, <span class="dt">FUN =</span> sum)
prom_col_m3
<span class="co">#&gt; [1]  0.317  0.735  2.172 -1.756  2.343 -0.214</span></code></pre></div>
<p>Cuarto método:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prom_col_m4 &lt;-<span class="st"> </span><span class="kw">colSums</span>(mat_norm)
prom_col_m4
<span class="co">#&gt; [1]  0.317  0.735  2.172 -1.756  2.343 -0.214</span></code></pre></div>
<p><br></p>
<p>Ahora, para obtener la suma por renglón usando el tercer método de la función <code>apply()</code>, únicamente es necesario cambiar la dimensión sobre la que voy a resumir con el argumento <code>MARGIN = 1</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prom_row_m3 &lt;-<span class="st"> </span><span class="kw">apply</span>(mat_norm, <span class="dv">1</span>, sum)
prom_row_m3
<span class="co">#&gt; [1]  0.56 -1.43  3.18  1.28</span></code></pre></div>
<p>Esto es equivalente al primer método que usamos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">prom_row_m1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">sum</span>(mat_norm[<span class="dv">1</span>, ]), 
                 <span class="kw">sum</span>(mat_norm[<span class="dv">2</span>, ]), 
                 <span class="kw">sum</span>(mat_norm[<span class="dv">3</span>, ]), 
                 <span class="kw">sum</span>(mat_norm[<span class="dv">4</span>, ]))
prom_row_m1
<span class="co">#&gt; [1]  0.56 -1.43  3.18  1.28</span></code></pre></div>
<p>La ventaja de usar la función <code>apply()</code> es que se puede usar cualquier función. Por ejemplo, obtener la desviación estándar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(mat_norm, <span class="dv">1</span>, sd)
<span class="co">#&gt; [1] 0.634 1.172 0.834 1.207</span></code></pre></div>
<p>O bien, una crear una función propia (definida por el usuario) con la función <code>function()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cv_vec_m3 &lt;-<span class="st"> </span><span class="kw">apply</span>(mat_norm, <span class="dv">1</span>, <span class="cf">function</span>(reng){
  cv &lt;-<span class="st"> </span><span class="kw">mean</span>(reng)<span class="op">/</span><span class="kw">sd</span>(reng)
  <span class="kw">return</span>(cv)
})
cv_vec_m3
<span class="co">#&gt; [1]  0.147 -0.204  0.636  0.177</span></code></pre></div>

<div class="nota">
<p><strong>Funciones Anónimas:</strong></p>
A este tipo de funciones se les llama <strong>funciones anónimas</strong> porque no se nombran ni guardan en el ambiente de R y únicamente funcionan dentro del comando que las llama.
</div>

<hr />
</div>
<div id="lapply" class="section level4 unnumbered">
<h4>lapply()</h4>
<p>La función <code>lapply()</code> aplica una función sobre una lista o un vector y regresa el resultado en otra lista.</p>
<p>Vector de ciudades:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ciudades_vec &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Aguascalientes&quot;</span>, <span class="st">&quot;Monterrey&quot;</span>, <span class="st">&quot;Guadalajara&quot;</span>, <span class="st">&quot;México&quot;</span>)
ciudades_vec
<span class="co">#&gt; [1] &quot;Aguascalientes&quot; &quot;Monterrey&quot;      &quot;Guadalajara&quot;    &quot;México&quot;</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res_nchar_l &lt;-<span class="st"> </span><span class="kw">lapply</span>(ciudades_vec, nchar)
res_nchar_l
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 14</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 9</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 11</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] 6</span></code></pre></div>

<div class="comentario">
Esta función permite implementar funciones que regresen objetos de diferentes tipos, porque la listas permiten almacenar contenido heterogéneo.
</div>

<p><br></p>
<p>La función <code>lapply()</code> permite incluir argumentos de las funciones que implementa. Estos argumentos se incluyen dentro de <code>lapply()</code> después de la función a implementar.</p>
<p>Por ejemplo, usamos la función potencia que se creó antes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">potencia_fun &lt;-<span class="st"> </span><span class="cf">function</span>(base, exponente){
  base<span class="op">^</span>exponente
}</code></pre></div>
<p>El objetivo es aplicar a cada elemento de la siguiente lista la función potencia y elevarlo al cubo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nums_lista &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">4</span>)
nums_lista
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 4</span></code></pre></div>
<p>En la función <code>lapply()</code> se agrega el argumento <code>exponente = 3</code> como último argumento.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">potencia_lista &lt;-<span class="st"> </span><span class="kw">lapply</span>(nums_lista, potencia_fun, <span class="dt">exponente =</span> <span class="dv">3</span>)
potencia_lista
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 27</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 64</span></code></pre></div>
<p>Una forma de reducir la lista obtenida a un vector es con la función <code>unlist()</code> que vimos antes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unlist</span>(potencia_lista)
<span class="co">#&gt; [1]  1 27 64</span></code></pre></div>
<p><br></p>
<hr />
</div>
<div id="sapply" class="section level4 unnumbered">
<h4>sapply()</h4>
<p>La función <code>sapply()</code> es muy similar a <code>lapply()</code>. La única diferencia es la <strong>s</strong> que surge de <strong>simplified apply</strong>.</p>
<p>Al igual que <code>lapply()</code> aplica una función sobre una lista o un vector pero simplifica el resultado en un arreglo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res_nchar_s &lt;-<span class="st"> </span><span class="kw">sapply</span>(ciudades_vec, nchar)
res_nchar_s
<span class="co">#&gt; Aguascalientes      Monterrey    Guadalajara         México </span>
<span class="co">#&gt;             14              9             11              6</span></code></pre></div>

<div class="warning">
Esta función es <em>peligrosa</em> ya que únicamente simplifica la estructura del resultado cuando es posible, de lo contrario, regresará una lista igual que <code>lapply()</code>.
</div>

</div>
<div id="funciones-map" class="section level4">
<h4><span class="header-section-number">2.7.3.1</span> Funciones <code>map</code></h4>
<p>Un problema con <code>sapply()</code> y <code>lapply()</code> es que puedes no tener control sobre el <em>tipo</em> que obtienes y esto es importante si el código está dentro de una función:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x1 &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="kw">c</span>(<span class="fl">0.27</span>, <span class="fl">0.37</span>, <span class="fl">0.57</span>, <span class="fl">0.91</span>, <span class="fl">0.20</span>),
  <span class="kw">c</span>(<span class="fl">0.90</span>, <span class="fl">0.94</span>, <span class="fl">0.66</span>, <span class="fl">0.63</span>, <span class="fl">0.06</span>), 
  <span class="kw">c</span>(<span class="fl">0.21</span>, <span class="fl">0.18</span>, <span class="fl">0.69</span>, <span class="fl">0.38</span>, <span class="fl">0.77</span>)
)
x2 &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="kw">c</span>(<span class="fl">0.50</span>, <span class="fl">0.72</span>, <span class="fl">0.99</span>, <span class="fl">0.38</span>, <span class="fl">0.78</span>), 
  <span class="kw">c</span>(<span class="fl">0.93</span>, <span class="fl">0.21</span>, <span class="fl">0.65</span>, <span class="fl">0.13</span>, <span class="fl">0.27</span>), 
  <span class="kw">c</span>(<span class="fl">0.39</span>, <span class="fl">0.01</span>, <span class="fl">0.38</span>, <span class="fl">0.87</span>, <span class="fl">0.34</span>)
)

threshold &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">cutoff =</span> <span class="fl">0.8</span>) x[x <span class="op">&gt;</span><span class="st"> </span>cutoff]
x1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sapply</span>(threshold) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ : num 0.91</span>
<span class="co">#&gt;  $ : num [1:2] 0.9 0.94</span>
<span class="co">#&gt;  $ : num(0)</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x2 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sapply</span>(threshold) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()
<span class="co">#&gt;  num [1:3] 0.99 0.93 0.87</span></code></pre></div>
<p>Las funciones del paquete <code>purrr</code> son útiles porque hacen que los <em>loops</em> sobre vectores sean sencillos:</p>
<ul>
<li><p>tienen nombres similares, y</p></li>
<li><p>tienen argumentos consistentes.</p></li>
</ul>
<p>Hay una función para cada tipo de salida:</p>
<ul>
<li><p><code>map()</code> crea una lista.</p></li>
<li><p><code>map_lgl()</code> crea un vector lógico.</p></li>
<li><p><code>map_int()</code> crea un vector de enteros.</p></li>
<li><p><code>map_dbl()</code> crea un vector numérico.</p></li>
<li><p><code>map_chr()</code> crea un vector de tipo caracter.</p></li>
</ul>
<p>Cada función toma un vector como entrada, aplica una función a cada elemento y luego devuelve un nuevo vector que tiene la misma longitud (y tiene los mismos nombres) que la entrada, y el tipo de vector está determinado por el sufijo de la función.</p>
<p>Por ejemplo, supongamos que deseamos calcular el número de valores únicos en cada columna de <code>iris</code>. Utilizamos, entonces, la función <code>map_int</code> porque deseamos obtener como resultado un vector de enteros donde cada entero represente el número de valores únicos en cada columna:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_int</span>(<span class="dt">.x =</span> iris, <span class="dt">.f =</span> <span class="cf">function</span>(x){<span class="kw">length</span>(<span class="kw">unique</span>(x))
})
<span class="co">#&gt; Sepal.Length  Sepal.Width Petal.Length  Petal.Width      Species </span>
<span class="co">#&gt;           35           23           43           22            3 </span>
<span class="co">#&gt;  Species_ord </span>
<span class="co">#&gt;            3</span></code></pre></div>
<p>Para generar cuatro vectores cada uno de tamaño 5 de valores que provienen de una distribución normal con medias <span class="math inline">\(\mu=-10, 0, 10, 100\)</span> podemos utilizar la función <code>map</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">100</span>)
mu <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">map</span>(rnorm, <span class="dt">n =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">str</span>()
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ : num [1:5] -9.38 -10.06 -10.16 -11.47 -10.48</span>
<span class="co">#&gt;  $ : num [1:5] 0.4179 1.3587 -0.1028 0.3877 -0.0538</span>
<span class="co">#&gt;  $ : num [1:5] 8.62 9.59 9.61 9.94 11.1</span>
<span class="co">#&gt;  $ : num [1:5] 100.8 99.8 99.7 100.7 100.6</span></code></pre></div>
<p>Podemos usar <code>map2()</code> para iterar sobre dos vectores en paralelo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sigma &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">100</span>)
<span class="kw">map2</span>(mu, sigma, rnorm, <span class="dt">n =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>()
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ : num [1:5] -10.69 -10.71 -9.64 -9.23 -10.11</span>
<span class="co">#&gt;  $ : num [1:5] 4.41 1.99 -3.06 1.71 -5.65</span>
<span class="co">#&gt;  $ : num [1:5] 24.33 29.804 6.328 -0.441 15.697</span>
<span class="co">#&gt;  $ : num [1:5] 86.5 340.2 96.1 169 102.8</span></code></pre></div>
<p>Las funciones de <code>map</code> también preservan nombres:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">z &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">y =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">5</span>)
<span class="kw">map_int</span>(z, length)
<span class="co">#&gt; x y </span>
<span class="co">#&gt; 3 2</span></code></pre></div>
<p>Hay algunos <em>shortcuts</em> que podemos usar con <code>.f</code> para guardar un poco de tipeo. Supongamos que queremos ajustar un modelo lineal a cada subconjunto en un conjunto de datos. Pensemos en los datos de <code>mtcars</code> divididos en tres subconjuntos (uno para cada valor de cilindro) y se ajusta el mismo modelo lineal en cada subconjunto (millas por galón <code>mpg</code> vs peso <code>wt</code>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">models &lt;-<span class="st"> </span>mtcars <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>cyl) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> .))</code></pre></div>
<p>Con el símbolo <code>~</code> se puede declarar una <strong>función anónima</strong> con un argumento al cual se hace referencia después utilizando el <code>.</code>.</p>
<p>Cuando vemos muchos modelos, generalmente deseamos extraer un resumen estadístico como la <span class="math inline">\(R^2\)</span>. Para hacer eso necesitamos ejecutar primero <code>summary()</code> y luego extraer el componente llamado <code>r.squared</code>. Podríamos hacer eso usando la abreviatura de funciones anónimas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">models <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">map</span>(summary) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">map_dbl</span>(<span class="op">~</span>.<span class="op">$</span>r.squared)
<span class="co">#&gt;     4     6     8 </span>
<span class="co">#&gt; 0.509 0.465 0.423</span></code></pre></div>
<p>Pero <code>purrr</code> tiene un shortcut para extraer estos componentes en una cadena:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">models <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">map</span>(summary) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">map_dbl</span>(<span class="st">&quot;r.squared&quot;</span>)
<span class="co">#&gt;     4     6     8 </span>
<span class="co">#&gt; 0.509 0.465 0.423</span></code></pre></div>
<p>También se puede usar un número entero para seleccionar elementos por posición:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">list</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="kw">list</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>), <span class="kw">list</span>(<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>))
x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">map_dbl</span>(<span class="dv">2</span>)
<span class="co">#&gt; [1] 2 5 8</span></code></pre></div>
<p>La función <code>pmap()</code> recibe una lista de argumentos para aplicarlos a una función:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">params &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>mean, <span class="op">~</span>sd, <span class="op">~</span>n,
    <span class="dv">5</span>,     <span class="dv">1</span>,  <span class="dv">1</span>,
   <span class="dv">10</span>,     <span class="dv">5</span>,  <span class="dv">3</span>,
   <span class="op">-</span><span class="dv">3</span>,    <span class="dv">10</span>,  <span class="dv">5</span>
)
params <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">pmap</span>(rnorm)
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 4.26</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 10.944  0.975 17.328</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1]  -1.47  18.73   1.76 -10.10   3.11</span></code></pre></div>
<p>Hay un paso más en la complejidad: además de variar los argumentos para una función, también puedes variar la función misma y para esto se usa la función <code>invoke_map()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim &lt;-<span class="st"> </span><span class="kw">tribble</span>(
  <span class="op">~</span>f,      <span class="op">~</span>params,
  <span class="st">&quot;runif&quot;</span>, <span class="kw">list</span>(<span class="dt">min =</span> <span class="op">-</span><span class="dv">1</span>, <span class="dt">max =</span> <span class="dv">1</span>),
  <span class="st">&quot;rnorm&quot;</span>, <span class="kw">list</span>(<span class="dt">sd =</span> <span class="dv">5</span>),
  <span class="st">&quot;rpois&quot;</span>, <span class="kw">list</span>(<span class="dt">lambda =</span> <span class="dv">10</span>)
)
sim <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sim =</span> <span class="kw">invoke_map</span>(f, params, <span class="dt">n =</span> <span class="dv">10</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">str</span>()
<span class="co">#&gt; Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    3 obs. of  3 variables:</span>
<span class="co">#&gt;  $ f     : chr  &quot;runif&quot; &quot;rnorm&quot; &quot;rpois&quot;</span>
<span class="co">#&gt;  $ params:List of 3</span>
<span class="co">#&gt;   ..$ :List of 2</span>
<span class="co">#&gt;   .. ..$ min: num -1</span>
<span class="co">#&gt;   .. ..$ max: num 1</span>
<span class="co">#&gt;   ..$ :List of 1</span>
<span class="co">#&gt;   .. ..$ sd: num 5</span>
<span class="co">#&gt;   ..$ :List of 1</span>
<span class="co">#&gt;   .. ..$ lambda: num 10</span>
<span class="co">#&gt;  $ sim   :List of 3</span>
<span class="co">#&gt;   ..$ : num  -0.65 0.493 -0.79 0.729 0.229 ...</span>
<span class="co">#&gt;   ..$ : num  0.372 -2.948 -2.843 -0.676 5.89 ...</span>
<span class="co">#&gt;   ..$ : int  11 10 8 13 13 12 15 11 5 10</span></code></pre></div>
</div>
</div>
<div id="rendimiento-en-r" class="section level3">
<h3><span class="header-section-number">2.7.4</span> Rendimiento en R</h3>
<blockquote>
<p>“We should forget about small efficiencies, say about 97% of the time: premature optimization is the root of all evil. Yet we should not pass up our opportunities in that critical 3%. A good programmer will not be lulled into complacency by such reasoning, he will be wise to look carefully at the critical code; but only after that code has been identified.” -Donald Knuth</p>
</blockquote>
<p>Diseña primero, luego optimiza. La optimización del código es un proceso iterativo:</p>
<ol style="list-style-type: decimal">
<li><p>Encuentra el cuello de botella (más importante).</p></li>
<li><p>Intenta eliminarlo (no siempre se puede).</p></li>
<li><p>Repite hasta que tu código sea lo suficientemente rápido.</p></li>
</ol>
<div id="diagnosticar" class="section level4 unnumbered">
<h4>Diagnosticar</h4>
<p>Una vez que tienes código que se puede leer y funciona, el perfilamiento (profiling) del código es un método sistemático que nos permite conocer cuanto tiempo se esta usando en diferentes partes del programa.</p>
<p>Comenzaremos con la función system.time (no es perfilamiento aún), esta calcula el timepo en segundos que toma ejecutar una expresión (si hay un error, regresa el tiempo hasta que ocurre el error):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(Lahman)
Batting <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="left">playerID</th>
<th align="right">yearID</th>
<th align="right">stint</th>
<th align="left">teamID</th>
<th align="left">lgID</th>
<th align="right">G</th>
<th align="right">AB</th>
<th align="right">R</th>
<th align="right">H</th>
<th align="right">X2B</th>
<th align="right">X3B</th>
<th align="right">HR</th>
<th align="right">RBI</th>
<th align="right">SB</th>
<th align="right">CS</th>
<th align="right">BB</th>
<th align="right">SO</th>
<th align="right">IBB</th>
<th align="right">HBP</th>
<th align="right">SH</th>
<th align="right">SF</th>
<th align="right">GIDP</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>86418</td>
<td align="left">gilesma01</td>
<td align="right">2005</td>
<td align="right">1</td>
<td align="left">ATL</td>
<td align="left">NL</td>
<td align="right">152</td>
<td align="right">577</td>
<td align="right">104</td>
<td align="right">168</td>
<td align="right">45</td>
<td align="right">4</td>
<td align="right">15</td>
<td align="right">63</td>
<td align="right">16</td>
<td align="right">3</td>
<td align="right">64</td>
<td align="right">108</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td>32692</td>
<td align="left">weathro01</td>
<td align="right">1946</td>
<td align="right">1</td>
<td align="left">NYA</td>
<td align="left">AL</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>80489</td>
<td align="left">tynerja01</td>
<td align="right">2000</td>
<td align="right">2</td>
<td align="left">TBA</td>
<td align="left">AL</td>
<td align="right">37</td>
<td align="right">83</td>
<td align="right">6</td>
<td align="right">20</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">12</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>27504</td>
<td align="left">stephwa01</td>
<td align="right">1937</td>
<td align="right">1</td>
<td align="left">PHI</td>
<td align="left">NL</td>
<td align="right">10</td>
<td align="right">23</td>
<td align="right">1</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">NA</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>22480</td>
<td align="left">cohenan01</td>
<td align="right">1928</td>
<td align="right">1</td>
<td align="left">NY1</td>
<td align="left">NL</td>
<td align="right">129</td>
<td align="right">504</td>
<td align="right">64</td>
<td align="right">138</td>
<td align="right">24</td>
<td align="right">7</td>
<td align="right">9</td>
<td align="right">59</td>
<td align="right">3</td>
<td align="right">NA</td>
<td align="right">31</td>
<td align="right">17</td>
<td align="right">NA</td>
<td align="right">2</td>
<td align="right">11</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>53133</td>
<td align="left">lemonch01</td>
<td align="right">1975</td>
<td align="right">1</td>
<td align="left">CHA</td>
<td align="left">AL</td>
<td align="right">9</td>
<td align="right">35</td>
<td align="right">2</td>
<td align="right">9</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td>27651</td>
<td align="left">chapmsa01</td>
<td align="right">1938</td>
<td align="right">1</td>
<td align="left">PHA</td>
<td align="left">AL</td>
<td align="right">114</td>
<td align="right">406</td>
<td align="right">60</td>
<td align="right">105</td>
<td align="right">17</td>
<td align="right">7</td>
<td align="right">17</td>
<td align="right">63</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">55</td>
<td align="right">94</td>
<td align="right">NA</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td>18626</td>
<td align="left">weavebu01</td>
<td align="right">1920</td>
<td align="right">1</td>
<td align="left">CHA</td>
<td align="left">AL</td>
<td align="right">151</td>
<td align="right">629</td>
<td align="right">102</td>
<td align="right">208</td>
<td align="right">34</td>
<td align="right">8</td>
<td align="right">2</td>
<td align="right">75</td>
<td align="right">19</td>
<td align="right">17</td>
<td align="right">28</td>
<td align="right">23</td>
<td align="right">NA</td>
<td align="right">6</td>
<td align="right">27</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td>53314</td>
<td align="left">perezto01</td>
<td align="right">1975</td>
<td align="right">1</td>
<td align="left">CIN</td>
<td align="left">NL</td>
<td align="right">137</td>
<td align="right">511</td>
<td align="right">74</td>
<td align="right">144</td>
<td align="right">28</td>
<td align="right">3</td>
<td align="right">20</td>
<td align="right">109</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">54</td>
<td align="right">101</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">6</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td>57859</td>
<td align="left">littljo01</td>
<td align="right">1980</td>
<td align="right">1</td>
<td align="left">SLN</td>
<td align="left">NL</td>
<td align="right">52</td>
<td align="right">11</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">lm</span>(R <span class="op">~</span><span class="st"> </span>AB <span class="op">+</span><span class="st"> </span>teamID, Batting))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   3.300   0.068   3.365</span></code></pre></div>
<ul>
<li><p><strong>user time</strong>: Tiempo usado por el CPU(s) para evaluar esta expresión, tiempo que experimenta la computadora.</p></li>
<li><p><strong>elapsed time</strong>: tiempo en el reloj, tiempo que experimenta la persona.</p></li>
</ul>
<p>El tiempo de usuario (user) usualmente es menor que el tiempo transcurrido:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">system.time</span>(<span class="kw">readLines</span>(<span class="st">&quot;http://www.jhsph.edu&quot;</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.024   0.004   0.634</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(parallel)
<span class="kw">system.time</span>(<span class="kw">mclapply</span>(<span class="dv">2000</span><span class="op">:</span><span class="dv">2006</span>, 
  <span class="cf">function</span>(x){
    sub &lt;-<span class="st"> </span><span class="kw">subset</span>(Batting, yearID <span class="op">==</span><span class="st"> </span>x)
    <span class="kw">lm</span>(R <span class="op">~</span><span class="st"> </span>AB, sub)
}, <span class="dt">mc.cores =</span> <span class="dv">5</span>))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.048   0.064   0.088</span></code></pre></div>
<p>Comparemos la velocidad de dplyr con funciones que se encuentran en R estándar y plyr.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dplyr</span>
dplyr_st &lt;-<span class="st"> </span><span class="kw">system.time</span>({
  Batting <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(playerID) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">total =</span> <span class="kw">sum</span>(R, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">n =</span> <span class="kw">n</span>()) <span class="op">%&gt;%</span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="kw">desc</span>(total))
})

<span class="co"># plyr</span>
plyr_st &lt;-<span class="st"> </span><span class="kw">system.time</span>({
    Batting <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>plyr<span class="op">::</span><span class="kw">ddply</span>(<span class="st">&quot;playerID&quot;</span>, plyr<span class="op">::</span>summarise, <span class="dt">total =</span> <span class="kw">sum</span>(R, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">n =</span> <span class="kw">length</span>(R)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(<span class="op">-</span>total)
})

<span class="co"># estándar lento</span>
est_l_st &lt;-<span class="st"> </span><span class="kw">system.time</span>({
  players &lt;-<span class="st"> </span><span class="kw">unique</span>(Batting<span class="op">$</span>playerID)
  n_players &lt;-<span class="st"> </span><span class="kw">length</span>(players)
  total &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n_players)
  n &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">NA</span>, n_players)
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n_players){
    sub_batting &lt;-<span class="st"> </span>Batting[Batting<span class="op">$</span>playerID <span class="op">==</span><span class="st"> </span>players[i], ]
    total[i] &lt;-<span class="st"> </span><span class="kw">sum</span>(sub_batting<span class="op">$</span>R, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
    n[i] &lt;-<span class="st"> </span><span class="kw">nrow</span>(sub_batting)
  }
  batting_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">playerID =</span> players, <span class="dt">total =</span> total, <span class="dt">n =</span> n)
  batting_<span class="dv">2</span>[<span class="kw">order</span>(batting_<span class="dv">2</span><span class="op">$</span>total, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), ]
})

<span class="co"># estándar rápido</span>
est_r_st &lt;-<span class="st"> </span><span class="kw">system.time</span>({
  batting_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">aggregate</span>(. <span class="op">~</span><span class="st"> </span>playerID, <span class="dt">data =</span> Batting[, <span class="kw">c</span>(<span class="st">&quot;playerID&quot;</span>, <span class="st">&quot;R&quot;</span>)], sum)
  batting_ord &lt;-<span class="st"> </span>batting_<span class="dv">2</span>[<span class="kw">order</span>(batting_<span class="dv">2</span><span class="op">$</span>R, <span class="dt">decreasing =</span> <span class="ot">TRUE</span>), ]
})

dplyr_st
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.136   0.000   0.137</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plyr_st
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   6.712   0.016   6.731</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">est_l_st
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;  50.360   0.628  50.988</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">est_r_st
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.568   0.012   0.576</span></code></pre></div>
<p>La función <code>system.time</code> supone que sabes donde buscar, es decir, que expresiones debes evaluar, una función que puede ser más útil cuando uno desconoce cuál es la función que alenta un programa es <code>Rprof()</code>.</p>
<p>Rprof es un perfilador de muestreo que registra cambios en la pila de funciones, funciona tomando muestras a intervalos regulares y tabula cuánto tiempo se lleva en cada función.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Rprof</span>(<span class="st">&quot;out/lm_rprof.out&quot;</span>, <span class="dt">interval =</span> <span class="fl">0.015</span>, <span class="dt">line.profiling =</span> <span class="ot">TRUE</span>)
mod &lt;-<span class="st"> </span><span class="kw">lm</span>(R <span class="op">~</span><span class="st"> </span>AB <span class="op">+</span><span class="st"> </span>teamID, Batting)
<span class="kw">Rprof</span>(<span class="ot">NULL</span>)</code></pre></div>
<p>Usamos la función `summaryRprof para tabular las salidas de Rprof y calcular cuánto tiempo se toma en cada función.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summaryRprof</span>(<span class="st">&quot;out/lm_rprof.out&quot;</span>)
<span class="co">#&gt; $by.self</span>
<span class="co">#&gt;                         self.time self.pct total.time total.pct</span>
<span class="co">#&gt; &quot;lm.fit&quot;                     5.04    95.18       5.05     95.47</span>
<span class="co">#&gt; &quot;.External2&quot;                 0.16     3.12       0.20      3.68</span>
<span class="co">#&gt; &quot;as.character&quot;               0.04     0.85       0.04      0.85</span>
<span class="co">#&gt; &quot;anyDuplicated.default&quot;      0.03     0.57       0.03      0.57</span>
<span class="co">#&gt; &quot;c&quot;                          0.02     0.28       0.02      0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $by.total</span>
<span class="co">#&gt;                         total.time total.pct self.time self.pct</span>
<span class="co">#&gt; &quot;&lt;Anonymous&gt;&quot;                 5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;block_exec&quot;                  5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;call_block&quot;                  5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;do.call&quot;                     5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;eval.parent&quot;                 5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;eval&quot;                        5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;evaluate_call&quot;               5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;evaluate&quot;                    5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;handle&quot;                      5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;in_dir&quot;                      5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;knitr::knit&quot;                 5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;lm&quot;                          5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;local&quot;                       5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;process_file&quot;                5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;process_group.block&quot;         5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;process_group&quot;               5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;timing_fn&quot;                   5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;withCallingHandlers&quot;         5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;withVisible&quot;                 5.29    100.00      0.00     0.00</span>
<span class="co">#&gt; &quot;lm.fit&quot;                      5.05     95.47      5.04    95.18</span>
<span class="co">#&gt; &quot;.External2&quot;                  0.20      3.68      0.16     3.12</span>
<span class="co">#&gt; &quot;model.matrix.default&quot;        0.16      3.12      0.00     0.00</span>
<span class="co">#&gt; &quot;model.matrix&quot;                0.16      3.12      0.00     0.00</span>
<span class="co">#&gt; &quot;as.character&quot;                0.04      0.85      0.04     0.85</span>
<span class="co">#&gt; &quot;model.response&quot;              0.04      0.85      0.00     0.00</span>
<span class="co">#&gt; &quot;anyDuplicated.default&quot;       0.03      0.57      0.03     0.57</span>
<span class="co">#&gt; &quot;[.data.frame&quot;                0.03      0.57      0.00     0.00</span>
<span class="co">#&gt; &quot;[&quot;                           0.03      0.57      0.00     0.00</span>
<span class="co">#&gt; &quot;anyDuplicated&quot;               0.03      0.57      0.00     0.00</span>
<span class="co">#&gt; &quot;model.frame.default&quot;         0.03      0.57      0.00     0.00</span>
<span class="co">#&gt; &quot;na.omit.data.frame&quot;          0.03      0.57      0.00     0.00</span>
<span class="co">#&gt; &quot;na.omit&quot;                     0.03      0.57      0.00     0.00</span>
<span class="co">#&gt; &quot;stats::model.frame&quot;          0.03      0.57      0.00     0.00</span>
<span class="co">#&gt; &quot;c&quot;                           0.02      0.28      0.02     0.28</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sample.interval</span>
<span class="co">#&gt; [1] 0.015</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $sampling.time</span>
<span class="co">#&gt; [1] 5.29</span></code></pre></div>
<p>Hay dos métodos para normalizar los datos de Rprof:</p>
<ol style="list-style-type: decimal">
<li><p><strong>by.total</strong> divide el tiempo que se toma en cada función entre el tiempo total en correr.</p></li>
<li><p><strong>by.self</strong> similar a <strong>by.total</strong> pero primero resta el tiempo que se toman las funciones en la cima de la pila.</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Rprof</span>(<span class="st">&quot;out/plyr_rprof.out&quot;</span>)
Batting <span class="op">%&gt;%</span>
<span class="st">    </span>plyr<span class="op">::</span><span class="kw">ddply</span>(<span class="st">&quot;playerID&quot;</span>, plyr<span class="op">::</span>summarise, <span class="dt">total =</span> <span class="kw">sum</span>(R, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="dt">n =</span> <span class="kw">length</span>(R)) <span class="op">%&gt;%</span>
<span class="st">    </span>plyr<span class="op">::</span><span class="kw">arrange</span>(<span class="op">-</span>total) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">head</span>()
<span class="kw">Rprof</span>(<span class="ot">NULL</span>)
<span class="kw">summaryRprof</span>(<span class="st">&quot;out/plyr_rprof.out&quot;</span>)<span class="op">$</span>by.self[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Rprof(&quot;out/slow_rprof.out&quot;)</span>
<span class="co">#     players &lt;- unique(batting$playerID)</span>
<span class="co">#     n_players &lt;- length(players)</span>
<span class="co">#     total &lt;- rep(NA, n_players)</span>
<span class="co">#     n &lt;- rep(NA, n_players)</span>
<span class="co">#     for(i in 1:n_players){</span>
<span class="co">#       sub_batting &lt;- batting[batting$playerID == players[i], ]</span>
<span class="co">#       total[i] &lt;- sum(sub_batting$R)</span>
<span class="co">#       n[i] &lt;- nrow(sub_batting)</span>
<span class="co">#     }</span>
<span class="co">#     batting_2 &lt;- data.frame(playerID = players, total = total, n = n)</span>
<span class="co">#     batting_2[order(batting_2$total, decreasing = TRUE), ]</span>
<span class="co"># Rprof(NULL)</span>

<span class="kw">summaryRprof</span>(<span class="st">&quot;out/slow_rprof.out&quot;</span>)<span class="op">$</span>by.self[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ]
<span class="co">#&gt;                 self.time self.pct total.time total.pct</span>
<span class="co">#&gt; &quot;[.data.frame&quot;      45.50    54.74      82.74     99.54</span>
<span class="co">#&gt; &quot;==&quot;                24.78    29.81      24.78     29.81</span>
<span class="co">#&gt; &quot;attr&quot;               6.70     8.06       6.70      8.06</span>
<span class="co">#&gt; &quot;NextMethod&quot;         3.42     4.11       3.44      4.14</span>
<span class="co">#&gt; &quot;[[&quot;                 1.32     1.59       2.12      2.55</span>
<span class="co">#&gt; &quot;[[.data.frame&quot;      0.22     0.26       0.80      0.96</span>
<span class="co">#&gt; &quot;&lt;Anonymous&gt;&quot;        0.20     0.24       0.46      0.55</span>
<span class="co">#&gt; &quot;all&quot;                0.10     0.12       0.10      0.12</span>
<span class="co">#&gt; &quot;sys.call&quot;           0.10     0.12       0.10      0.12</span>
<span class="co">#&gt; &quot;%in%&quot;               0.08     0.10       0.22      0.26</span></code></pre></div>
</div>
<div id="estrategias-para-mejorar-desempeno" class="section level4 unnumbered">
<h4>Estrategias para mejorar desempeño</h4>
<ol style="list-style-type: decimal">
<li><p>Utilizar apropiadamente funciones de R, o funciones de paquetes que muchas veces están mejor escritas de lo que nosotros podríamos hacer.</p></li>
<li><p>Hacer lo menos posible.</p></li>
<li><p>Usar funciones vectorizadas en R (casi siempre). No hacer crecer objetos (es preferible definir su tamaño antes de operar en ellos).</p></li>
<li><p>Paralelizar.</p></li>
<li><p>La más simple y muchas veces la más barata: conseguie una máquina más grande (por ejemplo <a href="https://aws.amazon.com/">Amazon Web Services</a>).</p></li>
</ol>
<p><strong>1 Utilizar apropiadamente funciones de R</strong></p>
<p>Si el cuello de botella es la función de un paquete vale la pena buscar alternativas, CRAN task views es un buen lugar para buscar.</p>
<p><strong>2 Hacer lo menos posible</strong></p>
<p>Utiliza funciones más específicas, por ejemplo:</p>
<ul>
<li><p>rowSums(), colSums(), rowMeans() y colMeans() son más rápidas que las invocaciones equivalentes de apply().</p></li>
<li><p>Si quieres checar si un vector contiene un valor any(x == 10) es más veloz que 10 %in% x, esto es porque examinar igualdad es más sencillo que examinar inclusión en un conjunto. Este conocimiento requiere que conozcas alternativas, para ello debes construir tu vocabulario, puedes comenzar por lo <a href="http://adv-r.had.co.nz/Vocabulary.html#vocabulary">básico</a> e ir incrementando conforme lees código.</p></li>
</ul>
<p>Otro caso es cuando las funciones son más rápidas cunado les das más información del problema, por ejemplo:</p>
<ul>
<li><p>read.csv(), especificar las clases de las columnas con colClasses.</p></li>
<li><p>factor() especifica los niveles con el argumento levels.</p></li>
</ul>
<p><strong>3.1 Usar funciones vectorizadas en R</strong></p>
<p>Es común escuchar que en R vectorizar es conveniente, el enfoque vectorizado va más allá que evitar ciclos for:</p>
<ul>
<li><p>Pensar en objetos, en lugar de enfocarse en las compoentes de un vector, se piensa únicamente en el vector completo.</p></li>
<li><p>Los ciclos en las funciones vectorizadas de R están escritos en C, lo que los hace más veloces.</p></li>
</ul>
<p>Las funciones vectorizadas programadas en R pueden mejorar la interfaz de una función pero no necesariamente mejorar el desempeño. Usar vectorización para desempeño implica encontrar funciones de R implementadas en C.</p>
<p>Al igual que en el punto anterior, vectorizar requiere encontrar las funciones apropiadas, algunos ejemplos incluyen: _rowSums(), colSums(), rowMeans() y colMeans().</p>
<p><strong>3.2 Evitar copias</strong></p>
<p>Otro aspecto importante es que generalmente conviene asignar objetos en lugar de hacerlos crecer (es más eficiente asignar toda la memoria necesaria antes del cálculo que asignarla sucesivamente). Esto es porque cuando se usan instrucciones para crear un objeto más grande (e.g. append(), cbind(), c(), rbind()) R debe primero asignar espacio a un nuevo objeto y luego copiar al nuevo lugar. Para leer más sobre esto <a href="http://www.burns-stat.com/pages/Tutor/R_inferno.pdf">The R Inferno</a> es una buena referencia.</p>
<p>Veamos unos ejemplos de vectorización y de asignar objetos.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aciertos &lt;-<span class="st"> </span><span class="ot">FALSE</span> 
<span class="kw">system.time</span>(
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e+05</span>) {
    <span class="cf">if</span> (<span class="kw">runif</span>(<span class="dv">1</span>) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span>)
        aciertos[i] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
})
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.248   0.004   0.248</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">aciertos &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="ot">FALSE</span>, <span class="fl">1e+06</span>) 
<span class="kw">system.time</span>(
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e+05</span>) {
    <span class="cf">if</span> (<span class="kw">runif</span>(<span class="dv">1</span>) <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.3</span>)
        aciertos[i] &lt;-<span class="st"> </span><span class="ot">TRUE</span>
})
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.256   0.000   0.258</span></code></pre></div>
<p>Usando <code>rbind</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crecer_rbind &lt;-<span class="st"> </span><span class="cf">function</span>(){
mi.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="kw">character</span>(<span class="dv">0</span>), <span class="dt">b =</span> <span class="kw">numeric</span>(<span class="dv">0</span>)) 
  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="fl">1e3</span>) {
    mi.df &lt;-<span class="st"> </span><span class="kw">rbind</span>(mi.df, <span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="kw">sample</span>(letters, <span class="dv">1</span>), <span class="dt">b =</span> <span class="kw">runif</span>(<span class="dv">1</span>)))
  }
mi.df
}
<span class="kw">system.time</span>(mi.df.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">crecer_rbind</span>())
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.692   0.000   0.695</span></code></pre></div>
<p>Si definimos el tamaño del data.frame obtenemos mejoras:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crecer_rbind_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="cf">function</span>() {
mi.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">1000</span>), <span class="dt">b =</span> <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="dv">1000</span>)) 
  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>) {
    mi.df<span class="op">$</span>a[i] &lt;-<span class="st"> </span><span class="kw">sample</span>(letters, <span class="dv">1</span>)
    mi.df<span class="op">$</span>b[i] &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>) 
  }
  mi.df
}
<span class="kw">system.time</span>(mi.df.<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">crecer_rbind_2</span>())
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.080   0.000   0.079</span></code></pre></div>
<p>Finalmente, veamos un enfoque totalmente vectorizado</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">porcolumna_df &lt;-<span class="st"> </span><span class="cf">function</span>(){
  a &lt;-<span class="st"> </span><span class="kw">sample</span>(letters, <span class="dv">1000</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>) 
  b &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>)
  mi.df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a =</span> a, <span class="dt">b =</span> b)
  mi.df
}
<span class="kw">system.time</span>(mi.df.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">porcolumna_df</span>())
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   0.000   0.000   0.001</span></code></pre></div>
<p>A pesar de que aumentamos la velocidad conforme aumentamos el nivel de vectorización, este incremento conlleva un costo en memoria. Si comparamos la versión mas lenta con la más rápida, en la última debemos asignar a, b y mi.df. Entonces, no siempre es mejor vectorizar, pues si consumimos la memoria, entonces la versión vectorizada puede enfrentarse al problema de uso de memoria en disco, que tiene aun más grandes penalizaciones en el desempeño que los ciclos que hemos visto.</p>
<p><strong>4 Paralelizar</strong></p>
<p>Paralelizar usa varios cores para trabajar de manera simultánea en varias secciones de un problema, no reduce el tiempo computacional pero incrementa el tiempo del usuario pues aprovecha los recursos. Como referencia está <a href="https://www.amazon.com/Parallel-Computing-Data-Science-Examples/dp/1466587016">Parallel Computing for Data Science</a> de Norm Matloff.</p>
</div>
</div>
</div>
<div id="tarea-1" class="section level2">
<h2><span class="header-section-number">2.8</span> Tarea</h2>
<ol style="list-style-type: decimal">
<li>Considerando la lista siguiente,</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cdmx_list &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">pop =</span> <span class="dv">8918653</span>,
  <span class="dt">delegaciones =</span> <span class="kw">c</span>(<span class="st">&quot;Alvaro Obregón&quot;, &quot;</span>Azcapotzalco<span class="st">&quot; ,&quot;</span>Benito Juárez<span class="st">&quot; ,</span>
<span class="st">                   &quot;</span>Coyoacán<span class="st">&quot; ,&quot;</span>Cuajimalpa de Morelos<span class="st">&quot; ,&quot;</span>Cuauhtémoc<span class="st">&quot; ,</span>
<span class="st">                   &quot;</span>Gustavo A. Madero<span class="st">&quot; ,</span>
<span class="st">                   &quot;</span>Iztacalco<span class="st">&quot; ,&quot;</span>Iztapalapa<span class="st">&quot; ,</span>
<span class="st">                   &quot;</span>Magdalena Contreras<span class="st">&quot; ,&quot;</span>Miguel Hidalgo<span class="st">&quot; ,&quot;</span>Milpa Alta<span class="st">&quot; ,</span>
<span class="st">                   &quot;</span>Tláhuac<span class="st">&quot; ,&quot;</span>Tlalpan<span class="st">&quot; ,</span>
<span class="st">                   &quot;</span>Venustiano Carranza<span class="st">&quot; ,&quot;</span>Xochimilco<span class="st">&quot;),</span>
<span class="st">  capital = TRUE</span>
<span class="st">)</span></code></pre></div>
<p>obtén la clase de cada elemento con la función <code>lapply()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>( , class)</code></pre></div>
<p><br></p>
<hr />
<ol start="2" style="list-style-type: decimal">
<li>La siguiente función extrae la letra de menor posición y mayor posición en orden alfabético.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">min_max_fun &lt;-<span class="st"> </span><span class="cf">function</span>(nombre){
  nombre_sinespacios &lt;-<span class="st"> </span><span class="kw">gsub</span>(<span class="st">&quot; &quot;</span>, <span class="st">&quot;&quot;</span>, nombre)
  letras &lt;-<span class="st"> </span><span class="kw">strsplit</span>(nombre_sinespacios, <span class="dt">split =</span> <span class="st">&quot;&quot;</span>)[[<span class="dv">1</span>]]
  <span class="kw">c</span>(<span class="dt">minimo =</span> <span class="kw">min</span>(letras), <span class="dt">maximo =</span> <span class="kw">max</span>(letras))
}</code></pre></div>
<p>Es decir, si incluimos las letras <code>abcz</code> la letra <em>mínima</em> es a y la <em>máxima</em> es z.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min_max_fun</span>(<span class="st">&quot;abcz&quot;</span>)
<span class="co">#&gt; minimo maximo </span>
<span class="co">#&gt;    &quot;a&quot;    &quot;z&quot;</span></code></pre></div>
<p>El siguiente vector incluye el nombre de las 16 delegaciones de la Ciudad de México.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">delegaciones &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Alvaro Obregon&quot;</span>, <span class="st">&quot;Azcapotzalco&quot;</span> ,<span class="st">&quot;Benito Juarez&quot;</span> ,
                   <span class="st">&quot;Coyoacan&quot;</span> ,<span class="st">&quot;Cuajimalpa de Morelos&quot;</span> ,<span class="st">&quot;Cuauhtemoc&quot;</span> ,
                   <span class="st">&quot;Gustavo Madero&quot;</span> ,
                   <span class="st">&quot;Iztacalco&quot;</span> ,<span class="st">&quot;Iztapalapa&quot;</span> ,
                   <span class="st">&quot;Magdalena Contreras&quot;</span> ,<span class="st">&quot;Miguel Hidalgo&quot;</span> ,<span class="st">&quot;Milpa Alta&quot;</span> ,
                   <span class="st">&quot;Tlahuac&quot;</span> ,<span class="st">&quot;Tlalpan&quot;</span> ,
                   <span class="st">&quot;Venustiano Carranza&quot;</span> ,<span class="st">&quot;Xochimilco&quot;</span>)</code></pre></div>
<p>Aplica la función <code>sapply()</code> para obtener un arreglo con la letra máxima y mínima de cada nombre.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(, )</code></pre></div>
<p><br></p>
<hr />
<ol start="3" style="list-style-type: decimal">
<li>El siguiente vector incluye el precio de la gasolina en diferentes estados del país en julio de 2017.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gas_cdmx &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">15.82</span>, <span class="fl">15.77</span>, <span class="fl">15.83</span>, <span class="fl">15.23</span>, <span class="fl">14.95</span>, <span class="fl">15.42</span>, <span class="fl">15.55</span>)
gas_cdmx
<span class="co">#&gt; [1] 15.8 15.8 15.8 15.2 14.9 15.4 15.6</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Crea una función que convierta el precio a dolares suponiendo que un dolar equivale a 17.76 pesos.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">conv_fun &lt;-<span class="st"> </span><span class="cf">function</span>(precio){
  <span class="op">/</span><span class="fl">17.76</span>
  <span class="kw">return</span>()
}</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Usando la función <code>lapply()</code> convierte el precio de la gasolina a dolares.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gas_cdmx_usd_lista &lt;-<span class="st"> </span><span class="kw">lapply</span>(, conv_fun)</code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Usa la función <code>unlist()</code> para convertir la lista a un vector.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gas_cdmx_usd &lt;-<span class="st"> </span><span class="kw">unlist</span>()
<span class="kw">print</span>(gas_cdmx_usd)</code></pre></div>
<p><br></p>
<hr />
<ol start="4" style="list-style-type: decimal">
<li>Estadísticos importantes</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">estadisticos &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;GAUSS:1777&quot;</span>, <span class="st">&quot;BAYES:1702&quot;</span>, <span class="st">&quot;FISHER:1890&quot;</span>, <span class="st">&quot;PEARSON:1857&quot;</span>)
split_estadisticos &lt;-<span class="st"> </span><span class="kw">strsplit</span>(estadisticos, <span class="dt">split =</span> <span class="st">&quot;:&quot;</span>)
split_estadisticos
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] &quot;GAUSS&quot; &quot;1777&quot; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] &quot;BAYES&quot; &quot;1702&quot; </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] &quot;FISHER&quot; &quot;1890&quot;  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1] &quot;PEARSON&quot; &quot;1857&quot;</span></code></pre></div>
<p>Utiliza la función predefinida <code>tolower()</code> y <code>lapply()</code> para convertir a minúsculas cada letra de la lista <code>split_estadisticos</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">split_lower &lt;-<span class="st"> </span><span class="kw">lapply</span>( , )
<span class="kw">print</span>(split_lower)</code></pre></div>
<p><br></p>
<hr />
<ol start="5" style="list-style-type: decimal">
<li>Usando el vector <code>split_estadísticos</code> del ejercicio anterior.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(split_estadisticos)
<span class="co">#&gt; List of 4</span>
<span class="co">#&gt;  $ : chr [1:2] &quot;GAUSS&quot; &quot;1777&quot;</span>
<span class="co">#&gt;  $ : chr [1:2] &quot;BAYES&quot; &quot;1702&quot;</span>
<span class="co">#&gt;  $ : chr [1:2] &quot;FISHER&quot; &quot;1890&quot;</span>
<span class="co">#&gt;  $ : chr [1:2] &quot;PEARSON&quot; &quot;1857&quot;</span></code></pre></div>
<ol style="list-style-type: decimal">
<li>Crea una función que regrese la primera posición.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">primera_pos_fun &lt;-<span class="st"> </span><span class="cf">function</span>(lista){
  
}</code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Crea una función que regrese la segunda posición.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segunda_pos_fun &lt;-<span class="st"> </span><span class="cf">function</span>(lista){
  
}</code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Usando <code>lapply()</code> crea una lista con los nombres de los estadísticos y otra con la fecha de nacimiento.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nombres &lt;-<span class="st"> </span><span class="kw">lapply</span>()
fechas &lt;-<span class="st"> </span><span class="kw">lapply</span>()</code></pre></div>
<p><br></p>
<hr />
<ol start="6" style="list-style-type: decimal">
<li>Usando una función anónima y el vector <code>split_estadísticos</code> en un solo <code>lapply()</code> o <code>sapply()</code> obtén un vector compuesto de la primera posición, es decir el nombre, en minúsculas.</li>
</ol>
<p>Tip: si usas <code>lapply()</code> recuerda usar la función <code>unlist()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nombre_estadisticos &lt;-<span class="st"> </span>(split_estadisticos, <span class="cf">function</span>(elemento){
  <span class="kw">tolower</span>()
})
nombre_estadisticos</code></pre></div>
<p><br></p>
<hr />
<ol start="7" style="list-style-type: decimal">
<li>En la siguiente lista se presenta el registro de temperatura de tres ciudades a las 07:00 am, 10:00 am, 01:00 pm, 04:00 pm y 07:00 pm.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">temp_lista &lt;-<span class="st"> </span><span class="kw">list</span>(
  <span class="dt">cdmx =</span> <span class="kw">c</span>(<span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">19</span>, <span class="dv">22</span>, <span class="dv">20</span>),
  <span class="dt">guadalajara =</span> <span class="kw">c</span>(<span class="dv">18</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">26</span>, <span class="dv">27</span>),
  <span class="dt">tuxtla_gtz =</span> <span class="kw">c</span>(<span class="dv">22</span>, <span class="dv">24</span>, <span class="dv">29</span>, <span class="dv">32</span>, <span class="dv">28</span>)
)
<span class="kw">str</span>(temp_lista)
<span class="co">#&gt; List of 3</span>
<span class="co">#&gt;  $ cdmx       : num [1:5] 13 15 19 22 20</span>
<span class="co">#&gt;  $ guadalajara: num [1:5] 18 18 22 26 27</span>
<span class="co">#&gt;  $ tuxtla_gtz : num [1:5] 22 24 29 32 28</span></code></pre></div>
<p>Completa la siguiente función que obtiene el promedio entre el valor mínimo y máximo registrados.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">promedio_extremos_fun &lt;-<span class="st">  </span><span class="cf">function</span>(x) {
  ( <span class="kw">min</span>() <span class="op">+</span><span class="st"> </span><span class="kw">max</span>() ) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>
}</code></pre></div>
<p>Aplica la función a la lista y obtén la temperatura promedio de extremos para cada ciudad usando <code>lapply()</code> y <code>sapply()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(,)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(,)</code></pre></div>
<p><br></p>
<hr />
<ol start="8" style="list-style-type: decimal">
<li>Crea una función en la que <em>mientras</em> la velocidad sea mayor a 50 km/hr se reduzca de la siguiente forma:</li>
</ol>
<ul>
<li><p>Si es mayor a 80 km/hr se reducen 20 km/hr e imprime <strong>¡Demasido rápido!</strong>.</p></li>
<li><p>Si es menor o igual a 80km/hr se reducen únicamente 5 km/hr.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">velocidad_act &lt;-<span class="st"> </span><span class="dv">140</span>
<span class="cf">while</span>(velocidad_act <span class="op">&gt;</span><span class="st"> </span>){
  
  <span class="cf">if</span>(velocidad_act <span class="op">&gt;</span><span class="st"> </span>){
    <span class="kw">print</span>()
    velocidad_act &lt;-<span class="st"> </span>
<span class="st">  </span>}
  <span class="cf">if</span>(velocidad_act <span class="op">&lt;</span><span class="st"> </span>){
    velocidad_act &lt;-<span class="st"> </span>
<span class="st">  </span>}
  
  velocidad_act
}</code></pre></div>

</div>
</div>
<h3>Referencias</h3>
<div id="refs" class="references">
<div id="ref-wickham2016r">
<p>Wickham, Hadley, and Garrett Grolemund. 2016. “R for Data Science.” Sebastopol, CA: O’Reilly. ‘http://r4ds.had.co.nz‘.</p>
</div>
<div id="ref-fisher1936use">
<p>Fisher, Ronald A. 1936. “The Use of Multiple Measurements in Taxonomic Problems.” <em>Annals of Human Genetics</em> 7 (2). Wiley Online Library: 179–88.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="manipulacion-y-visualizacion-de-datos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
