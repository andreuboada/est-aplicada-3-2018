<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Estadística Aplicada III</title>
  <meta name="description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)">
  <meta name="generator" content="bookdown 0.7.8 and GitBook 2.6.7">

  <meta property="og:title" content="Estadística Aplicada III" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)" />
  <meta name="github-repo" content="andreuboada/est-aplicada-3-2018" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Estadística Aplicada III" />
  
  <meta name="twitter:description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)" />
  

<meta name="author" content="Andreu Boada de Atela">


<meta name="date" content="2018-05-02">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="correlaciones-canonicas-cca.html">
<link rel="next" href="analisis-de-conglomerados-clustering-2.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Aplicada III</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Temario y referencias</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluacion"><i class="fa fa-check"></i>Evaluación</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-r-y-rstudio"><i class="fa fa-check"></i>Software: R y Rstudio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#referencias-principales"><i class="fa fa-check"></i>Referencias principales</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#otras-referencias"><i class="fa fa-check"></i>Otras referencias</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#tareas"><i class="fa fa-check"></i>Tareas</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#por-que-un-analisis-multivariado"><i class="fa fa-check"></i><b>1.1</b> ¿Por qué un análisis multivariado?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#la-paradoja-de-simpson"><i class="fa fa-check"></i><b>1.2</b> La paradoja de Simpson</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#modelos-log-lineales"><i class="fa fa-check"></i><b>1.3</b> Modelos log-lineales</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#interpretacion-de-parametros"><i class="fa fa-check"></i><b>1.4</b> Interpretación de parámetros</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#ejemplo-dos-monedas"><i class="fa fa-check"></i><b>1.4.1</b> Ejemplo: dos monedas</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#otros-ejemplos"><i class="fa fa-check"></i><b>1.5</b> Otros ejemplos</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#discriminacion-de-residentes-hispanos-con-discapacidades"><i class="fa fa-check"></i><b>1.5.1</b> Discriminación de residentes hispanos con discapacidades</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#consumo-de-chocolate-y-premios-nobel"><i class="fa fa-check"></i><b>1.5.2</b> Consumo de chocolate y premios Nobel</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#tarea"><i class="fa fa-check"></i><b>1.6</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i><b>2</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="2.1" data-path="Rintro.html"><a href="Rintro.html#que-ventajas-tiene-r"><i class="fa fa-check"></i><b>2.1</b> ¿Qué ventajas tiene R?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="Rintro.html"><a href="Rintro.html#r-es-gratuito-y-de-codigo-abierto"><i class="fa fa-check"></i><b>2.1.1</b> R es gratuito y de código abierto</a></li>
<li class="chapter" data-level="2.1.2" data-path="Rintro.html"><a href="Rintro.html#r-tiene-una-comunidad-comprometida"><i class="fa fa-check"></i><b>2.1.2</b> R tiene una comunidad comprometida</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="Rintro.html"><a href="Rintro.html#flujo-basico-de-trabajo-para-el-analisis-de-datos-en-r."><i class="fa fa-check"></i><b>2.2</b> Flujo básico de trabajo para el análisis de datos en R.</a></li>
<li class="chapter" data-level="2.3" data-path="Rintro.html"><a href="Rintro.html#introduccion-a-r-como-lenguaje-de-programacion-y-la-plataforma-interactiva-de-rstudio."><i class="fa fa-check"></i><b>2.3</b> Introducción a R como lenguaje de programación, y la plataforma interactiva de RStudio.</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Rintro.html"><a href="Rintro.html#como-entender-r"><i class="fa fa-check"></i><b>2.3.1</b> ¿Cómo entender R?</a></li>
<li class="chapter" data-level="2.3.2" data-path="Rintro.html"><a href="Rintro.html#por-que-r"><i class="fa fa-check"></i><b>2.3.2</b> ¿Por qué R?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Rintro.html"><a href="Rintro.html#estructuras-de-datos"><i class="fa fa-check"></i><b>2.4</b> Estructuras de datos</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Rintro.html"><a href="Rintro.html#vectores"><i class="fa fa-check"></i><b>2.4.1</b> Vectores</a></li>
<li class="chapter" data-level="2.4.2" data-path="Rintro.html"><a href="Rintro.html#data-frames"><i class="fa fa-check"></i><b>2.4.2</b> Data Frames</a></li>
<li class="chapter" data-level="2.4.3" data-path="Rintro.html"><a href="Rintro.html#listas"><i class="fa fa-check"></i><b>2.4.3</b> Listas</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Rintro.html"><a href="Rintro.html#r-markdown"><i class="fa fa-check"></i><b>2.5</b> R Markdown</a><ul>
<li class="chapter" data-level="2.5.1" data-path="Rintro.html"><a href="Rintro.html#que-es-r-markdown"><i class="fa fa-check"></i><b>2.5.1</b> ¿Qué es R Markdown?</a></li>
<li class="chapter" data-level="2.5.2" data-path="Rintro.html"><a href="Rintro.html#estructura-basica-de-r-markdown"><i class="fa fa-check"></i><b>2.5.2</b> Estructura básica de R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="Rintro.html"><a href="Rintro.html#proyectos-de-rstudio"><i class="fa fa-check"></i><b>2.6</b> Proyectos de RStudio</a></li>
<li class="chapter" data-level="2.7" data-path="Rintro.html"><a href="Rintro.html#otros-aspectos-importantes-de-r"><i class="fa fa-check"></i><b>2.7</b> Otros aspectos importantes de R</a><ul>
<li class="chapter" data-level="2.7.1" data-path="Rintro.html"><a href="Rintro.html#valores-faltantes"><i class="fa fa-check"></i><b>2.7.1</b> Valores faltantes</a></li>
<li class="chapter" data-level="2.7.2" data-path="Rintro.html"><a href="Rintro.html#funciones"><i class="fa fa-check"></i><b>2.7.2</b> Funciones</a></li>
<li class="chapter" data-level="2.7.3" data-path="Rintro.html"><a href="Rintro.html#funcionales"><i class="fa fa-check"></i><b>2.7.3</b> Funcionales</a></li>
<li class="chapter" data-level="2.7.4" data-path="Rintro.html"><a href="Rintro.html#rendimiento-en-r"><i class="fa fa-check"></i><b>2.7.4</b> Rendimiento en R</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="Rintro.html"><a href="Rintro.html#tarea-1"><i class="fa fa-check"></i><b>2.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y visualización de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#el-principio-de-datos-limpios"><i class="fa fa-check"></i><b>3.1</b> El principio de datos limpios</a></li>
<li class="chapter" data-level="3.2" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#limpieza-de-datos"><i class="fa fa-check"></i><b>3.2</b> Limpieza de datos</a></li>
<li class="chapter" data-level="3.3" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#separa-aplica-combina"><i class="fa fa-check"></i><b>3.3</b> <em>Separa-aplica-combina</em></a></li>
<li class="chapter" data-level="3.4" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#muertes-por-armas-de-fuego-en-eua"><i class="fa fa-check"></i><b>3.4</b> Muertes por armas de fuego en EUA</a></li>
<li class="chapter" data-level="3.5" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#el-cuarteto-de-anscombe"><i class="fa fa-check"></i><b>3.5</b> El Cuarteto de Anscombe</a></li>
<li class="chapter" data-level="3.6" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#the-grammar-of-graphics-de-leland-wilkinson"><i class="fa fa-check"></i><b>3.6</b> The <em>Grammar of Graphics</em> de Leland Wilkinson</a></li>
<li class="chapter" data-level="3.7" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#ggplot"><i class="fa fa-check"></i><b>3.7</b> ggplot</a></li>
<li class="chapter" data-level="3.8" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#un-histograma-de-las-muertes-en-iraq"><i class="fa fa-check"></i><b>3.8</b> Un histograma de las muertes en Iraq</a></li>
<li class="chapter" data-level="3.9" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#inglehartwelzel-un-mapa-cultural-del-mundo"><i class="fa fa-check"></i><b>3.9</b> Inglehart–Welzel: un mapa cultural del mundo</a><ul>
<li class="chapter" data-level="3.9.1" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#creando-un-ggplot"><i class="fa fa-check"></i><b>3.9.1</b> Creando un ggplot</a></li>
<li class="chapter" data-level="3.9.2" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#mapeos-aesthetics"><i class="fa fa-check"></i><b>3.9.2</b> Mapeos: Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#poniendo-todo-junto"><i class="fa fa-check"></i><b>3.10</b> Poniendo todo junto</a></li>
<li class="chapter" data-level="3.11" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#tarea-2"><i class="fa fa-check"></i><b>3.11</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html"><i class="fa fa-check"></i><b>4</b> Teorema del Límite Central</a><ul>
<li class="chapter" data-level="4.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#la-distribucion-de-la-media"><i class="fa fa-check"></i><b>4.1</b> La distribución de la media</a></li>
<li class="chapter" data-level="4.2" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#de-donde-proviene-la-distribucion-normal"><i class="fa fa-check"></i><b>4.2</b> ¿De dónde proviene la distribución normal?</a><ul>
<li class="chapter" data-level="4.2.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#que-signo-tiene-c"><i class="fa fa-check"></i><b>4.2.1</b> ¿Qué signo tiene c?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#otras-observaciones"><i class="fa fa-check"></i><b>4.3</b> Otras observaciones</a></li>
<li class="chapter" data-level="4.4" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#diagramas-de-caja-y-brazos"><i class="fa fa-check"></i><b>4.4</b> Diagramas de caja y brazos</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-de-cuantiles-teoricos"><i class="fa fa-check"></i><b>4.5</b> Gráficas de cuantiles teóricos</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-normal"><i class="fa fa-check"></i>Ejemplo: normal</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-de-cuantiles-para-un-conjunto-de-datos"><i class="fa fa-check"></i><b>4.6</b> Gráficas de cuantiles para un conjunto de datos</a><ul>
<li class="chapter" data-level="4.6.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#que-buscar-en-una-grafica-de-cuantiles"><i class="fa fa-check"></i><b>4.6.1</b> ¿Qué buscar en una gráfica de cuantiles?</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-qq-normales"><i class="fa fa-check"></i><b>4.7</b> Gráficas qq-normales</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-cantantes"><i class="fa fa-check"></i>Ejemplo: cantantes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#el-tlc-y-errores-estandar"><i class="fa fa-check"></i><b>4.8</b> El TLC y errores estándar</a></li>
<li class="chapter" data-level="4.9" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-1"><i class="fa fa-check"></i><b>4.9</b> Ejemplo</a></li>
<li class="chapter" data-level="4.10" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#tarea-3"><i class="fa fa-check"></i><b>4.10</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html"><i class="fa fa-check"></i><b>5</b> Análisis de datos categóricos</a><ul>
<li class="chapter" data-level="5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#repaso-y-algunos-conceptos"><i class="fa fa-check"></i><b>5.1</b> Repaso y algunos conceptos</a><ul>
<li class="chapter" data-level="5.1.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#caso-binomial"><i class="fa fa-check"></i><b>5.1.1</b> Caso binomial</a></li>
<li class="chapter" data-level="" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#estimacion-de-parametros-multinomiales"><i class="fa fa-check"></i>Estimación de parámetros multinomiales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-chi2-de-pearson-de-una-multinomial"><i class="fa fa-check"></i><b>5.2</b> La <span class="math inline">\(\chi^2\)</span> de Pearson de una multinomial</a><ul>
<li class="chapter" data-level="5.2.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#cociente-de-verosimilitud-de-una-multinomial"><i class="fa fa-check"></i><b>5.2.1</b> Cociente de verosimilitud de una multinomial</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#definiciones"><i class="fa fa-check"></i><b>5.3</b> Definiciones</a><ul>
<li class="chapter" data-level="5.3.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#notacion"><i class="fa fa-check"></i><b>5.3.1</b> Notación</a></li>
<li class="chapter" data-level="5.3.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#razon-de-momios"><i class="fa fa-check"></i><b>5.3.2</b> Razón de momios</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#asociacion-en-tablas-de-tamano-itimes-j"><i class="fa fa-check"></i><b>5.4</b> Asociación en tablas de tamaño <span class="math inline">\(I\times J\)</span></a><ul>
<li class="chapter" data-level="5.4.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#razones-de-momios-en-tablas-itimes-j"><i class="fa fa-check"></i><b>5.4.1</b> Razones de momios en tablas <span class="math inline">\(I\times J\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-mushrooms"><i class="fa fa-check"></i><b>5.4.2</b> Ejemplo: mushrooms</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#intervalos-de-confianza-para-los-parametros-de-asociacion"><i class="fa fa-check"></i><b>5.5</b> Intervalos de confianza para los parámetros de asociación</a><ul>
<li class="chapter" data-level="5.5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#error-estandar-de-la-razon-de-momios"><i class="fa fa-check"></i><b>5.5.1</b> Error estándar de la razón de momios</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-de-independencia"><i class="fa fa-check"></i><b>5.6</b> Prueba de independencia</a><ul>
<li class="chapter" data-level="5.6.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-prueba-chi2-de-pearson"><i class="fa fa-check"></i><b>5.6.1</b> La prueba <span class="math inline">\(\chi^2\)</span> de Pearson</a></li>
<li class="chapter" data-level="5.6.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-brecha-de-genero"><i class="fa fa-check"></i><b>5.6.2</b> Ejemplo: brecha de género</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#general-social-survey-1972---2016"><i class="fa fa-check"></i><b>5.7</b> General Social Survey 1972 - 2016</a></li>
<li class="chapter" data-level="5.8" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-catadora-de-te"><i class="fa fa-check"></i><b>5.8</b> La catadora de té</a></li>
<li class="chapter" data-level="5.9" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-multinomiales-para-conteos"><i class="fa fa-check"></i><b>5.9</b> Modelos multinomiales para conteos</a></li>
<li class="chapter" data-level="5.10" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-log-lineales-con-tres-variables-categoricas"><i class="fa fa-check"></i><b>5.10</b> Modelos log lineales con tres variables categóricas</a><ul>
<li class="chapter" data-level="5.10.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tipos-de-independencia"><i class="fa fa-check"></i><b>5.10.1</b> Tipos de independencia</a></li>
<li class="chapter" data-level="5.10.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#asociacion-homogenea-e-interacciones-de-3-factores"><i class="fa fa-check"></i><b>5.10.2</b> Asociación homogénea e interacciones de 3 factores</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-sensitividad-y-especificidad"><i class="fa fa-check"></i><b>5.11</b> Ejemplo: sensitividad y especificidad</a></li>
<li class="chapter" data-level="5.12" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-horoscopos"><i class="fa fa-check"></i><b>5.12</b> Ejemplo: horóscopos</a></li>
<li class="chapter" data-level="5.13" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tarea-opcional"><i class="fa fa-check"></i><b>5.13</b> Tarea (opcional)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html"><i class="fa fa-check"></i><b>6</b> Regresión logística 1</a><ul>
<li class="chapter" data-level="6.1" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#regresion-logistica-con-un-solo-predictor"><i class="fa fa-check"></i><b>6.1</b> Regresión logística con un solo predictor</a></li>
<li class="chapter" data-level="6.2" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#el-modelo-de-regresion-logistica"><i class="fa fa-check"></i><b>6.2</b> El modelo de regresión logística</a><ul>
<li class="chapter" data-level="6.2.1" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#funcion-logistica"><i class="fa fa-check"></i><b>6.2.1</b> Función logística</a></li>
<li class="chapter" data-level="" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#tarea-4"><i class="fa fa-check"></i><b>6.3</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html"><i class="fa fa-check"></i><b>7</b> Regresión logística 2</a><ul>
<li class="chapter" data-level="7.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#incertidumbre-en-la-estimacion"><i class="fa fa-check"></i><b>7.1</b> Incertidumbre en la estimación</a></li>
<li class="chapter" data-level="7.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#funcion-logistica-1"><i class="fa fa-check"></i><b>7.2</b> Función logística</a></li>
<li class="chapter" data-level="7.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes"><i class="fa fa-check"></i><b>7.3</b> Interpretación de los coeficientes</a><ul>
<li class="chapter" data-level="7.3.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#evaluar-en-o-alrededor-de-la-media"><i class="fa fa-check"></i><b>7.3.1</b> Evaluar en (o alrededor de) la media</a></li>
<li class="chapter" data-level="7.3.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#la-regla-de-dividir-entre-4"><i class="fa fa-check"></i><b>7.3.2</b> La regla de “dividir entre 4”</a></li>
<li class="chapter" data-level="7.3.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes-como-cocientes-de-momios"><i class="fa fa-check"></i><b>7.3.3</b> Interpretación de los coeficientes como cocientes de momios</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ejemplo-pozos-en-bangladesh"><i class="fa fa-check"></i><b>7.4</b> Ejemplo: pozos en Bangladesh</a><ul>
<li class="chapter" data-level="7.4.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#descripcion-del-problema"><i class="fa fa-check"></i><b>7.4.1</b> Descripción del problema</a></li>
<li class="chapter" data-level="7.4.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#antecedentes-del-problema"><i class="fa fa-check"></i><b>7.4.2</b> Antecedentes del problema</a></li>
<li class="chapter" data-level="7.4.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#metodologia-para-abordar-el-problema"><i class="fa fa-check"></i><b>7.4.3</b> Metodología para abordar el problema</a></li>
<li class="chapter" data-level="7.4.4" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ajuste-y-resultados-del-modelo"><i class="fa fa-check"></i><b>7.4.4</b> Ajuste y resultados del modelo</a></li>
<li class="chapter" data-level="7.4.5" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes-1"><i class="fa fa-check"></i><b>7.4.5</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="7.4.6" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#agregamos-una-segunda-variable-de-entrada"><i class="fa fa-check"></i><b>7.4.6</b> Agregamos una segunda variable de entrada</a></li>
<li class="chapter" data-level="7.4.7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#comparacion-de-coeficientes-cuando-anades-un-predictor"><i class="fa fa-check"></i><b>7.4.7</b> Comparación de coeficientes cuando añades un predictor</a></li>
<li class="chapter" data-level="7.4.8" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#graficar-el-modelo-ajustado-con-dos-predictores"><i class="fa fa-check"></i><b>7.4.8</b> Graficar el modelo ajustado con dos predictores</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ajuste-de-coeficientes-para-regresion-logistica-binomial."><i class="fa fa-check"></i><b>7.5</b> Ajuste de coeficientes para regresión logística (binomial).</a></li>
<li class="chapter" data-level="7.6" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#descenso-en-gradiente"><i class="fa fa-check"></i><b>7.6</b> Descenso en gradiente</a><ul>
<li class="chapter" data-level="7.6.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#seleccion-de-tamano-de-paso-eta"><i class="fa fa-check"></i><b>7.6.1</b> Selección de tamaño de paso <span class="math inline">\(\eta\)</span></a></li>
<li class="chapter" data-level="7.6.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#funciones-de-varias-variables"><i class="fa fa-check"></i><b>7.6.2</b> Funciones de varias variables</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ejemplo-diabetes"><i class="fa fa-check"></i><b>7.7</b> Ejemplo: diabetes</a></li>
<li class="chapter" data-level="7.8" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#observaciones-adicionales"><i class="fa fa-check"></i><b>7.8</b> Observaciones adicionales</a></li>
<li class="chapter" data-level="7.9" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#regresion-logistica-para-problemas-de-mas-de-2-clases"><i class="fa fa-check"></i><b>7.9</b> Regresión logística para problemas de más de 2 clases</a></li>
<li class="chapter" data-level="7.10" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#regresion-logistica-multinomial"><i class="fa fa-check"></i><b>7.10</b> Regresión logística multinomial</a></li>
<li class="chapter" data-level="7.11" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#identificabilidad-y-separacion"><i class="fa fa-check"></i><b>7.11</b> Identificabilidad y separación</a></li>
<li class="chapter" data-level="7.12" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#tarea-5"><i class="fa fa-check"></i><b>7.12</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html"><i class="fa fa-check"></i><b>8</b> Regresión logística 3</a><ul>
<li class="chapter" data-level="8.1" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#ejemplo-oscares"><i class="fa fa-check"></i><b>8.1</b> Ejemplo óscares</a></li>
<li class="chapter" data-level="8.2" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#repaso-de-regresion-logistica"><i class="fa fa-check"></i><b>8.2</b> Repaso de regresión logística</a></li>
<li class="chapter" data-level="8.3" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#regresion-logistica-con-interacciones"><i class="fa fa-check"></i><b>8.3</b> Regresión logística con interacciones</a></li>
<li class="chapter" data-level="8.4" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#graficas-del-modelo-con-interacciones"><i class="fa fa-check"></i><b>8.4</b> Gráficas del modelo con interacciones</a></li>
<li class="chapter" data-level="8.5" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#agregar-mas-predictores"><i class="fa fa-check"></i><b>8.5</b> Agregar más predictores</a></li>
<li class="chapter" data-level="8.6" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#evaluacion-de-modelos-de-regresion-logistica"><i class="fa fa-check"></i><b>8.6</b> Evaluación de modelos de regresión logística</a><ul>
<li class="chapter" data-level="8.6.1" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#graficas-de-residuales-agrupados-vs-predictores"><i class="fa fa-check"></i><b>8.6.1</b> Gráficas de residuales agrupados vs predictores</a></li>
<li class="chapter" data-level="8.6.2" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#transformaciones"><i class="fa fa-check"></i><b>8.6.2</b> Transformaciones</a></li>
<li class="chapter" data-level="8.6.3" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#tasa-de-error-y-comparacion-contra-el-modelo-nulo"><i class="fa fa-check"></i><b>8.6.3</b> Tasa de error y comparación contra el modelo nulo</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#diferencias-predictivas-promedio-en-la-escala-de-probabilidad"><i class="fa fa-check"></i><b>8.7</b> Diferencias predictivas promedio en la escala de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#diferencias-predictivas-promedio-en-presencia-de-interacciones"><i class="fa fa-check"></i>Diferencias predictivas promedio en presencia de interacciones</a></li>
<li class="chapter" data-level="" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#notacion-general-para-diferencias-predictivas"><i class="fa fa-check"></i>Notación general para diferencias predictivas</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#tarea-6"><i class="fa fa-check"></i><b>8.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regularizacion.html"><a href="regularizacion.html"><i class="fa fa-check"></i><b>9</b> Regularización</a><ul>
<li class="chapter" data-level="9.1" data-path="regularizacion.html"><a href="regularizacion.html#repaso"><i class="fa fa-check"></i><b>9.1</b> Repaso</a></li>
<li class="chapter" data-level="9.2" data-path="regularizacion.html"><a href="regularizacion.html#otras-medidas-de-clasificacion"><i class="fa fa-check"></i><b>9.2</b> Otras medidas de clasificación</a></li>
<li class="chapter" data-level="9.3" data-path="regularizacion.html"><a href="regularizacion.html#analisis-de-error-en-clasificacion-binaria"><i class="fa fa-check"></i><b>9.3</b> Análisis de error en clasificación binaria</a><ul>
<li class="chapter" data-level="9.3.1" data-path="regularizacion.html"><a href="regularizacion.html#punto-de-corte-para-un-clasificador-binario"><i class="fa fa-check"></i><b>9.3.1</b> Punto de corte para un clasificador binario</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regularizacion.html"><a href="regularizacion.html#curvas-roc"><i class="fa fa-check"></i><b>9.4</b> Curvas ROC</a><ul>
<li class="chapter" data-level="9.4.1" data-path="regularizacion.html"><a href="regularizacion.html#espacio-roc"><i class="fa fa-check"></i><b>9.4.1</b> Espacio ROC</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-1"><i class="fa fa-check"></i><b>9.5</b> Regularización</a><ul>
<li class="chapter" data-level="9.5.1" data-path="regularizacion.html"><a href="regularizacion.html#reduciendo-varianza-de-los-coeficientes"><i class="fa fa-check"></i><b>9.5.1</b> Reduciendo varianza de los coeficientes</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-ridge"><i class="fa fa-check"></i><b>9.6</b> Regularización Ridge</a><ul>
<li class="chapter" data-level="9.6.1" data-path="regularizacion.html"><a href="regularizacion.html#seleccion-de-coeficiente-de-regularizacion"><i class="fa fa-check"></i><b>9.6.1</b> Selección de coeficiente de regularización</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-lasso"><i class="fa fa-check"></i><b>9.7</b> Regularización Lasso</a></li>
<li class="chapter" data-level="9.8" data-path="regularizacion.html"><a href="regularizacion.html#tarea-7"><i class="fa fa-check"></i><b>9.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>10</b> Modelos lineales generalizados</a><ul>
<li class="chapter" data-level="10.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#regresion-lineal-y-logistica"><i class="fa fa-check"></i><b>10.1</b> Regresión lineal y logística</a></li>
<li class="chapter" data-level="10.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#otros-modelos"><i class="fa fa-check"></i><b>10.2</b> Otros modelos</a></li>
<li class="chapter" data-level="10.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-accidentes-de-trafico"><i class="fa fa-check"></i><b>10.3</b> Ejemplo: accidentes de tráfico</a></li>
<li class="chapter" data-level="10.4" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#interpretacion-de-coeficientes-poisson"><i class="fa fa-check"></i><b>10.4</b> Interpretación de coeficientes Poisson</a></li>
<li class="chapter" data-level="10.5" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#diferencias-entre-el-modelo-binomial-y-poisson"><i class="fa fa-check"></i><b>10.5</b> Diferencias entre el modelo binomial y Poisson</a></li>
<li class="chapter" data-level="10.6" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-fertilidad-en-fiji"><i class="fa fa-check"></i><b>10.6</b> Ejemplo: fertilidad en Fiji</a></li>
<li class="chapter" data-level="10.7" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#variable-de-expuestos-offset"><i class="fa fa-check"></i><b>10.7</b> Variable de expuestos (offset)</a></li>
<li class="chapter" data-level="10.8" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplos-seguros"><i class="fa fa-check"></i><b>10.8</b> Ejemplos: seguros</a><ul>
<li class="chapter" data-level="" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#numero-de-expuestos-interpretacion"><i class="fa fa-check"></i>Número de expuestos (interpretación)</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-arboles"><i class="fa fa-check"></i><b>10.9</b> Ejemplo: árboles</a></li>
<li class="chapter" data-level="10.10" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#sobredispersion"><i class="fa fa-check"></i><b>10.10</b> Sobredispersión</a></li>
<li class="chapter" data-level="10.11" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-numero-de-publicaciones"><i class="fa fa-check"></i><b>10.11</b> Ejemplo: número de publicaciones</a></li>
<li class="chapter" data-level="10.12" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#tarea-8"><i class="fa fa-check"></i><b>10.12</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="analisis-de-discriminante-lineal-1.html"><a href="analisis-de-discriminante-lineal-1.html"><i class="fa fa-check"></i><b>11</b> Análisis de Discriminante Lineal 1</a><ul>
<li class="chapter" data-level="11.1" data-path="analisis-de-discriminante-lineal-1.html"><a href="analisis-de-discriminante-lineal-1.html#problemas-de-clasificacion"><i class="fa fa-check"></i><b>11.1</b> Problemas de clasificación</a></li>
<li class="chapter" data-level="11.2" data-path="analisis-de-discriminante-lineal-1.html"><a href="analisis-de-discriminante-lineal-1.html#funciones-de-discriminante"><i class="fa fa-check"></i><b>11.2</b> Funciones de discriminante</a></li>
<li class="chapter" data-level="11.3" data-path="analisis-de-discriminante-lineal-1.html"><a href="analisis-de-discriminante-lineal-1.html#regresion-lineal-en-una-matriz-indicadora"><i class="fa fa-check"></i><b>11.3</b> Regresión lineal en una matriz indicadora</a></li>
<li class="chapter" data-level="11.4" data-path="analisis-de-discriminante-lineal-1.html"><a href="analisis-de-discriminante-lineal-1.html#discriminante-lineal-de-fisher"><i class="fa fa-check"></i><b>11.4</b> Discriminante lineal de Fisher</a><ul>
<li class="chapter" data-level="11.4.1" data-path="analisis-de-discriminante-lineal-1.html"><a href="analisis-de-discriminante-lineal-1.html#ejemplo-separacion-entre-clases"><i class="fa fa-check"></i><b>11.4.1</b> Ejemplo: separación entre clases</a></li>
<li class="chapter" data-level="11.4.2" data-path="analisis-de-discriminante-lineal-1.html"><a href="analisis-de-discriminante-lineal-1.html#ejemplo-iris-de-fisher"><i class="fa fa-check"></i><b>11.4.2</b> Ejemplo: iris de Fisher</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="analisis-de-discriminante-lineal-1.html"><a href="analisis-de-discriminante-lineal-1.html#tarea-9"><i class="fa fa-check"></i><b>11.5</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="analisis-de-discriminante-lineal-2.html"><a href="analisis-de-discriminante-lineal-2.html"><i class="fa fa-check"></i><b>12</b> Análisis de Discriminante Lineal 2</a><ul>
<li class="chapter" data-level="12.1" data-path="analisis-de-discriminante-lineal-2.html"><a href="analisis-de-discriminante-lineal-2.html#aplicaciones"><i class="fa fa-check"></i><b>12.1</b> Aplicaciones</a></li>
<li class="chapter" data-level="12.2" data-path="analisis-de-discriminante-lineal-2.html"><a href="analisis-de-discriminante-lineal-2.html#ejemplo-vinos"><i class="fa fa-check"></i><b>12.2</b> Ejemplo: vinos</a></li>
<li class="chapter" data-level="12.3" data-path="analisis-de-discriminante-lineal-2.html"><a href="analisis-de-discriminante-lineal-2.html#ejemplo-admisiones-al-mba"><i class="fa fa-check"></i><b>12.3</b> Ejemplo: admisiones al MBA</a></li>
<li class="chapter" data-level="12.4" data-path="analisis-de-discriminante-lineal-2.html"><a href="analisis-de-discriminante-lineal-2.html#repaso-1"><i class="fa fa-check"></i><b>12.4</b> Repaso</a><ul>
<li><a href="analisis-de-discriminante-lineal-2.html#caso-k2">Caso <span class="math inline">\(k=2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="analisis-de-discriminante-lineal-2.html"><a href="analisis-de-discriminante-lineal-2.html#supuestos-probabilisticos"><i class="fa fa-check"></i><b>12.5</b> Supuestos probabilísticos</a></li>
<li class="chapter" data-level="12.6" data-path="analisis-de-discriminante-lineal-2.html"><a href="analisis-de-discriminante-lineal-2.html#relacion-con-minimos-cuadrados"><i class="fa fa-check"></i><b>12.6</b> Relación con mínimos cuadrados</a></li>
<li class="chapter" data-level="12.7" data-path="analisis-de-discriminante-lineal-2.html"><a href="analisis-de-discriminante-lineal-2.html#tarea-10"><i class="fa fa-check"></i><b>12.7</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html"><i class="fa fa-check"></i><b>13</b> Componentes Principales 1</a><ul>
<li class="chapter" data-level="13.1" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#motivacion"><i class="fa fa-check"></i><b>13.1</b> Motivación</a></li>
<li class="chapter" data-level="13.2" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#formulacion-de-maxima-varianza"><i class="fa fa-check"></i><b>13.2</b> Formulación de máxima varianza</a></li>
<li class="chapter" data-level="13.3" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#formulacion-de-error-minimo"><i class="fa fa-check"></i><b>13.3</b> Formulación de error mínimo</a></li>
<li class="chapter" data-level="13.4" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#aplicaciones-de-pca"><i class="fa fa-check"></i><b>13.4</b> Aplicaciones de PCA</a><ul>
<li class="chapter" data-level="13.4.1" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#compresion-de-datos"><i class="fa fa-check"></i><b>13.4.1</b> Compresión de datos</a></li>
<li class="chapter" data-level="13.4.2" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#ejemplo-compresion-de-una-imagen"><i class="fa fa-check"></i><b>13.4.2</b> Ejemplo: compresión de una imagen</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#tarea-11"><i class="fa fa-check"></i><b>13.5</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html"><i class="fa fa-check"></i><b>14</b> Componentes Principales 2</a><ul>
<li class="chapter" data-level="14.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#pca-probabilistico-y-analisis-de-factores"><i class="fa fa-check"></i><b>14.1</b> PCA probabilístico y Análisis de Factores</a><ul>
<li class="chapter" data-level="14.1.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores"><i class="fa fa-check"></i><b>14.1.1</b> Análisis de factores</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores-descripcion-tradicional"><i class="fa fa-check"></i><b>14.2</b> Análisis de factores (descripción tradicional)</a><ul>
<li class="chapter" data-level="14.2.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#el-modelo"><i class="fa fa-check"></i><b>14.2.1</b> El modelo</a></li>
<li class="chapter" data-level="14.2.2" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#estimacion-del-modelo"><i class="fa fa-check"></i><b>14.2.2</b> Estimación del modelo</a></li>
<li class="chapter" data-level="14.2.3" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores-de-maxima-verosimilitud"><i class="fa fa-check"></i><b>14.2.3</b> Análisis de factores de máxima verosimilitud</a></li>
<li class="chapter" data-level="14.2.4" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#evaluacion-del-modelo"><i class="fa fa-check"></i><b>14.2.4</b> Evaluación del modelo</a></li>
<li class="chapter" data-level="14.2.5" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#visualizacion"><i class="fa fa-check"></i><b>14.2.5</b> Visualización</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#tarea-12"><i class="fa fa-check"></i><b>14.3</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlaciones-canonicas-cca.html"><a href="correlaciones-canonicas-cca.html"><i class="fa fa-check"></i><b>15</b> Correlaciones Canónicas (CCA)</a></li>
<li class="chapter" data-level="16" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html"><i class="fa fa-check"></i><b>16</b> Análisis de conglomerados (clustering) 1</a><ul>
<li class="chapter" data-level="16.1" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#introduccion"><i class="fa fa-check"></i><b>16.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#enfoques-combinatorio-y-basado-en-modelos."><i class="fa fa-check"></i><b>16.2</b> Enfoques: combinatorio y basado en modelos.</a></li>
<li class="chapter" data-level="16.3" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#k-medias"><i class="fa fa-check"></i><b>16.3</b> K-medias</a><ul>
<li class="chapter" data-level="" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#algoritmo-de-k-medias"><i class="fa fa-check"></i>Algoritmo de k-medias</a></li>
<li class="chapter" data-level="" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
<li><a href="analisis-de-conglomerados-clustering-1.html#usando-la-funcion-kmeans">Usando la funcion <code>kmeans</code></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#seleccion-de-numero-de-clusters."><i class="fa fa-check"></i><b>16.4</b> Selección de número de clusters.</a><ul>
<li class="chapter" data-level="" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#variacion-dentro-de-clusters-para-distintas-soluciones"><i class="fa fa-check"></i>Variación dentro de clusters para distintas soluciones</a></li>
<li class="chapter" data-level="16.4.1" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#criterios-especificos"><i class="fa fa-check"></i><b>16.4.1</b> Criterios específicos</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#dificultades-en-segmentacionclustering."><i class="fa fa-check"></i><b>16.5</b> Dificultades en segmentación/clustering.</a><ul>
<li class="chapter" data-level="16.5.1" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#estructuras-no-compactas"><i class="fa fa-check"></i><b>16.5.1</b> Estructuras no compactas</a></li>
<li class="chapter" data-level="16.5.2" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#existencia-o-no-de-grupos-naturales"><i class="fa fa-check"></i><b>16.5.2</b> Existencia o no de grupos “naturales”</a></li>
<li class="chapter" data-level="" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#grupos-en-dimension-alta"><i class="fa fa-check"></i>Grupos en dimensión alta</a></li>
<li class="chapter" data-level="" data-path="analisis-de-conglomerados-clustering-1.html"><a href="analisis-de-conglomerados-clustering-1.html#dificultades-en-la-seleccion-de-metrica"><i class="fa fa-check"></i>Dificultades en la selección de métrica</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="analisis-de-conglomerados-clustering-2.html"><a href="analisis-de-conglomerados-clustering-2.html"><i class="fa fa-check"></i><b>17</b> Análisis de conglomerados (clustering) 2</a><ul>
<li class="chapter" data-level="17.1" data-path="analisis-de-conglomerados-clustering-2.html"><a href="analisis-de-conglomerados-clustering-2.html#clustering-jerarquico"><i class="fa fa-check"></i><b>17.1</b> Clustering jerárquico</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Aplicada III</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analisis-de-conglomerados-clustering-1" class="section level1">
<h1><span class="header-section-number">Clase 16</span> Análisis de conglomerados (clustering) 1</h1>
<style>
  .espacio {
    margin-bottom: 1cm;
  }
</style>
<style>
  .espacio3 {
    margin-bottom: 3cm;
  }
</style>
<p class="espacio">
</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)</code></pre></div>
<div id="introduccion" class="section level2">
<h2><span class="header-section-number">16.1</span> Introducción</h2>
<p>Mediante clustering (o análisis de conglomerados) buscamos encontrar agrupaciones de casos, de manera que casos dentro de un grupo (<em>cluster</em>, o conglomerado) estén cercanos entre ellos, mientras que puntos en distintos clusters están a distancia más grande - todo esto de acuerdo a alguna medida de distancia.</p>
<p>Entonces podemos:</p>
<ul>
<li><p>Descubrir estructuras interesantes de agrupamiento en los datos que nos ayuden a entenderlos.</p></li>
<li><p>Resumir grupos (que pueden ser grandes), por casos representativos y/o promedio. Así la tarea de entender los casos (que pueden ser miles, por ejemplo) se reduce a entender los grupos (que pueden ser decenas o cientos, por ejemplo).</p></li>
<li><p>Usar grupos como insumo para otras tareas (por ejemplo, distintos modelos predictivos según cluster, distintas estrategias de tratamiento según cluster, etc.)</p></li>
</ul>

<div class="nota">
<p>Generalmente el proceso de clustering involucra tres pasos:</p>
<ul>
<li><p>Selección de métrica de distancia entre puntos.</p></li>
<li><p>Aplicación de un algoritmo de clustering.</p></li>
<li>Selección de número de clusters.
</div>
</li>
</ul>
<p class="espacio">
</p>
<p>Para variables numéricas, una elección usual es la distancia euclideana (cuando las variables tienen las mismas unidades, o escala similar), o la <em>distancia euclideana</em> para las variables estandarizadas.</p>
<div id="ejemplo-7" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Consideramos las ocurrencias de temblores cerca de Fiji (The data set give the locations of 1000 seismic events of MB &gt; 4.0. The events occurred in a cube near Fiji since 1964.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">quakes_<span class="dv">1</span> &lt;-<span class="st"> </span>quakes[, <span class="kw">c</span>(<span class="st">&#39;lat&#39;</span>,<span class="st">&#39;long&#39;</span>)]
quakes_<span class="dv">1</span><span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(quakes_<span class="dv">1</span>)
<span class="kw">ggplot</span>(quakes_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-4-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>¿Podemos separar en grupos estos datos? Podemos pensar en varias maneras de hacer esto. Un enfoque simple que nos puede dar una agrupación interesante es pensar en agrupar de manera que obtengamos grupos relativamente <strong>compactos</strong> o concentrados alrededor de un valor (en estos datos, ¿qué otras cosas se te ocurren? ¿qué otros patrones interesantes sería interesante agrupar?).</p>
</div>
</div>
<div id="enfoques-combinatorio-y-basado-en-modelos." class="section level2">
<h2><span class="header-section-number">16.2</span> Enfoques: combinatorio y basado en modelos.</h2>
<p>Los enfoques basados en modelos (por ejemplo, modelos de mezclas) se basan en la introducción de variables latentes que explican diferencias en las distribuciones de las variables observadas.</p>
<p>Veremos métodos <em>combinatorios</em>, que trabajan directamente sobre los datos (sin modelos), intentanto segmentar en grupos a través de los cuales <strong>minimizamos alguna medida objetivo</strong>. En este contexto, el problema de segmentación/clustering se plantea como sigue:</p>
<ul>
<li><p>Suponemos que buscamos <span class="math inline">\(K\)</span> grupos.</p></li>
<li><p>Una asignación <span class="math inline">\(C\)</span> es una función que asigna a cada observación <span class="math inline">\(x_i\)</span> un grupo <span class="math inline">\(C(i)\in \{1,\ldots, k\}\)</span>.</p></li>
<li><p>Tenemos una distancia o disimilitud <span class="math inline">\(d(x,y)\)</span> entre puntos, y una función <span class="math inline">\(W(C_k)\)</span> que mide qué tan disperso es el grupo <span class="math inline">\(C_k\)</span> en términos de la distancia <span class="math inline">\(d\)</span>.</p></li>
</ul>
<p>Buscamos entonces encontrar una solución <span class="math inline">\(C^*(i)\)</span> que minimice</p>
<p><span class="math display">\[W(C) = \sum_{k=1}^K W(C_k),\]</span></p>
<p>es decir, buscamos que las distancias <strong>dentro de cada grupo</strong> (within groups) <span class="math inline">\(k\)</span> sean lo más chicas posibles.</p>
<ul>
<li><p>Resolver este problema enumerando todas las posibles asignaciones <span class="math inline">\(C\)</span> no es factible, pues el número de posibles asignaciones es típicamente gigantesco aún para un conjunto de datos muy chico.</p></li>
<li><p>La idea entonces es buscar heurísticas que den soluciones razonables a este problema de minimización.</p></li>
</ul>
</div>
<div id="k-medias" class="section level2">
<h2><span class="header-section-number">16.3</span> K-medias</h2>
<p>Éste es posiblemente el algoritmo (o familia de algoritmos) más popular de segmentación, y se escala razonablemente bien a problemas relativamente grandes.</p>
<p>Supongamos que tenemos datos numéricos con escala o unidades similares (si no, podemos estandarizar).</p>
<p>En k-medias, un buen agrupamiento es uno en el que la variación dentro de los grupos es chica. En primer lugar fijamos el número <span class="math inline">\(K\)</span> de grupos que buscamos. Supongamos entonces que <span class="math inline">\(C_1\cup\cdots\cup C_K\)</span> es una partición de los datos, y sea <span class="math inline">\(W(C_k)\)</span> nuestra medida de variación dentro de los clusters. Entonces buscaremos resolver</p>
<p><span class="math display">\[
\min_{C_1,\ldots, C_K} \sum_{k=1}^K W(C_k)
\]</span></p>
<p>Una medida usual es la siguiente:</p>
<p><span class="math display">\[W(C_k)=\sum_{i\in C_k} ||x_i-\bar{x}_k||^2,\]</span></p>
<p>donde <span class="math inline">\(\bar{x}_k=\frac{1}{|C_k|}\sum_{i\in C_k} x_i\)</span> es el centroide del grupo <span class="math inline">\(C_k\)</span>. Esto mide qué tan compacto es un grupo considerando la suma de distancias a su centroide.</p>
<p>El problema que queremos resolver es entonces</p>
<span class="math display" id="eq:kmedias-original">\[\begin{equation}
\min_{C_1,\ldots, C_K} \sum_{k=1}^K \sum_{i\in C_k} ||x_i-\bar{x}_k||^2
\tag{16.1}
\end{equation}\]</span>
<p>Nótese que cada caso <span class="math inline">\(x_k\)</span> contribuye un sumando a la función objetivo. Este problema es demasiado grande para resolver por fuerza bruta (por ejemplo, enlistando todas las posibles agrupaciones).</p>
<p>Podemos desarrollar una heurística considerando primero el problema ampliado</p>
<span class="math display" id="eq:kmedias-ampliado">\[\begin{equation}
\min_{C_1,\ldots, C_K, m_1,\ldots, m_K} \sum_{k=1}^K \sum_{i\in C_k}||x_i-m_k||^2 
\tag{16.2}
\end{equation}\]</span>
<p>cuya solución es la misma que el problema original. La razón es que la función objetivo del problema ampliado alcanza un mínimo menor o igual al del problema original, pero dada cualquier solución <span class="math inline">\(C_1^*,C_2^*,\ldots,C_K^*\)</span>, tenemos que para toda <span class="math inline">\(k\)</span>, las distancias al cuadrado son mínimas al centroide de los datos: <span class="math display">\[
\sum_{i \in C_k} ||x_i - \bar{x}_k||^2 \leq \sum_{i \in C_k} ||x_i - m_k||^2,
\]</span> por lo que <span class="math inline">\(C_1^*,C_2^*,\ldots,C_K^*\)</span> también es solución del problema original.</p>
<p>Ahora desarrollamos la heurística de k-medias. Comenzando con el problema ampliado, notamos que si fijamos puntos centrales iniciales</p>
<p><span class="math display">\[
m_1,\ldots, m_K
\]</span></p>
<p>podemos minimizar (con centros fijos)</p>
<p><span class="math display">\[
\min_{C_1,\ldots, C_K} \sum_{k=1}^K \sum_{i\in C_k}||x_i-m_k||^2 
\]</span></p>
<p>asignando cada <span class="math inline">\(x_i\)</span> al cluster <span class="math inline">\(C_k\)</span> con la <span class="math inline">\(m_k\)</span> asociada más cercana a <span class="math inline">\(x_i\)</span>.</p>
<p>Una vez que tenemos clusters dados, podemos ahora minimizar (con clusters fijos)</p>
<p><span class="math display">\[
\min_{m_1,\ldots, m_K} \sum_{k=1}^K \sum_{i\in C_k}||x_i-m_k||^2
\]</span></p>
<p>cuya solución es</p>
<p><span class="math display">\[
m_k = \bar{x}_k = \frac{1}{n_k}\sum_{i\in C_k} x_i.
\]</span></p>
<p>Ahora podemos iterar: agrupar en clusters, encontrar centroide, etc.</p>
<p>Esto sugiere el siguiente algoritmo:</p>
<div id="algoritmo-de-k-medias" class="section level3 unnumbered">
<h3>Algoritmo de k-medias</h3>

<div class="comentario">
<p><strong>K-means</strong> Sea <span class="math inline">\(k\)</span> el número de grupos que buscamos. Escogemos <span class="math inline">\(k\)</span> puntos en los datos de entrenamiento al azar.</p>
<p>En el paso <span class="math inline">\(s=1,2,\ldots\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Dadas los centros <span class="math inline">\(m_k\)</span> (que pensamos fijas), encontramos una nueva asignación <span class="math inline">\(C_k\)</span> a clusters que minimice <span class="math display">\[
2\sum_{k=1}^K \sum_{i\in C_k} ||x_i - m_k||^2,
\]</span> y esto se hace asignando cada observación al centro <span class="math inline">\(m_k\)</span> que esté más cercano.</p></li>
<li><p>(cálculo de centroides) Dada una asignación a clusters, encontramos nuevos centros promediando en cada cluster : <span class="math display">\[
m_k = \frac{1}{|C_k|}\sum_{i\in C_k} x_i.
\]</span></p></li>
</ol>
3.Repetimos. Nos detenemos cuando los centroides se quedan casi fijos de una iteración a la siguiente (y en consecuencia la cantidad a minimizar no decrece más).
</div>

<p><strong>Observaciones</strong>:</p>
<ul>
<li><p>Este algoritmo converge (cada paso reduce la función de costo), pero no tiene garantía de obtener un mínimo global.</p></li>
<li><p>Conviene correr varias veces, para distintos arranques aleatorios, y escoger la solución con función objetivo más chica. Cuando no es posible correrlo múltiples veces, puede ser que la solución obtenida esté muy lejos de una óptima.</p></li>
<li><p>Hay distintas maneras de implementar este algoritmo, algunas más eficientes que otras.</p></li>
</ul>
</div>
<div id="ejemplo-8" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>Describiremos iteraciones para <span class="math inline">\(K=5\)</span> para el conjunto de datos, con una implementación simple:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">quakes_<span class="dv">1</span> &lt;-<span class="st"> </span>quakes[, <span class="kw">c</span>(<span class="st">&#39;lat&#39;</span>,<span class="st">&#39;long&#39;</span>)]
quakes_<span class="dv">1</span><span class="op">$</span>id &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(quakes_<span class="dv">1</span>)
<span class="kw">ggplot</span>(quakes_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-6-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Seleccionamos muestra de datos al azar (centroides):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2512</span>)
K &lt;-<span class="st"> </span><span class="dv">5</span>
centros &lt;-<span class="st"> </span><span class="kw">sample_n</span>(quakes_<span class="dv">1</span>, K) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">k =</span> <span class="dv">1</span><span class="op">:</span>K) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>id)
<span class="kw">ggplot</span>(quakes_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> centros, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat), <span class="dt">size=</span><span class="dv">7</span>, <span class="dt">colour=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-7-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Agrupamos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">agrupar &lt;-<span class="st"> </span><span class="cf">function</span>(datos, centros){
  datos_larga &lt;-<span class="st"> </span>datos <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(variable, valor, <span class="op">-</span>id)
  centros_larga &lt;-<span class="st"> </span>centros <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(variable, valor_m, <span class="op">-</span>k)
  dat &lt;-<span class="st"> </span><span class="kw">full_join</span>(datos_larga, centros_larga) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">mutate</span>(<span class="dt">dif_cuad =</span> (valor<span class="op">-</span>valor_m)<span class="op">^</span><span class="dv">2</span>) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">group_by</span>(id, k) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">summarise</span>(<span class="dt">dist_cuad =</span> <span class="kw">sum</span>(dif_cuad)) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">group_by</span>(id) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">arrange</span>(id, k) <span class="op">%&gt;%</span>
<span class="st">          </span><span class="kw">summarise</span>(<span class="dt">k =</span> <span class="kw">which.min</span>(dist_cuad))
  dat &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">left_join</span>(datos)
  dat
}
agrup &lt;-<span class="st"> </span><span class="kw">agrupar</span>(quakes_<span class="dv">1</span>, centros)
<span class="co">#&gt; Joining, by = &quot;variable&quot;</span>
<span class="co">#&gt; Joining, by = &quot;id&quot;</span>
<span class="kw">ggplot</span>(agrup, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">colour=</span><span class="kw">factor</span>(k))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Recalculamos centros:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">recalcular_centros &lt;-<span class="st"> </span><span class="cf">function</span>(datos_agrup){
  datos_agrup <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(variable, valor, <span class="op">-</span>id, <span class="op">-</span>k) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(k, variable) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">valor =</span> <span class="kw">mean</span>(valor)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">spread</span>(variable, valor)
}
centros &lt;-<span class="st"> </span><span class="kw">recalcular_centros</span>(agrup)
<span class="kw">ggplot</span>(quakes_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> centros, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat), <span class="dt">size=</span><span class="dv">7</span>, <span class="dt">colour=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Y ahora calculamos distancia dentro de clusters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">wss &lt;-<span class="st"> </span><span class="cf">function</span>(agrupacion, centros){
  wss &lt;-<span class="st"> </span>agrupacion <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(k) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">    </span><span class="kw">gather</span>(variable, valor,<span class="op">-</span>id, <span class="op">-</span>k) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">left_join</span>(centros <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(variable, centro, <span class="op">-</span>k), <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;k&quot;</span>, <span class="st">&quot;variable&quot;</span>)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(k) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarise</span>(<span class="dt">dist_2 =</span> <span class="kw">sum</span>((valor <span class="op">-</span><span class="st"> </span>centro)<span class="op">^</span><span class="dv">2</span>)) 
  <span class="kw">sum</span>(wss<span class="op">$</span>dist_<span class="dv">2</span>)
}
<span class="kw">wss</span>(agrup, centros)
<span class="co">#&gt; [1] 11022</span></code></pre></div>
<p>Agrupamos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">agrup &lt;-<span class="st"> </span><span class="kw">agrupar</span>(quakes_<span class="dv">1</span>, centros) 
<span class="kw">ggplot</span>(agrup, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">colour=</span><span class="kw">factor</span>(k))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-11-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Recalculamos centros:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">centros &lt;-<span class="st"> </span><span class="kw">recalcular_centros</span>(agrup)
<span class="kw">wss</span>(agrup, centros)
<span class="co">#&gt; [1] 9657</span>
<span class="kw">ggplot</span>(quakes_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> centros, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat), <span class="dt">size=</span><span class="dv">7</span>, <span class="dt">colour=</span><span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Una iteración más da:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">agrup &lt;-<span class="st"> </span><span class="kw">agrupar</span>(quakes_<span class="dv">1</span>, centros)
centros &lt;-<span class="st"> </span><span class="kw">recalcular_centros</span>(agrup)
<span class="kw">wss</span>(agrup, centros)
<span class="co">#&gt; [1] 9115</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(agrup, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">colour=</span><span class="kw">factor</span>(k))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-14-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><br> <br></p>
<p><img src="figuras/manicule.jpg" /> <strong>Ejercicio: </strong> Corre varias veces este ejemplo con distinta semilla. ¿Obtienes mejores o peores soluciones que la de arriba? ¿Qué tan “naturales” crees que son los grupos que obtuvimos? ¿Qué defectos potenciales le ves a este agrupamiento?</p>
<p class="espacio">
</p>
<p><br></p>
</div>
<div id="usando-la-funcion-kmeans" class="section level3 unnumbered">
<h3>Usando la funcion <code>kmeans</code></h3>
<p>La función <code>kmeans</code> de R automáticamente produce varias corridas con distintos inicios aleatorios y selecciona la que produzca el mínimo más bajo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2800</span>)
k_medias &lt;-<span class="st"> </span><span class="kw">kmeans</span>(quakes_<span class="dv">1</span>[, <span class="kw">c</span>(<span class="st">&#39;long&#39;</span>,<span class="st">&#39;lat&#39;</span>)], <span class="dt">centers =</span> <span class="dv">5</span>, <span class="dt">nstart=</span><span class="dv">30</span>) <span class="co"># escoger varios comienzos aleatorios</span>
<span class="kw">str</span>(k_medias)
<span class="co">#&gt; List of 9</span>
<span class="co">#&gt;  $ cluster     : int [1:1000] 1 1 1 2 1 2 4 5 5 2 ...</span>
<span class="co">#&gt;  $ centers     : num [1:5, 1:2] 181 184 170 167 181 ...</span>
<span class="co">#&gt;   ..- attr(*, &quot;dimnames&quot;)=List of 2</span>
<span class="co">#&gt;   .. ..$ : chr [1:5] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...</span>
<span class="co">#&gt;   .. ..$ : chr [1:2] &quot;long&quot; &quot;lat&quot;</span>
<span class="co">#&gt;  $ totss       : num 62065</span>
<span class="co">#&gt;  $ withinss    : num [1:5] 1868 2465 314 682 1406</span>
<span class="co">#&gt;  $ tot.withinss: num 6736</span>
<span class="co">#&gt;  $ betweenss   : num 55330</span>
<span class="co">#&gt;  $ size        : int [1:5] 326 353 69 136 116</span>
<span class="co">#&gt;  $ iter        : int 3</span>
<span class="co">#&gt;  $ ifault      : int 0</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;kmeans&quot;</span>
grupo &lt;-<span class="st"> </span>k_medias<span class="op">$</span>cluster
quakes_<span class="dv">1</span><span class="op">$</span>grupo &lt;-<span class="st"> </span>grupo
<span class="kw">ggplot</span>(quakes_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x=</span>long, <span class="dt">y=</span>lat, <span class="dt">colour=</span><span class="kw">factor</span>(grupo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><strong>Observaciones</strong>:</p>
<ul>
<li>En la salida la cantidad</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">k_medias<span class="op">$</span>tot.withinss
<span class="co">#&gt; [1] 6736</span></code></pre></div>
<p>nos da el valor de <a href="analisis-de-conglomerados-clustering-1.html#eq:kmedias-original">(16.1)</a> para la solución obtenida.</p>
<ul>
<li>El algoritmo usado por defecto en R es el de Hartigan-Wong, que es más eficiente que la implementación simple que vimos arriba.</li>
</ul>
</div>
</div>
<div id="seleccion-de-numero-de-clusters." class="section level2">
<h2><span class="header-section-number">16.4</span> Selección de número de clusters.</h2>
<div id="variacion-dentro-de-clusters-para-distintas-soluciones" class="section level3 unnumbered">
<h3>Variación dentro de clusters para distintas soluciones</h3>
<p>Podemos medir la calidad de la segmentación según el mínimo alcanzado de la función objetivo: la suma de cuadrados dentro de los clusters (withinss), que nos dice qué tan compactos son. Primero vemos un ejemplo simple con tres clusters claros:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2800</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="op">-</span><span class="dv">50</span>,<span class="dv">10</span>), <span class="kw">rnorm</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="dv">10</span>), <span class="kw">rnorm</span>(<span class="dv">70</span>,<span class="dv">30</span>,<span class="dv">2</span>) ))
<span class="kw">qplot</span>(df<span class="op">$</span>x)
ajustes_km &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="cf">function</span>(k){
  kmedias &lt;-<span class="st"> </span><span class="kw">kmeans</span>(df, <span class="dt">centers =</span> k, <span class="dt">nstart =</span> <span class="dv">20</span>)    
  kmedias
})
tot_within &lt;-<span class="st"> </span><span class="kw">sapply</span>(ajustes_km, <span class="cf">function</span>(aj){ aj<span class="op">$</span>tot.withinss})
datos_codo &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">no_clusters =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(tot_within), 
                         <span class="dt">tot_within =</span> tot_within) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sol_3 =</span> no_clusters<span class="op">==</span><span class="dv">3</span>)
<span class="kw">ggplot</span>(datos_codo, <span class="kw">aes</span>(<span class="dt">x =</span> no_clusters, <span class="dt">y =</span> tot_within)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> sol_<span class="dv">3</span>), <span class="dt">size=</span><span class="dv">3</span>) </code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /><img src="16-clustering-1_files/figure-html/unnamed-chunk-17-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Agregar un cluster adicional hace más complejo nuestro resumen, así que incrementamos el número de clusters sólo cuando tenemos una mejora considerable en la solución. En este caso particular, un buen lugar para cortar es el codo (en 3 clusters), pues añadir un cluster más no mejora la solución considerablemente.</p>
<p>A veces el punto de corte no es tan claro, aunque vemos que en nuestro ejemplo de terremotos la estructura más clara es la de 2 grupos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">2800</span>)
df &lt;-<span class="st"> </span>quakes_<span class="dv">1</span>[, <span class="kw">c</span>(<span class="st">&#39;lat&#39;</span>,<span class="st">&#39;long&#39;</span>)]
ajustes_km &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>, <span class="cf">function</span>(k){
  kmedias &lt;-<span class="st"> </span><span class="kw">kmeans</span>(df, <span class="dt">centers =</span> k, <span class="dt">nstart =</span> <span class="dv">20</span>)    
  kmedias
})
tot_within &lt;-<span class="st"> </span><span class="kw">sapply</span>(ajustes_km, <span class="cf">function</span>(aj){ aj<span class="op">$</span>tot.withinss})
<span class="kw">qplot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(tot_within), tot_within, <span class="dt">geom=</span><span class="st">&#39;line&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">size=</span><span class="dv">3</span>)</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Las soluciones son:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">grupos_df &lt;-<span class="st"> </span><span class="kw">lapply</span>(ajustes_km[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>], <span class="cf">function</span>(aj){ 
  <span class="kw">data_frame</span>(<span class="dt">num =</span> <span class="kw">max</span>(aj<span class="op">$</span>cluster), <span class="dt">cluster =</span> aj<span class="op">$</span>cluster,
             <span class="dt">id=</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(aj<span class="op">$</span>cluster))}) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">bind_rows</span>()
grupo_df_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">left_join</span>(grupos_df, quakes_<span class="dv">1</span>)
<span class="kw">ggplot</span>(grupo_df_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x=</span>lat, <span class="dt">y=</span>long, <span class="dt">colour=</span><span class="kw">factor</span>(cluster))) <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>num) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-19-1.png" width="100%" style="display: block; margin: auto;" /></p>

<div class="comentario">
La gráfica de codo con la función objetivo es una manera de guiar la selección de número de clusters, aún cuando no siempre da respuestas muy claras. En cualquier caso, rara vez seleccionamos el número de clusters usando solamente el criterio de la gráfica de la función objetivo.
</div>

</div>
<div id="criterios-especificos" class="section level3">
<h3><span class="header-section-number">16.4.1</span> Criterios específicos</h3>
<p>Más frecuentemente, la selección de número de grupos se hace tomando en cuenta el uso posterior que se va a hacer de los clusters. Por ejemplo:</p>
<ul>
<li><p>En segmentación de clientes/usuarios, casi siempre queremos un grupo no muy grande de grupos (2-10, máximo decenas), pues puede ser difícil diseñar productos o estrategias particulares si tenemos muchos segmentos.Lo mismo sucede en aplicaciones científicas, por ejemplo clasificar objetos como estrellas, galaxias, etc.</p></li>
<li><p>Existen algunas aplicaciones de clustering donde buscamos muchos grupos, por ejemplo, para agrupar objetos (noticias, tweets, por ejemplo) en clusters muy compactos (de alta similitud), y así detectar duplicados o relaciones entre fuentes de noticias, usuarios de twitter, etc. Hay más opciones además de algoritmos clásicos como k-means para este tipo de problemas</p></li>
</ul>
<p>La estrategia típica es entonces producir varias agrupaciones, y compararlas según sus virtudes para uso posterior.</p>
<div id="ejemplo-9" class="section level4 unnumbered">
<h4>Ejemplo</h4>
<p>Consideremos segmentar personas según sus actitudes hacia las responsabilidades que tiene o no el gobierno en cuanto al bienestar de las personas.</p>
<p>European Social Survey (ESS) data from the 2008 (fourth) round in the United Kingdom. The data are from a questionnaire on “what the responsibilities of governments should or should not be.”</p>
<ul>
<li><p>gvjbevn: Job for everyone, governments’ responsibility (0-10).</p></li>
<li><p>gvhlthc: Health care for the sick, governments’ responsibility (0-10).</p></li>
<li><p>gvslvol: Standard of living for the old, governments’ responsibility (0-10).</p></li>
<li><p>gvslvue: Standard of living for the unemployed, governments’ responsibility (0-10).</p></li>
<li><p>gvcldcr: Child care services for working parents, governments’ responsibility (0-10).</p></li>
<li><p>gvpdlwk: Paid leave from work to care for sick family, governments’ responsibility (0-10).</p></li>
<li><p>sbprvpv: Social benefits/services prevent widespread poverty (1-5).</p></li>
<li><p>sbeqsoc: Social benefits/services lead to a more equal society (1-5).</p></li>
<li><p>sbcwkfm: Social benefits/services make it easier to combine work and family (1-5).</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ess4_gb &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;datos/ess4_gb.csv&#39;</span>)
dat &lt;-<span class="st"> </span>ess4_gb <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(idno, gvjbevn<span class="op">:</span>sbcwkfm)
nombres &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">var =</span> <span class="kw">c</span>(<span class="st">&quot;gvjbevn&quot;</span>, <span class="st">&quot;gvhlthc&quot;</span>, <span class="st">&quot;gvslvol&quot;</span>, <span class="st">&quot;gvslvue&quot;</span>, <span class="st">&quot;gvcldcr&quot;</span>, <span class="st">&quot;gvpdlwk&quot;</span>, <span class="st">&quot;sbprvpv&quot;</span>, <span class="st">&quot;sbeqsoc&quot;</span>, <span class="st">&quot;sbcwkfm&quot;</span>),
<span class="dt">nombre =</span> <span class="kw">c</span>(<span class="st">&#39;trabajo_a_todos&#39;</span>,<span class="st">&#39;cuidados_salud_enfermos&#39;</span>,<span class="st">&#39;garantizar_nivel_mayores&#39;</span>,<span class="st">&#39;garantizar_nivel_desempleados&#39;</span>,<span class="st">&#39;ayuda_padres_trabajadores&#39;</span>,<span class="st">&#39;ausencia_cuidar_enfermos&#39;</span>,<span class="st">&#39;beneficios_pobreza&#39;</span>,<span class="st">&#39;beneficios_igualdad&#39;</span>,<span class="st">&#39;beneficios_fam_trabajo&#39;</span>))
<span class="kw">head</span>(dat) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">idno</th>
<th align="right">gvjbevn</th>
<th align="right">gvhlthc</th>
<th align="right">gvslvol</th>
<th align="right">gvslvue</th>
<th align="right">gvcldcr</th>
<th align="right">gvpdlwk</th>
<th align="right">sbprvpv</th>
<th align="right">sbeqsoc</th>
<th align="right">sbcwkfm</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">110701</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">5</td>
<td align="right">5</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">110702</td>
<td align="right">5</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">5</td>
<td align="right">10</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td align="right">110703</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">10</td>
<td align="right">0</td>
<td align="right">8</td>
<td align="right">10</td>
<td align="right">4</td>
<td align="right">4</td>
<td align="right">3</td>
</tr>
<tr class="even">
<td align="right">110704</td>
<td align="right">8</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">3</td>
<td align="right">8</td>
<td align="right">6</td>
<td align="right">3</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="right">110705</td>
<td align="right">7</td>
<td align="right">10</td>
<td align="right">8</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="right">8</td>
<td align="right">4</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">110708</td>
<td align="right">0</td>
<td align="right">10</td>
<td align="right">10</td>
<td align="right">5</td>
<td align="right">7</td>
<td align="right">7</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<p>En este caso particular tenemos unas variables que están en escala 1-5 y otras 1-10. Esta variabilidad distinta sólo es escala de las respuestas, así que normalizamos dividiendo cada pregunta por su máximo (dividir entre 10 las preguntas en escala de 1 a 10 y entre 5 las de 1 a 5. Podríamos también estandarizar):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dat_<span class="dv">2</span> &lt;-<span class="st"> </span>dat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(var, valor, gvjbevn<span class="op">:</span>sbcwkfm) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(nombres) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>var) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(nombre) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">valor_escalado =</span> valor<span class="op">/</span><span class="kw">max</span>(valor, <span class="dt">na.rm=</span>T)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>valor) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">spread</span>(nombre, valor_escalado)
<span class="co">#&gt; Joining, by = &quot;var&quot;</span>
dat_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(dat_<span class="dv">2</span>, <span class="kw">apply</span>(dat_<span class="dv">2</span>, <span class="dv">1</span>, <span class="cf">function</span>(x){<span class="op">!</span><span class="kw">any</span>(<span class="kw">is.na</span>(x))}))
dat_<span class="dv">3</span>
<span class="co">#&gt; # A tibble: 2,108 x 10</span>
<span class="co">#&gt;     idno ausencia_cuidar_enfer… ayuda_padres_trabajad… beneficios_fam_tra…</span>
<span class="co">#&gt;    &lt;int&gt;                  &lt;dbl&gt;                  &lt;dbl&gt;               &lt;dbl&gt;</span>
<span class="co">#&gt; 1 110701                    0.4                    0.5                 0.4</span>
<span class="co">#&gt; 2 110702                    1                      0.5                 0.8</span>
<span class="co">#&gt; 3 110703                    1                      0.8                 0.6</span>
<span class="co">#&gt; 4 110704                    0.6                    0.8                 0.4</span>
<span class="co">#&gt; 5 110705                    0.8                    0.9                 0.4</span>
<span class="co">#&gt; 6 110708                    0.7                    0.7                 0.4</span>
<span class="co">#&gt; # ... with 2,102 more rows, and 6 more variables:</span>
<span class="co">#&gt; #   beneficios_igualdad &lt;dbl&gt;, beneficios_pobreza &lt;dbl&gt;,</span>
<span class="co">#&gt; #   cuidados_salud_enfermos &lt;dbl&gt;, garantizar_nivel_desempleados &lt;dbl&gt;,</span>
<span class="co">#&gt; #   garantizar_nivel_mayores &lt;dbl&gt;, trabajo_a_todos &lt;dbl&gt;</span>

ajustes_km &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(k){
  kmedias &lt;-<span class="st"> </span><span class="kw">kmeans</span>(dat_<span class="dv">3</span>[,<span class="op">-</span><span class="dv">1</span>], <span class="dt">centers =</span> k, <span class="dt">nstart =</span> <span class="dv">20</span>, <span class="dt">iter.max=</span><span class="dv">40</span>)    
  kmedias
})
tot_within &lt;-<span class="st"> </span><span class="kw">sapply</span>(ajustes_km, <span class="cf">function</span>(aj){ aj<span class="op">$</span>tot.withinss})
<span class="kw">qplot</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(tot_within), tot_within, <span class="dt">geom=</span><span class="st">&#39;line&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>En esta gráfica no vemos un codo claro. Veamos primero la solución de dos grupos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sol_cl &lt;-<span class="st"> </span>ajustes_km[[<span class="dv">2</span>]]
<span class="kw">table</span>(sol_cl<span class="op">$</span>cluster)
<span class="co">#&gt; </span>
<span class="co">#&gt;    1    2 </span>
<span class="co">#&gt; 1116  992</span></code></pre></div>
<p>Ahora veamos cómo resumir grupos para entender qué tipo de casos están en cada uno de ellos. Consideramos las variables originales escaladas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cluster_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">idno =</span> dat_<span class="dv">3</span><span class="op">$</span>idno, <span class="dt">cluster =</span> sol_cl<span class="op">$</span>cluster)
dat_<span class="dv">4</span> &lt;-<span class="st"> </span>dat_<span class="dv">3</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(variable, valor, ausencia_cuidar_enfermos<span class="op">:</span>trabajo_a_todos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(cluster_df)</code></pre></div>
<p>Y resumimos dentro de cada grupo cada una de las variables. Elecciones populares son la media y el error estándar de la media (desviación estándar dividida entre la raíz del número de casos):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resumen_<span class="dv">1</span> &lt;-<span class="st"> </span>dat_<span class="dv">4</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cluster, variable) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">media =</span> <span class="kw">mean</span>(valor), <span class="dt">ee =</span> <span class="kw">sd</span>(valor)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(valor)))
resumen_<span class="dv">1</span>
<span class="co">#&gt; # A tibble: 18 x 4</span>
<span class="co">#&gt; # Groups:   cluster [?]</span>
<span class="co">#&gt;   cluster variable                  media      ee</span>
<span class="co">#&gt;     &lt;int&gt; &lt;chr&gt;                     &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1       1 ausencia_cuidar_enfermos  0.816 0.00476</span>
<span class="co">#&gt; 2       1 ayuda_padres_trabajadores 0.804 0.00475</span>
<span class="co">#&gt; 3       1 beneficios_fam_trabajo    0.490 0.00474</span>
<span class="co">#&gt; 4       1 beneficios_igualdad       0.554 0.00556</span>
<span class="co">#&gt; 5       1 beneficios_pobreza        0.506 0.00528</span>
<span class="co">#&gt; 6       1 cuidados_salud_enfermos   0.928 0.00323</span>
<span class="co">#&gt; # ... with 12 more rows</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## adicionalmente, invertimos las 3 preguntas en escala de 1 a 5, pues 1 representa mayor acuerdo. 
filtro &lt;-<span class="st"> </span>resumen_<span class="dv">1</span><span class="op">$</span>variable <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;beneficios_fam_trabajo&#39;</span>,<span class="st">&#39;beneficios_igualdad&#39;</span>,<span class="st">&#39;beneficios_pobreza&#39;</span>)
resumen_<span class="dv">1</span><span class="op">$</span>media[filtro] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>resumen_<span class="dv">1</span><span class="op">$</span>media[filtro]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resumen_<span class="dv">1</span><span class="op">$</span>variable &lt;-<span class="st"> </span><span class="kw">reorder</span>(resumen_<span class="dv">1</span><span class="op">$</span>variable, resumen_<span class="dv">1</span><span class="op">$</span>media, mean)
<span class="kw">ggplot</span>(resumen_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>media, <span class="dt">ymin=</span>media<span class="op">-</span>ee, <span class="dt">ymax=</span>media<span class="op">+</span>ee,
                      <span class="dt">colour=</span><span class="kw">factor</span>(cluster), <span class="dt">group=</span>cluster)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_linerange</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-27-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Y notamos dos grupos claros que esperaríamos ver. ¿Cómo la describirías? Esta puede ser una solución aceptable (por ejemplo, si vamos a usar los grupos en otro modelo, como parte de diseños de estrategias de comunicación, etc.)</p>
<p>Intentemos ahora con 5 grupos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sol_cl &lt;-<span class="st"> </span>ajustes_km[[<span class="dv">5</span>]]
<span class="kw">table</span>(sol_cl<span class="op">$</span>cluster)
<span class="co">#&gt; </span>
<span class="co">#&gt;   1   2   3   4   5 </span>
<span class="co">#&gt; 450 417 573 306 362</span></code></pre></div>
<p>Todos los grupos tienen tamaño razonable. No queremos tener grupos muy chicos, <strong>pues entonces es difícil caracterizarlos o entenderlos</strong>: si hay 15 personas en un grupo, cualquier resumen de este grupo estaría sujeto a variación muestral alta.</p>
<p>Consideramos las variables originales:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cluster_df &lt;-<span class="st"> </span><span class="kw">data_frame</span>(<span class="dt">idno =</span> dat_<span class="dv">3</span><span class="op">$</span>idno, <span class="dt">cluster =</span> sol_cl<span class="op">$</span>cluster)
dat_<span class="dv">4</span> &lt;-<span class="st"> </span>dat_<span class="dv">3</span> <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(variable, valor, ausencia_cuidar_enfermos<span class="op">:</span>trabajo_a_todos) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">left_join</span>(cluster_df)
resumen_<span class="dv">5</span> &lt;-<span class="st"> </span>dat_<span class="dv">4</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(cluster, variable) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">media =</span> <span class="kw">mean</span>(valor), <span class="dt">ee =</span> <span class="kw">sd</span>(valor)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">length</span>(valor)))

## adicionalmente, invertimos las 3 preguntas en escala de 1 a 5, pues 1 representa mayor acuerdo. 
filtro &lt;-<span class="st"> </span>resumen_<span class="dv">5</span><span class="op">$</span>variable <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;beneficios_fam_trabajo&#39;</span>,<span class="st">&#39;beneficios_igualdad&#39;</span>,<span class="st">&#39;beneficios_pobreza&#39;</span>)
resumen_<span class="dv">5</span><span class="op">$</span>media[filtro] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>resumen_<span class="dv">5</span><span class="op">$</span>media[filtro]</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resumen_<span class="dv">5</span><span class="op">$</span>variable &lt;-<span class="st"> </span><span class="kw">reorder</span>(resumen_<span class="dv">5</span><span class="op">$</span>variable, resumen_<span class="dv">5</span><span class="op">$</span>media, mean)
<span class="kw">ggplot</span>(resumen_<span class="dv">5</span>, <span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>media, <span class="dt">ymin=</span>media<span class="op">-</span>ee, <span class="dt">ymax=</span>media<span class="op">+</span>ee,
                      <span class="dt">colour=</span><span class="kw">factor</span>(cluster), <span class="dt">group=</span>cluster)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_linerange</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-30-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Y en estos casos es especialmente útil perfilar los grupos, es decir, mostrar las diferencias en las medias de cada grupo con respecto a la media general:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">resumen_perfil_<span class="dv">5</span> &lt;-<span class="st"> </span>resumen_<span class="dv">5</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(variable) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">perfil =</span> media <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(media))

<span class="kw">ggplot</span>(resumen_perfil_<span class="dv">5</span>, <span class="kw">aes</span>(<span class="dt">x =</span> variable, <span class="dt">y =</span> perfil, 
                      <span class="dt">colour =</span> <span class="kw">factor</span>(cluster), <span class="dt">group =</span> cluster)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span>cluster) <span class="op">+</span><span class="st"> </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">colour=</span><span class="st">&#39;gray&#39;</span>)</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-31-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>¿Cómo les llamarías a cada uno de estos grupos?</p>
<p><strong>Observación: heterogeneidad en uso de escalas</strong></p>
<p>Los datos en escalas de acuerdo, que son usados frecuentemente en encuestas sociales y de negocios, tienen dificultades adicionales:</p>
<ul>
<li><p>Desde el punto de vista estadístico, usamos una medición ordinal como si fuera numérica. Esto sugiere utilizar técnicas de clustering más complicadas adaptadas a datos ordinales. Pero en realidad éste es un aspecto menor en el análisis de este tipo de datos.</p></li>
<li><p>La dificultad grande en el análisis de este tipo de datos es la heterogeneidad en el uso de la escala. Esto quiere decir que no todas las personas usan escalas 1-10 (o 1-5, o 1-100, o Totalmente de acuerdo-Totalmente en desacuerdo) de la misma manera. Hay algunos que usan todo el rango de la escala, otros que se concentran en la mitad, etc. y muchas veces eso no tienen que ver sólo con el verdadero nivel de acuerdo o desacuerdo de la persona, sino también con cómo usa el lenguaje cada persona.</p></li>
<li><p>El verdadero problema es entonces en la medición, no que tratemos como numérica a una variable que no lo es. Los datos de una persona no son realmente directamente comparables con los de otra persona. Hay maneras de lidiar con esto: por ejemplo, centrar los niveles de respuesta de cada persona, usar modelos que intentan medir la heterogeneidad de uso en la escala y separar los niveles de acuerdo, pero lo mejor en estos casos siempre es (si es posible) mejorar la medición.</p></li>
</ul>
</div>
</div>
</div>
<div id="dificultades-en-segmentacionclustering." class="section level2">
<h2><span class="header-section-number">16.5</span> Dificultades en segmentación/clustering.</h2>
<p>Aunque la idea conceptual de clustering es más o menos clara, en la práctica es una tarea difícil. Vamos a empezar apuntando dificultades que se comunmente se encuentran:</p>
<ul>
<li><p>La estructura de grupos naturales que buscamos no es necesariamente de clusters compactos.</p></li>
<li><p>No existen grupos naturales</p></li>
<li><p>En dimensiones altas (digamos &gt; 30) muchas veces todos los puntos están a distancias similares entre ellos, especialmente cuando hay variables que aportan la separación entre grupos.</p></li>
<li><p>Dificultades en la selección de medida de distancia (o disimilitud).</p></li>
</ul>
<div id="estructuras-no-compactas" class="section level3">
<h3><span class="header-section-number">16.5.1</span> Estructuras no compactas</h3>
<p>En algunos casos se dice que k-medias no tiene supuestos, otros dicen que tienen supuestos de clusters esféricos, etc.</p>
<p><code>k-medias</code> es un algoritmo, <strong>no es un modelo</strong>. Así que en realidad no tiene supuestos en el sentido típico.</p>
<p><strong>Lo importante es entender la cantidad que estamos minimizando</strong>. Si lo que realmente queremos hacer es minimizar esta cantidad, entonces k-medias nos devuelve una solución razonable.</p>
<p>Pero hay veces que no queremos minimizar esta cantidad. Un ejemplo clásico es el siguiente:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">theta &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">200</span>,<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>pi)
r &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">runif</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), <span class="kw">runif</span>(<span class="dv">100</span>,<span class="fl">0.8</span>,<span class="dv">1</span>))
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>r<span class="op">*</span><span class="kw">cos</span>(theta), <span class="dt">y=</span>r<span class="op">*</span><span class="kw">sin</span>(theta))
df<span class="op">$</span>grupo &lt;-<span class="st"> </span><span class="kw">kmeans</span>(df, <span class="dt">centers=</span><span class="dv">2</span>, <span class="dt">nstart=</span><span class="dv">20</span>)<span class="op">$</span>cluster
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">colour=</span><span class="kw">factor</span>(grupo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-32-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>¿Por qué falla k-medias? Porque la estructura de grupos que estábamos buscando <strong>no</strong> es una donde los clusters están definidos por distancia baja a su centro. Aquí realmente queremos otra cosa más complicada, como clusters definidos por cantidades invariantes (en este caso, distancia al origen).</p>
<p>Sin embargo, si lo que nos interesa es distancia baja a un centroide, entonces esta solución es razonable para k=2:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">theta &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">200</span>,<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>pi)
r &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">runif</span>(<span class="dv">100</span>,<span class="dv">0</span>,<span class="fl">0.3</span>), <span class="kw">runif</span>(<span class="dv">100</span>,<span class="fl">0.8</span>,<span class="dv">1</span>))
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>r<span class="op">*</span><span class="kw">cos</span>(theta), <span class="dt">y=</span>r<span class="op">*</span><span class="kw">sin</span>(theta))
df<span class="op">$</span>grupo &lt;-<span class="st"> </span><span class="kw">kmeans</span>(df, <span class="dt">centers=</span><span class="dv">5</span>, <span class="dt">nstart=</span><span class="dv">20</span>)<span class="op">$</span>cluster
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">colour=</span><span class="kw">factor</span>(grupo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-33-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Como ejemplo, pensemos que el espacio es un espacio de “gustos por películas”. Aún cuando podría ser muy interesante descubrir esta estructura concéntrica, ¡el grupo exterior contiene personas con gustos diametralmente opuestos! El problema de hacer dos clusters, uno central y otro concéntrico puede ser un poco artificial.</p>
</div>
<div id="existencia-o-no-de-grupos-naturales" class="section level3">
<h3><span class="header-section-number">16.5.2</span> Existencia o no de grupos “naturales”</h3>
<p>Otro punto que se discute usualmente es si hay o no grupos naturales, que se refiere a grupos bien compactos y diferenciados entre sí, como en el ejemplo inicial</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">filter</span>(iris, Species <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;setosa&#39;</span>,<span class="st">&#39;versicolor&#39;</span>)), <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Length, <span class="dt">y=</span>Petal.Width)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-34-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Pero es común, por ejemplo, encontrar cosas como siguen:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">90902</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dv">0</span>,<span class="dv">1</span>))
df<span class="op">$</span>grupo &lt;-<span class="st"> </span><span class="kw">kmeans</span>(df, <span class="dt">centers=</span><span class="dv">5</span>, <span class="dt">nstart=</span><span class="dv">20</span>)<span class="op">$</span>cluster
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">colour=</span><span class="kw">factor</span>(grupo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-35-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Nótese que k-medias logró encontrar una buena solución, y esta solución puede ser muy útil para nuestros fines (agrupa puntos “similares”). Sin embargo, en esta situación debemos reconocer que los tamaños, las posiciones, y el número de grupos es fundamentalmente arbitrario, y una “buena” solución depende de nuestros fines.</p>
<p>Si corremos otra vez el algoritmo, vemos que los grupos encontrados son similares:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df<span class="op">$</span>grupo &lt;-<span class="st"> </span><span class="kw">kmeans</span>(df, <span class="dt">centers=</span><span class="dv">5</span>, <span class="dt">nstart=</span><span class="dv">20</span>)<span class="op">$</span>cluster
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">colour=</span><span class="kw">factor</span>(grupo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-36-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Sin embargo, si tomamos otra muestra distinta</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">909021</span>)
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dv">0</span>,<span class="dv">1</span>))
df<span class="op">$</span>grupo &lt;-<span class="st"> </span><span class="kw">kmeans</span>(df, <span class="dt">centers=</span><span class="dv">5</span>, <span class="dt">nstart=</span><span class="dv">20</span>)<span class="op">$</span>cluster
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y, <span class="dt">colour=</span><span class="kw">factor</span>(grupo))) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-37-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>La solución es bastante diferente. Esta diferencia no se debe al comienzo aleatorio del algoritmo. Se debe más bien a que los grupos se están definiendo por variación muestral, y pequeñas diferencias en las muestras.</p>
<p>**En esta situación, debemos entender lo arbitrario de la solución, y considerar si una solución así es útil para nuestros fines. Esto no le quita necesariamente utilidad a la segmentación resultante, pero hay que recordar que los grupos que encontramos son en ciertos aspectos arbitrarios.</p>
<div id="ejemplo-10" class="section level4 unnumbered">
<h4>Ejemplo</h4>
<p>También en esta situación puede ser que el criterio para segmentar no es uno apropiado para un algoritmo de segmentación. Por ejemplo, supongamos que un fabricante de zapatos nos pide segmentar a sus clientes en términos de su estatura y su tamaño de pie. Observamos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">909021</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">200</span>, <span class="dv">160</span>, <span class="dv">15</span> )
df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">estatura=</span>x, <span class="dt">pie=</span> <span class="dv">6</span> <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>(x<span class="op">-</span><span class="dv">160</span>)<span class="op">/</span><span class="dv">30</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">200</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))
<span class="kw">ggplot</span>(df, <span class="kw">aes</span>(<span class="dt">x=</span>estatura, <span class="dt">y=</span>pie)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-38-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>¿Dónde cortamos los grupos? Aunque cualquier algoritmo no supervisado nos va a dar una respuesta, muy posiblemente sería buena idea encontrar puntos de cortes definidos de otra manera (por ejemplo algo tan simple como cuantiles!). Algo similar ocurre en la segmentación por actitudes/ideología: no hay “buenos” y “malos” o “saludables” y “descuidados”, sino continuos a lo largo de estas actitudes.</p>
</div>
</div>
<div id="grupos-en-dimension-alta" class="section level3 unnumbered">
<h3>Grupos en dimensión alta</h3>
<p>En dimensión más alta (50 variables, 10 casos) observamos cosas como la siguiente:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">10</span><span class="op">*</span><span class="dv">50</span>), <span class="dt">ncol=</span><span class="dv">50</span>))
mat_<span class="dv">1</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span>mat_<span class="dv">1</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">10</span>
<span class="kw">dist</span>(mat_<span class="dv">1</span>, <span class="dt">method =</span> <span class="st">&#39;euclidean&#39;</span>)
<span class="co">#&gt;       1    2    3    4    5    6    7    8    9</span>
<span class="co">#&gt; 2   9.9                                        </span>
<span class="co">#&gt; 3   9.3  9.2                                   </span>
<span class="co">#&gt; 4   9.9 10.0  9.4                              </span>
<span class="co">#&gt; 5   9.3 10.6 10.8  9.1                         </span>
<span class="co">#&gt; 6  10.7 11.7 10.5  9.9 10.4                    </span>
<span class="co">#&gt; 7   8.2 11.8 10.1 11.2 11.1 12.4               </span>
<span class="co">#&gt; 8   9.6 10.0 10.0  9.8  9.6 10.0 11.3          </span>
<span class="co">#&gt; 9   9.9  9.5  9.3  9.9  9.4 10.6 11.1  9.4     </span>
<span class="co">#&gt; 10  8.2 10.1  9.9  9.9 10.0  9.9 10.3 10.8  9.4</span></code></pre></div>
<p>donde todos los puntos están a más o menos la misma distancia, aún cuando existe una estructura de grupos natural.</p>
<p>En dimensión baja, la situación se ve muy diferente:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mat_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">10</span><span class="op">*</span><span class="dv">2</span>), <span class="dt">ncol=</span><span class="dv">2</span>))
mat_<span class="dv">1</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span>] &lt;-<span class="st"> </span>mat_<span class="dv">1</span>[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">10</span>
<span class="kw">dist</span>(mat_<span class="dv">1</span>, <span class="dt">method =</span> <span class="st">&#39;euclidean&#39;</span>)
<span class="co">#&gt;        1     2     3     4     5     6     7     8     9</span>
<span class="co">#&gt; 2   1.43                                                </span>
<span class="co">#&gt; 3   2.42  3.76                                          </span>
<span class="co">#&gt; 4   1.05  1.66  2.31                                    </span>
<span class="co">#&gt; 5   2.19  1.36  4.59  2.86                              </span>
<span class="co">#&gt; 6   9.00  9.12 10.28 10.04  7.88                        </span>
<span class="co">#&gt; 7  11.85 11.95 13.06 12.89 10.69  2.85                  </span>
<span class="co">#&gt; 8   8.23  8.26  9.63  9.26  6.99  0.95  3.69            </span>
<span class="co">#&gt; 9  10.72 10.72 12.09 11.75  9.44  1.83  1.38  2.50      </span>
<span class="co">#&gt; 10 10.86 10.65 12.49 11.85  9.30  2.82  2.70  3.00  1.63</span>
<span class="kw">ggplot</span>(<span class="kw">data.frame</span>(mat_<span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">x=</span>X1, <span class="dt">y=</span>X2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="16-clustering-1_files/figure-html/unnamed-chunk-40-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Y cualquier técnica razonable que usemos lograría encontrar estos grupos.</p>
<ul>
<li>Muchas veces pueden encontrarse mejores soluciones aplicando alguna técnica de reducción de dimensionalidad antes de hacer clustering.</li>
</ul>
</div>
<div id="dificultades-en-la-seleccion-de-metrica" class="section level3 unnumbered">
<h3>Dificultades en la selección de métrica</h3>
<p>Muchas veces no hay una métrica natural para el problema. En este caso, muchas veces escogemos distancia euclideana (con variables estandarizadas o no, dependiendo de sus escalas).</p>
<ul>
<li><p>La inclusión de variables categóricas plantea distintas alternativas que dan resultados distintos.</p></li>
<li><p>En dimensión alta, incluso con variables numéricas, no siempre es claro que peso debería tener cada variable.</p></li>
</ul>
<hr />

<div class="comentario">
<p>Los métodos básicos de clustering generalmente producen una solución bien definida <strong>en problemas dimensión baja con clusters razonablemente bien definidos, donde hay una métrica de distancia natural</strong>.</p>
<p class="espacio">
</p>
<p>En otros casos, como:</p>
<ul>
<li>Dimensión alta con muchas variables ruidosas o que no aportan en la definición de los clusters.</li>
<li>Estructuras relativamente dispersas que quisiéramos agrupar</li>
<li>Clusters no bien definidos.</li>
<li>Dificultad en escoger una métrica única apropiada para el problema, el resultado puede depender mucho del algoritmo, el criterio del analista, y la muestra de entrenamiento. Eso no quiere decir que <strong>la segmentación de casos que produce el algoritmo no sea útil</strong>, más bien que es difìcil obtener grupos <em>naturales</em>
</div>
</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="correlaciones-canonicas-cca.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analisis-de-conglomerados-clustering-2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
