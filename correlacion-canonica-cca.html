<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Estadística Aplicada III</title>
  <meta name="description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)">
  <meta name="generator" content="bookdown 0.7.10 and GitBook 2.6.7">

  <meta property="og:title" content="Estadística Aplicada III" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)" />
  <meta name="github-repo" content="andreuboada/est-aplicada-3-2018" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Estadística Aplicada III" />
  
  <meta name="twitter:description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)" />
  

<meta name="author" content="Andreu Boada de Atela">


<meta name="date" content="2018-05-15">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="componentes-principales-2.html">
<link rel="next" href="conglomerados-clustering-1.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Aplicada III</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Temario y referencias</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluacion"><i class="fa fa-check"></i>Evaluación</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-r-y-rstudio"><i class="fa fa-check"></i>Software: R y Rstudio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#referencias-principales"><i class="fa fa-check"></i>Referencias principales</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#otras-referencias"><i class="fa fa-check"></i>Otras referencias</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#tareas"><i class="fa fa-check"></i>Tareas</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#por-que-un-analisis-multivariado"><i class="fa fa-check"></i><b>1.1</b> ¿Por qué un análisis multivariado?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#la-paradoja-de-simpson"><i class="fa fa-check"></i><b>1.2</b> La paradoja de Simpson</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#modelos-log-lineales"><i class="fa fa-check"></i><b>1.3</b> Modelos log-lineales</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#interpretacion-de-parametros"><i class="fa fa-check"></i><b>1.4</b> Interpretación de parámetros</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#ejemplo-dos-monedas"><i class="fa fa-check"></i><b>1.4.1</b> Ejemplo: dos monedas</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#otros-ejemplos"><i class="fa fa-check"></i><b>1.5</b> Otros ejemplos</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#discriminacion-de-residentes-hispanos-con-discapacidades"><i class="fa fa-check"></i><b>1.5.1</b> Discriminación de residentes hispanos con discapacidades</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#consumo-de-chocolate-y-premios-nobel"><i class="fa fa-check"></i><b>1.5.2</b> Consumo de chocolate y premios Nobel</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#tarea"><i class="fa fa-check"></i><b>1.6</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i><b>2</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="2.1" data-path="Rintro.html"><a href="Rintro.html#que-ventajas-tiene-r"><i class="fa fa-check"></i><b>2.1</b> ¿Qué ventajas tiene R?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="Rintro.html"><a href="Rintro.html#r-es-gratuito-y-de-codigo-abierto"><i class="fa fa-check"></i><b>2.1.1</b> R es gratuito y de código abierto</a></li>
<li class="chapter" data-level="2.1.2" data-path="Rintro.html"><a href="Rintro.html#r-tiene-una-comunidad-comprometida"><i class="fa fa-check"></i><b>2.1.2</b> R tiene una comunidad comprometida</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="Rintro.html"><a href="Rintro.html#flujo-basico-de-trabajo-para-el-analisis-de-datos-en-r."><i class="fa fa-check"></i><b>2.2</b> Flujo básico de trabajo para el análisis de datos en R.</a></li>
<li class="chapter" data-level="2.3" data-path="Rintro.html"><a href="Rintro.html#introduccion-a-r-como-lenguaje-de-programacion-y-la-plataforma-interactiva-de-rstudio."><i class="fa fa-check"></i><b>2.3</b> Introducción a R como lenguaje de programación, y la plataforma interactiva de RStudio.</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Rintro.html"><a href="Rintro.html#como-entender-r"><i class="fa fa-check"></i><b>2.3.1</b> ¿Cómo entender R?</a></li>
<li class="chapter" data-level="2.3.2" data-path="Rintro.html"><a href="Rintro.html#por-que-r"><i class="fa fa-check"></i><b>2.3.2</b> ¿Por qué R?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Rintro.html"><a href="Rintro.html#estructuras-de-datos"><i class="fa fa-check"></i><b>2.4</b> Estructuras de datos</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Rintro.html"><a href="Rintro.html#vectores"><i class="fa fa-check"></i><b>2.4.1</b> Vectores</a></li>
<li class="chapter" data-level="2.4.2" data-path="Rintro.html"><a href="Rintro.html#data-frames"><i class="fa fa-check"></i><b>2.4.2</b> Data Frames</a></li>
<li class="chapter" data-level="2.4.3" data-path="Rintro.html"><a href="Rintro.html#listas"><i class="fa fa-check"></i><b>2.4.3</b> Listas</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Rintro.html"><a href="Rintro.html#r-markdown"><i class="fa fa-check"></i><b>2.5</b> R Markdown</a><ul>
<li class="chapter" data-level="2.5.1" data-path="Rintro.html"><a href="Rintro.html#que-es-r-markdown"><i class="fa fa-check"></i><b>2.5.1</b> ¿Qué es R Markdown?</a></li>
<li class="chapter" data-level="2.5.2" data-path="Rintro.html"><a href="Rintro.html#estructura-basica-de-r-markdown"><i class="fa fa-check"></i><b>2.5.2</b> Estructura básica de R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="Rintro.html"><a href="Rintro.html#proyectos-de-rstudio"><i class="fa fa-check"></i><b>2.6</b> Proyectos de RStudio</a></li>
<li class="chapter" data-level="2.7" data-path="Rintro.html"><a href="Rintro.html#otros-aspectos-importantes-de-r"><i class="fa fa-check"></i><b>2.7</b> Otros aspectos importantes de R</a><ul>
<li class="chapter" data-level="2.7.1" data-path="Rintro.html"><a href="Rintro.html#valores-faltantes"><i class="fa fa-check"></i><b>2.7.1</b> Valores faltantes</a></li>
<li class="chapter" data-level="2.7.2" data-path="Rintro.html"><a href="Rintro.html#funciones"><i class="fa fa-check"></i><b>2.7.2</b> Funciones</a></li>
<li class="chapter" data-level="2.7.3" data-path="Rintro.html"><a href="Rintro.html#funcionales"><i class="fa fa-check"></i><b>2.7.3</b> Funcionales</a></li>
<li class="chapter" data-level="2.7.4" data-path="Rintro.html"><a href="Rintro.html#rendimiento-en-r"><i class="fa fa-check"></i><b>2.7.4</b> Rendimiento en R</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="Rintro.html"><a href="Rintro.html#tarea-1"><i class="fa fa-check"></i><b>2.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y visualización de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#el-principio-de-datos-limpios"><i class="fa fa-check"></i><b>3.1</b> El principio de datos limpios</a></li>
<li class="chapter" data-level="3.2" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#limpieza-de-datos"><i class="fa fa-check"></i><b>3.2</b> Limpieza de datos</a></li>
<li class="chapter" data-level="3.3" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#separa-aplica-combina"><i class="fa fa-check"></i><b>3.3</b> <em>Separa-aplica-combina</em></a></li>
<li class="chapter" data-level="3.4" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#muertes-por-armas-de-fuego-en-eua"><i class="fa fa-check"></i><b>3.4</b> Muertes por armas de fuego en EUA</a></li>
<li class="chapter" data-level="3.5" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#el-cuarteto-de-anscombe"><i class="fa fa-check"></i><b>3.5</b> El Cuarteto de Anscombe</a></li>
<li class="chapter" data-level="3.6" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#the-grammar-of-graphics-de-leland-wilkinson"><i class="fa fa-check"></i><b>3.6</b> The <em>Grammar of Graphics</em> de Leland Wilkinson</a></li>
<li class="chapter" data-level="3.7" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#ggplot"><i class="fa fa-check"></i><b>3.7</b> ggplot</a></li>
<li class="chapter" data-level="3.8" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#un-histograma-de-las-muertes-en-iraq"><i class="fa fa-check"></i><b>3.8</b> Un histograma de las muertes en Iraq</a></li>
<li class="chapter" data-level="3.9" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#inglehartwelzel-un-mapa-cultural-del-mundo"><i class="fa fa-check"></i><b>3.9</b> Inglehart–Welzel: un mapa cultural del mundo</a><ul>
<li class="chapter" data-level="3.9.1" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#creando-un-ggplot"><i class="fa fa-check"></i><b>3.9.1</b> Creando un ggplot</a></li>
<li class="chapter" data-level="3.9.2" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#mapeos-aesthetics"><i class="fa fa-check"></i><b>3.9.2</b> Mapeos: Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#poniendo-todo-junto"><i class="fa fa-check"></i><b>3.10</b> Poniendo todo junto</a></li>
<li class="chapter" data-level="3.11" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#tarea-2"><i class="fa fa-check"></i><b>3.11</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html"><i class="fa fa-check"></i><b>4</b> Teorema del Límite Central</a><ul>
<li class="chapter" data-level="4.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#la-distribucion-de-la-media"><i class="fa fa-check"></i><b>4.1</b> La distribución de la media</a></li>
<li class="chapter" data-level="4.2" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#de-donde-proviene-la-distribucion-normal"><i class="fa fa-check"></i><b>4.2</b> ¿De dónde proviene la distribución normal?</a><ul>
<li class="chapter" data-level="4.2.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#que-signo-tiene-c"><i class="fa fa-check"></i><b>4.2.1</b> ¿Qué signo tiene c?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#otras-observaciones"><i class="fa fa-check"></i><b>4.3</b> Otras observaciones</a></li>
<li class="chapter" data-level="4.4" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#diagramas-de-caja-y-brazos"><i class="fa fa-check"></i><b>4.4</b> Diagramas de caja y brazos</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-de-cuantiles-teoricos"><i class="fa fa-check"></i><b>4.5</b> Gráficas de cuantiles teóricos</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-normal"><i class="fa fa-check"></i>Ejemplo: normal</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-de-cuantiles-para-un-conjunto-de-datos"><i class="fa fa-check"></i><b>4.6</b> Gráficas de cuantiles para un conjunto de datos</a><ul>
<li class="chapter" data-level="4.6.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#que-buscar-en-una-grafica-de-cuantiles"><i class="fa fa-check"></i><b>4.6.1</b> ¿Qué buscar en una gráfica de cuantiles?</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-qq-normales"><i class="fa fa-check"></i><b>4.7</b> Gráficas qq-normales</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-cantantes"><i class="fa fa-check"></i>Ejemplo: cantantes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#el-tlc-y-errores-estandar"><i class="fa fa-check"></i><b>4.8</b> El TLC y errores estándar</a></li>
<li class="chapter" data-level="4.9" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-1"><i class="fa fa-check"></i><b>4.9</b> Ejemplo</a></li>
<li class="chapter" data-level="4.10" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#tarea-3"><i class="fa fa-check"></i><b>4.10</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html"><i class="fa fa-check"></i><b>5</b> Análisis de datos categóricos</a><ul>
<li class="chapter" data-level="5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#repaso-y-algunos-conceptos"><i class="fa fa-check"></i><b>5.1</b> Repaso y algunos conceptos</a><ul>
<li class="chapter" data-level="5.1.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#caso-binomial"><i class="fa fa-check"></i><b>5.1.1</b> Caso binomial</a></li>
<li class="chapter" data-level="" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#estimacion-de-parametros-multinomiales"><i class="fa fa-check"></i>Estimación de parámetros multinomiales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-chi2-de-pearson-de-una-multinomial"><i class="fa fa-check"></i><b>5.2</b> La <span class="math inline">\(\chi^2\)</span> de Pearson de una multinomial</a><ul>
<li class="chapter" data-level="5.2.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#cociente-de-verosimilitud-de-una-multinomial"><i class="fa fa-check"></i><b>5.2.1</b> Cociente de verosimilitud de una multinomial</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#definiciones"><i class="fa fa-check"></i><b>5.3</b> Definiciones</a><ul>
<li class="chapter" data-level="5.3.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#notacion"><i class="fa fa-check"></i><b>5.3.1</b> Notación</a></li>
<li class="chapter" data-level="5.3.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#razon-de-momios"><i class="fa fa-check"></i><b>5.3.2</b> Razón de momios</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#asociacion-en-tablas-de-tamano-itimes-j"><i class="fa fa-check"></i><b>5.4</b> Asociación en tablas de tamaño <span class="math inline">\(I\times J\)</span></a><ul>
<li class="chapter" data-level="5.4.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#razones-de-momios-en-tablas-itimes-j"><i class="fa fa-check"></i><b>5.4.1</b> Razones de momios en tablas <span class="math inline">\(I\times J\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-mushrooms"><i class="fa fa-check"></i><b>5.4.2</b> Ejemplo: mushrooms</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#intervalos-de-confianza-para-los-parametros-de-asociacion"><i class="fa fa-check"></i><b>5.5</b> Intervalos de confianza para los parámetros de asociación</a><ul>
<li class="chapter" data-level="5.5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#error-estandar-de-la-razon-de-momios"><i class="fa fa-check"></i><b>5.5.1</b> Error estándar de la razón de momios</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-de-independencia"><i class="fa fa-check"></i><b>5.6</b> Prueba de independencia</a><ul>
<li class="chapter" data-level="5.6.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-prueba-chi2-de-pearson"><i class="fa fa-check"></i><b>5.6.1</b> La prueba <span class="math inline">\(\chi^2\)</span> de Pearson</a></li>
<li class="chapter" data-level="5.6.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-brecha-de-genero"><i class="fa fa-check"></i><b>5.6.2</b> Ejemplo: brecha de género</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#general-social-survey-1972---2016"><i class="fa fa-check"></i><b>5.7</b> General Social Survey 1972 - 2016</a></li>
<li class="chapter" data-level="5.8" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-catadora-de-te"><i class="fa fa-check"></i><b>5.8</b> La catadora de té</a></li>
<li class="chapter" data-level="5.9" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-multinomiales-para-conteos"><i class="fa fa-check"></i><b>5.9</b> Modelos multinomiales para conteos</a></li>
<li class="chapter" data-level="5.10" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-log-lineales-con-tres-variables-categoricas"><i class="fa fa-check"></i><b>5.10</b> Modelos log lineales con tres variables categóricas</a><ul>
<li class="chapter" data-level="5.10.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tipos-de-independencia"><i class="fa fa-check"></i><b>5.10.1</b> Tipos de independencia</a></li>
<li class="chapter" data-level="5.10.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#asociacion-homogenea-e-interacciones-de-3-factores"><i class="fa fa-check"></i><b>5.10.2</b> Asociación homogénea e interacciones de 3 factores</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-sensitividad-y-especificidad"><i class="fa fa-check"></i><b>5.11</b> Ejemplo: sensitividad y especificidad</a></li>
<li class="chapter" data-level="5.12" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-horoscopos"><i class="fa fa-check"></i><b>5.12</b> Ejemplo: horóscopos</a></li>
<li class="chapter" data-level="5.13" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tarea-opcional"><i class="fa fa-check"></i><b>5.13</b> Tarea (opcional)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html"><i class="fa fa-check"></i><b>6</b> Regresión logística 1</a><ul>
<li class="chapter" data-level="6.1" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#regresion-logistica-con-un-solo-predictor"><i class="fa fa-check"></i><b>6.1</b> Regresión logística con un solo predictor</a></li>
<li class="chapter" data-level="6.2" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#el-modelo-de-regresion-logistica"><i class="fa fa-check"></i><b>6.2</b> El modelo de regresión logística</a><ul>
<li class="chapter" data-level="6.2.1" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#funcion-logistica"><i class="fa fa-check"></i><b>6.2.1</b> Función logística</a></li>
<li class="chapter" data-level="" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regresion-logistica-1.html"><a href="regresion-logistica-1.html#tarea-4"><i class="fa fa-check"></i><b>6.3</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html"><i class="fa fa-check"></i><b>7</b> Regresión logística 2</a><ul>
<li class="chapter" data-level="7.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#incertidumbre-en-la-estimacion"><i class="fa fa-check"></i><b>7.1</b> Incertidumbre en la estimación</a></li>
<li class="chapter" data-level="7.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#funcion-logistica-1"><i class="fa fa-check"></i><b>7.2</b> Función logística</a></li>
<li class="chapter" data-level="7.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes"><i class="fa fa-check"></i><b>7.3</b> Interpretación de los coeficientes</a><ul>
<li class="chapter" data-level="7.3.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#evaluar-en-o-alrededor-de-la-media"><i class="fa fa-check"></i><b>7.3.1</b> Evaluar en (o alrededor de) la media</a></li>
<li class="chapter" data-level="7.3.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#la-regla-de-dividir-entre-4"><i class="fa fa-check"></i><b>7.3.2</b> La regla de “dividir entre 4”</a></li>
<li class="chapter" data-level="7.3.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes-como-cocientes-de-momios"><i class="fa fa-check"></i><b>7.3.3</b> Interpretación de los coeficientes como cocientes de momios</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ejemplo-pozos-en-bangladesh"><i class="fa fa-check"></i><b>7.4</b> Ejemplo: pozos en Bangladesh</a><ul>
<li class="chapter" data-level="7.4.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#descripcion-del-problema"><i class="fa fa-check"></i><b>7.4.1</b> Descripción del problema</a></li>
<li class="chapter" data-level="7.4.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#antecedentes-del-problema"><i class="fa fa-check"></i><b>7.4.2</b> Antecedentes del problema</a></li>
<li class="chapter" data-level="7.4.3" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#metodologia-para-abordar-el-problema"><i class="fa fa-check"></i><b>7.4.3</b> Metodología para abordar el problema</a></li>
<li class="chapter" data-level="7.4.4" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ajuste-y-resultados-del-modelo"><i class="fa fa-check"></i><b>7.4.4</b> Ajuste y resultados del modelo</a></li>
<li class="chapter" data-level="7.4.5" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#interpretacion-de-los-coeficientes-1"><i class="fa fa-check"></i><b>7.4.5</b> Interpretación de los coeficientes</a></li>
<li class="chapter" data-level="7.4.6" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#agregamos-una-segunda-variable-de-entrada"><i class="fa fa-check"></i><b>7.4.6</b> Agregamos una segunda variable de entrada</a></li>
<li class="chapter" data-level="7.4.7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#comparacion-de-coeficientes-cuando-anades-un-predictor"><i class="fa fa-check"></i><b>7.4.7</b> Comparación de coeficientes cuando añades un predictor</a></li>
<li class="chapter" data-level="7.4.8" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#graficar-el-modelo-ajustado-con-dos-predictores"><i class="fa fa-check"></i><b>7.4.8</b> Graficar el modelo ajustado con dos predictores</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ajuste-de-coeficientes-para-regresion-logistica-binomial."><i class="fa fa-check"></i><b>7.5</b> Ajuste de coeficientes para regresión logística (binomial).</a></li>
<li class="chapter" data-level="7.6" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#descenso-en-gradiente"><i class="fa fa-check"></i><b>7.6</b> Descenso en gradiente</a><ul>
<li class="chapter" data-level="7.6.1" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#seleccion-de-tamano-de-paso-eta"><i class="fa fa-check"></i><b>7.6.1</b> Selección de tamaño de paso <span class="math inline">\(\eta\)</span></a></li>
<li class="chapter" data-level="7.6.2" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#funciones-de-varias-variables"><i class="fa fa-check"></i><b>7.6.2</b> Funciones de varias variables</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#ejemplo-diabetes"><i class="fa fa-check"></i><b>7.7</b> Ejemplo: diabetes</a></li>
<li class="chapter" data-level="7.8" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#observaciones-adicionales"><i class="fa fa-check"></i><b>7.8</b> Observaciones adicionales</a></li>
<li class="chapter" data-level="7.9" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#regresion-logistica-para-problemas-de-mas-de-2-clases"><i class="fa fa-check"></i><b>7.9</b> Regresión logística para problemas de más de 2 clases</a></li>
<li class="chapter" data-level="7.10" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#regresion-logistica-multinomial"><i class="fa fa-check"></i><b>7.10</b> Regresión logística multinomial</a></li>
<li class="chapter" data-level="7.11" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#identificabilidad-y-separacion"><i class="fa fa-check"></i><b>7.11</b> Identificabilidad y separación</a></li>
<li class="chapter" data-level="7.12" data-path="regresion-logistica-2.html"><a href="regresion-logistica-2.html#tarea-5"><i class="fa fa-check"></i><b>7.12</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html"><i class="fa fa-check"></i><b>8</b> Regresión logística 3</a><ul>
<li class="chapter" data-level="8.1" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#ejemplo-oscares"><i class="fa fa-check"></i><b>8.1</b> Ejemplo óscares</a></li>
<li class="chapter" data-level="8.2" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#repaso-de-regresion-logistica"><i class="fa fa-check"></i><b>8.2</b> Repaso de regresión logística</a></li>
<li class="chapter" data-level="8.3" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#regresion-logistica-con-interacciones"><i class="fa fa-check"></i><b>8.3</b> Regresión logística con interacciones</a></li>
<li class="chapter" data-level="8.4" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#graficas-del-modelo-con-interacciones"><i class="fa fa-check"></i><b>8.4</b> Gráficas del modelo con interacciones</a></li>
<li class="chapter" data-level="8.5" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#agregar-mas-predictores"><i class="fa fa-check"></i><b>8.5</b> Agregar más predictores</a></li>
<li class="chapter" data-level="8.6" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#evaluacion-de-modelos-de-regresion-logistica"><i class="fa fa-check"></i><b>8.6</b> Evaluación de modelos de regresión logística</a><ul>
<li class="chapter" data-level="8.6.1" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#graficas-de-residuales-agrupados-vs-predictores"><i class="fa fa-check"></i><b>8.6.1</b> Gráficas de residuales agrupados vs predictores</a></li>
<li class="chapter" data-level="8.6.2" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#transformaciones"><i class="fa fa-check"></i><b>8.6.2</b> Transformaciones</a></li>
<li class="chapter" data-level="8.6.3" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#tasa-de-error-y-comparacion-contra-el-modelo-nulo"><i class="fa fa-check"></i><b>8.6.3</b> Tasa de error y comparación contra el modelo nulo</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#diferencias-predictivas-promedio-en-la-escala-de-probabilidad"><i class="fa fa-check"></i><b>8.7</b> Diferencias predictivas promedio en la escala de probabilidad</a><ul>
<li class="chapter" data-level="" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#diferencias-predictivas-promedio-en-presencia-de-interacciones"><i class="fa fa-check"></i>Diferencias predictivas promedio en presencia de interacciones</a></li>
<li class="chapter" data-level="" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#notacion-general-para-diferencias-predictivas"><i class="fa fa-check"></i>Notación general para diferencias predictivas</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="regresion-logistica-3.html"><a href="regresion-logistica-3.html#tarea-6"><i class="fa fa-check"></i><b>8.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="regularizacion.html"><a href="regularizacion.html"><i class="fa fa-check"></i><b>9</b> Regularización</a><ul>
<li class="chapter" data-level="9.1" data-path="regularizacion.html"><a href="regularizacion.html#repaso"><i class="fa fa-check"></i><b>9.1</b> Repaso</a></li>
<li class="chapter" data-level="9.2" data-path="regularizacion.html"><a href="regularizacion.html#otras-medidas-de-clasificacion"><i class="fa fa-check"></i><b>9.2</b> Otras medidas de clasificación</a></li>
<li class="chapter" data-level="9.3" data-path="regularizacion.html"><a href="regularizacion.html#analisis-de-error-en-clasificacion-binaria"><i class="fa fa-check"></i><b>9.3</b> Análisis de error en clasificación binaria</a><ul>
<li class="chapter" data-level="9.3.1" data-path="regularizacion.html"><a href="regularizacion.html#punto-de-corte-para-un-clasificador-binario"><i class="fa fa-check"></i><b>9.3.1</b> Punto de corte para un clasificador binario</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="regularizacion.html"><a href="regularizacion.html#curvas-roc"><i class="fa fa-check"></i><b>9.4</b> Curvas ROC</a><ul>
<li class="chapter" data-level="9.4.1" data-path="regularizacion.html"><a href="regularizacion.html#espacio-roc"><i class="fa fa-check"></i><b>9.4.1</b> Espacio ROC</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-1"><i class="fa fa-check"></i><b>9.5</b> Regularización</a><ul>
<li class="chapter" data-level="9.5.1" data-path="regularizacion.html"><a href="regularizacion.html#reduciendo-varianza-de-los-coeficientes"><i class="fa fa-check"></i><b>9.5.1</b> Reduciendo varianza de los coeficientes</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-ridge"><i class="fa fa-check"></i><b>9.6</b> Regularización Ridge</a><ul>
<li class="chapter" data-level="9.6.1" data-path="regularizacion.html"><a href="regularizacion.html#seleccion-de-coeficiente-de-regularizacion"><i class="fa fa-check"></i><b>9.6.1</b> Selección de coeficiente de regularización</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="regularizacion.html"><a href="regularizacion.html#regularizacion-lasso"><i class="fa fa-check"></i><b>9.7</b> Regularización Lasso</a></li>
<li class="chapter" data-level="9.8" data-path="regularizacion.html"><a href="regularizacion.html#tarea-7"><i class="fa fa-check"></i><b>9.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html"><i class="fa fa-check"></i><b>10</b> Modelos lineales generalizados</a><ul>
<li class="chapter" data-level="10.1" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#regresion-lineal-y-logistica"><i class="fa fa-check"></i><b>10.1</b> Regresión lineal y logística</a></li>
<li class="chapter" data-level="10.2" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#otros-modelos"><i class="fa fa-check"></i><b>10.2</b> Otros modelos</a></li>
<li class="chapter" data-level="10.3" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-accidentes-de-trafico"><i class="fa fa-check"></i><b>10.3</b> Ejemplo: accidentes de tráfico</a></li>
<li class="chapter" data-level="10.4" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#interpretacion-de-coeficientes-poisson"><i class="fa fa-check"></i><b>10.4</b> Interpretación de coeficientes Poisson</a></li>
<li class="chapter" data-level="10.5" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#diferencias-entre-el-modelo-binomial-y-poisson"><i class="fa fa-check"></i><b>10.5</b> Diferencias entre el modelo binomial y Poisson</a></li>
<li class="chapter" data-level="10.6" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-fertilidad-en-fiji"><i class="fa fa-check"></i><b>10.6</b> Ejemplo: fertilidad en Fiji</a></li>
<li class="chapter" data-level="10.7" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#variable-de-expuestos-offset"><i class="fa fa-check"></i><b>10.7</b> Variable de expuestos (offset)</a></li>
<li class="chapter" data-level="10.8" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplos-seguros"><i class="fa fa-check"></i><b>10.8</b> Ejemplos: seguros</a><ul>
<li class="chapter" data-level="" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#numero-de-expuestos-interpretacion"><i class="fa fa-check"></i>Número de expuestos (interpretación)</a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-arboles"><i class="fa fa-check"></i><b>10.9</b> Ejemplo: árboles</a></li>
<li class="chapter" data-level="10.10" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#sobredispersion"><i class="fa fa-check"></i><b>10.10</b> Sobredispersión</a></li>
<li class="chapter" data-level="10.11" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#ejemplo-numero-de-publicaciones"><i class="fa fa-check"></i><b>10.11</b> Ejemplo: número de publicaciones</a></li>
<li class="chapter" data-level="10.12" data-path="modelos-lineales-generalizados.html"><a href="modelos-lineales-generalizados.html#tarea-8"><i class="fa fa-check"></i><b>10.12</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html"><i class="fa fa-check"></i><b>11</b> Discriminante Lineal (LDA) 1</a><ul>
<li class="chapter" data-level="11.1" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#problemas-de-clasificacion"><i class="fa fa-check"></i><b>11.1</b> Problemas de clasificación</a></li>
<li class="chapter" data-level="11.2" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#funciones-de-discriminante"><i class="fa fa-check"></i><b>11.2</b> Funciones de discriminante</a></li>
<li class="chapter" data-level="11.3" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#regresion-lineal-en-una-matriz-indicadora"><i class="fa fa-check"></i><b>11.3</b> Regresión lineal en una matriz indicadora</a></li>
<li class="chapter" data-level="11.4" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#discriminante-lineal-de-fisher"><i class="fa fa-check"></i><b>11.4</b> Discriminante lineal de Fisher</a><ul>
<li class="chapter" data-level="11.4.1" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#ejemplo-separacion-entre-clases"><i class="fa fa-check"></i><b>11.4.1</b> Ejemplo: separación entre clases</a></li>
<li class="chapter" data-level="11.4.2" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#ejemplo-iris-de-fisher"><i class="fa fa-check"></i><b>11.4.2</b> Ejemplo: iris de Fisher</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="discriminante-lineal-lda-1.html"><a href="discriminante-lineal-lda-1.html#tarea-9"><i class="fa fa-check"></i><b>11.5</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html"><i class="fa fa-check"></i><b>12</b> Discriminante Lineal (LDA) 2</a><ul>
<li class="chapter" data-level="12.1" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#aplicaciones"><i class="fa fa-check"></i><b>12.1</b> Aplicaciones</a></li>
<li class="chapter" data-level="12.2" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#ejemplo-vinos"><i class="fa fa-check"></i><b>12.2</b> Ejemplo: vinos</a></li>
<li class="chapter" data-level="12.3" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#ejemplo-admisiones-al-mba"><i class="fa fa-check"></i><b>12.3</b> Ejemplo: admisiones al MBA</a></li>
<li class="chapter" data-level="12.4" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#repaso-1"><i class="fa fa-check"></i><b>12.4</b> Repaso</a><ul>
<li><a href="discriminante-lineal-lda-2.html#caso-k2">Caso <span class="math inline">\(k=2\)</span></a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#supuestos-probabilisticos"><i class="fa fa-check"></i><b>12.5</b> Supuestos probabilísticos</a></li>
<li class="chapter" data-level="12.6" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#relacion-con-minimos-cuadrados"><i class="fa fa-check"></i><b>12.6</b> Relación con mínimos cuadrados</a></li>
<li class="chapter" data-level="12.7" data-path="discriminante-lineal-lda-2.html"><a href="discriminante-lineal-lda-2.html#tarea-10"><i class="fa fa-check"></i><b>12.7</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html"><i class="fa fa-check"></i><b>13</b> Componentes Principales 1</a><ul>
<li class="chapter" data-level="13.1" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#motivacion"><i class="fa fa-check"></i><b>13.1</b> Motivación</a></li>
<li class="chapter" data-level="13.2" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#formulacion-de-maxima-varianza"><i class="fa fa-check"></i><b>13.2</b> Formulación de máxima varianza</a></li>
<li class="chapter" data-level="13.3" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#formulacion-de-error-minimo"><i class="fa fa-check"></i><b>13.3</b> Formulación de error mínimo</a></li>
<li class="chapter" data-level="13.4" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#aplicaciones-de-pca"><i class="fa fa-check"></i><b>13.4</b> Aplicaciones de PCA</a><ul>
<li class="chapter" data-level="13.4.1" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#compresion-de-datos"><i class="fa fa-check"></i><b>13.4.1</b> Compresión de datos</a></li>
<li class="chapter" data-level="13.4.2" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#ejemplo-compresion-de-una-imagen"><i class="fa fa-check"></i><b>13.4.2</b> Ejemplo: compresión de una imagen</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="componentes-principales-1.html"><a href="componentes-principales-1.html#tarea-11"><i class="fa fa-check"></i><b>13.5</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html"><i class="fa fa-check"></i><b>14</b> Componentes Principales 2</a><ul>
<li class="chapter" data-level="14.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#pca-probabilistico-y-analisis-de-factores"><i class="fa fa-check"></i><b>14.1</b> PCA probabilístico y Análisis de Factores</a><ul>
<li class="chapter" data-level="14.1.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores"><i class="fa fa-check"></i><b>14.1.1</b> Análisis de factores</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores-descripcion-tradicional"><i class="fa fa-check"></i><b>14.2</b> Análisis de factores (descripción tradicional)</a><ul>
<li class="chapter" data-level="14.2.1" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#el-modelo"><i class="fa fa-check"></i><b>14.2.1</b> El modelo</a></li>
<li class="chapter" data-level="14.2.2" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#estimacion-del-modelo"><i class="fa fa-check"></i><b>14.2.2</b> Estimación del modelo</a></li>
<li class="chapter" data-level="14.2.3" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#analisis-de-factores-de-maxima-verosimilitud"><i class="fa fa-check"></i><b>14.2.3</b> Análisis de factores de máxima verosimilitud</a></li>
<li class="chapter" data-level="14.2.4" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#evaluacion-del-modelo"><i class="fa fa-check"></i><b>14.2.4</b> Evaluación del modelo</a></li>
<li class="chapter" data-level="14.2.5" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#visualizacion"><i class="fa fa-check"></i><b>14.2.5</b> Visualización</a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="componentes-principales-2.html"><a href="componentes-principales-2.html#tarea-12"><i class="fa fa-check"></i><b>14.3</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html"><i class="fa fa-check"></i><b>15</b> Correlación Canónica (CCA)</a><ul>
<li class="chapter" data-level="15.1" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#cca-vs-pca"><i class="fa fa-check"></i><b>15.1</b> CCA vs PCA</a></li>
<li class="chapter" data-level="15.2" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#variables-y-correlaciones-canonicas"><i class="fa fa-check"></i><b>15.2</b> Variables y correlaciones canónicas</a><ul>
<li class="chapter" data-level="15.2.1" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#combinaciones-lineaes-de-factores"><i class="fa fa-check"></i><b>15.2.1</b> Combinaciones lineaes de factores</a></li>
<li class="chapter" data-level="15.2.2" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#ejemplo-simple"><i class="fa fa-check"></i><b>15.2.2</b> Ejemplo simple</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#ejemplo-test-psicologico"><i class="fa fa-check"></i><b>15.3</b> Ejemplo: test psicológico</a></li>
<li class="chapter" data-level="15.4" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#ejemplo-fenomenos-meteorologicos"><i class="fa fa-check"></i><b>15.4</b> Ejemplo: fenómenos meteorológicos</a></li>
<li class="chapter" data-level="15.5" data-path="correlacion-canonica-cca.html"><a href="correlacion-canonica-cca.html#tarea-13"><i class="fa fa-check"></i><b>15.5</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html"><i class="fa fa-check"></i><b>16</b> Conglomerados (clustering) 1</a><ul>
<li class="chapter" data-level="16.1" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#introduccion"><i class="fa fa-check"></i><b>16.1</b> Introducción</a><ul>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="16.2" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#enfoques-combinatorio-y-basado-en-modelos."><i class="fa fa-check"></i><b>16.2</b> Enfoques: combinatorio y basado en modelos.</a></li>
<li class="chapter" data-level="16.3" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#k-medias"><i class="fa fa-check"></i><b>16.3</b> K-medias</a><ul>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#algoritmo-de-k-medias"><i class="fa fa-check"></i>Algoritmo de k-medias</a></li>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
<li><a href="conglomerados-clustering-1.html#usando-la-funcion-kmeans">Usando la funcion <code>kmeans</code></a></li>
</ul></li>
<li class="chapter" data-level="16.4" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#seleccion-de-numero-de-clusters."><i class="fa fa-check"></i><b>16.4</b> Selección de número de clusters.</a><ul>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#variacion-dentro-de-clusters-para-distintas-soluciones"><i class="fa fa-check"></i>Variación dentro de clusters para distintas soluciones</a></li>
<li class="chapter" data-level="16.4.1" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#criterios-especificos"><i class="fa fa-check"></i><b>16.4.1</b> Criterios específicos</a></li>
</ul></li>
<li class="chapter" data-level="16.5" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#dificultades-en-segmentacionclustering."><i class="fa fa-check"></i><b>16.5</b> Dificultades en segmentación/clustering.</a><ul>
<li class="chapter" data-level="16.5.1" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#estructuras-no-compactas"><i class="fa fa-check"></i><b>16.5.1</b> Estructuras no compactas</a></li>
<li class="chapter" data-level="16.5.2" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#existencia-o-no-de-grupos-naturales"><i class="fa fa-check"></i><b>16.5.2</b> Existencia o no de grupos “naturales”</a></li>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#grupos-en-dimension-alta"><i class="fa fa-check"></i>Grupos en dimensión alta</a></li>
<li class="chapter" data-level="" data-path="conglomerados-clustering-1.html"><a href="conglomerados-clustering-1.html#dificultades-en-la-seleccion-de-metrica"><i class="fa fa-check"></i>Dificultades en la selección de métrica</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="17" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html"><i class="fa fa-check"></i><b>17</b> Conglomerados (clustering) 2</a><ul>
<li class="chapter" data-level="17.1" data-path="conglomerados-clustering-2.html"><a href="conglomerados-clustering-2.html#clustering-jerarquico"><i class="fa fa-check"></i><b>17.1</b> Clustering jerárquico</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Aplicada III</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="correlacion-canonica-cca" class="section level1">
<h1><span class="header-section-number">Clase 15</span> Correlación Canónica (CCA)</h1>
<style>
  .espacio {
    margin-bottom: 1cm;
  }
</style>
<style>
  .espacio3 {
    margin-bottom: 3cm;
  }
</style>
<p class="espacio">
</p>
<div id="cca-vs-pca" class="section level2">
<h2><span class="header-section-number">15.1</span> CCA vs PCA</h2>
<p class="espacio3">
</p>

<div class="nota">
<ul>
<li><p>Anteriormente, estudiamos los métodos analíticos de factores como un enfoque para comprender las fuentes clave de variación <em>dentro</em> de conjuntos de variables.</p></li>
<li><p>Hay situaciones en las que tenemos varios conjuntos de variables, y buscamos una comprensión de las dimensiones clave que se correlacionan <em>entre</em> conjuntos.</p></li>
<li>El análisis de correlación canónica es uno de los métodos más antiguos y mejor conocidos para descubrir y explorar dimensiones que están correlacionadas <em>entre</em> conjuntos, pero no están correlacionadas <em>dentro</em> del conjunto.
</div>
</li>
</ul>
<p class="espacio3">
</p>
<p>El análisis de correlación canónica se concentra en la correlación entre una <em>combinación lineal</em> de variables en un conjunto y la <em>combinación lineal</em> de variables en otro conjunto. La idea es determinar primero el par de combinaciones lineales que tienen la combinación lineal más grande. Después, el par de combinaciones lineales que tienen correlación más grande entre todos los pares que no están correlacionados con el primero, y así sucesivamente.</p>
<p>A los pares de combinaciones lineales se les llama <em>variables canónicas</em> y a sus correlaciones se les llama <em>correlaciones canónicas</em>.</p>
<p>Las correlaciones canónicas miden qué tan fuerte es la asociación entre dos conjuntos de variables.</p>
</div>
<div id="variables-y-correlaciones-canonicas" class="section level2">
<h2><span class="header-section-number">15.2</span> Variables y correlaciones canónicas</h2>
<p>Nos interesa medir la asociación entre <em>dos</em> grupos de variables:</p>
<ul>
<li><p>El primer grupo (de <span class="math inline">\(p\)</span> variables) está representado por vector aleatorio <span class="math inline">\(X^{(1)}\)</span></p></li>
<li><p>El segundo grupo (de <span class="math inline">\(q\)</span> variables) está representado por otro vector aleatorio <span class="math inline">\(X^{(2)}\)</span></p></li>
</ul>
<p>Suponemos en lo que sigue que <span class="math inline">\(p \leq q\)</span>.</p>
<p>Para los vectores aleatorios <span class="math inline">\(X^{(1)}\)</span> y <span class="math inline">\(X^{(2)}\)</span> sea</p>
<p><span class="math display">\[
E(X^{(1)}) = \mu^{(1)},\qquad \mbox{Var}(X^{(1)}) = \Sigma_{11}
\]</span></p>
<p><span class="math display">\[
E(X^{(2)}) = \mu^{(2)},\qquad \mbox{Var}(X^{(2)}) = \Sigma_{22}
\]</span></p>
<p><span class="math display">\[
\mbox{Cov}\left(X^{(1)},X^{(2)}\right) = \Sigma_{12} = \Sigma_{21}
\]</span></p>
<p>Ponemos</p>
<p><span class="math display">\[
X = \left(X^{(1)}, X^{(2)}\right)
\]</span></p>
<p>con vector de media</p>
<p><span class="math display">\[
\mu = (\mu^{(1)},\mu^{(2)})
\]</span></p>
<p>y matriz de covarianzas</p>
<p><span class="math display">\[
\Sigma = \left[
\begin{array}{c|c}
\Sigma_{11} &amp; \Sigma_{12} \\
\hline
\Sigma_{21} &amp; \Sigma_{22}
\end{array}
\right]
\]</span></p>
<p class="espacio">
</p>

<div class="nota">
<p>Observaciones:</p>
<ul>
<li><p>Las correlaciones entre pares de variables, una de <span class="math inline">\(X^{(1)}\)</span> y la otra de <span class="math inline">\(X^{(2)}\)</span> está contenidas en la matriz <span class="math inline">\(\Sigma_{12}\)</span>.</p></li>
<li><p><span class="math inline">\(\Sigma_{12}\)</span> es de dimensión <span class="math inline">\(pq\)</span>. Si <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> son grandes, la interpretación de <span class="math inline">\(\Sigma_{12}\)</span> puede ser muy complicada. En este caso, es usual interpretar más fácilmente combinaciones lineales de las variables de cada grupo.</p></li>
<li>La tarea principal del <em>análisis canónico</em> es resumir la asociación entre <span class="math inline">\(X^{(1)}\)</span> y <span class="math inline">\(X^{(2)}\)</span>.
</div>
</li>
</ul>
<p class="espacio">
</p>
<div id="combinaciones-lineaes-de-factores" class="section level3">
<h3><span class="header-section-number">15.2.1</span> Combinaciones lineaes de factores</h3>
<p>Las combinaciones lineales proveen de interpretación a conjuntos de variables. Sea</p>
<p><span class="math display">\[
\begin{eqnarray*}
U &amp;=&amp; a^T X^{(1)} \\
V &amp;=&amp; b^T X^{(2)}
\end{eqnarray*}
\]</span></p>
<p>para un par de vectores <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span>. Por lo tanto,</p>
<p><span class="math display">\[
\mbox{Var}(U) = a^T \mbox{Var}(X^{(1)}) a = a^T\Sigma_{11}a
\]</span></p>
<p><span class="math display">\[
\mbox{Var}(V) = b^T \mbox{Var}(X^{(2)}) b = b^T\Sigma_{22}b
\]</span></p>
<p><span class="math display">\[
\mbox{Cov}(U,V) = a^T \mbox{Cov}\left(X^{(1)},X^{(2)}\right) b = a^T\Sigma_{12}b.
\]</span></p>
<p>Buscamos coeficientes de los vectores <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> tales que:</p>
<p><span class="math display">\[
\mbox{Corr}(U,V) = \dfrac{a^T\Sigma_{12}b}{\sqrt{a^T\Sigma_{11}a}\sqrt{b^T\Sigma_{22}b}}.
\]</span></p>
<p>Sea <span class="math inline">\(k\)</span> entre <span class="math inline">\(1\)</span> y <span class="math inline">\(p\leq q\)</span>, entonces al <span class="math inline">\(k\)</span>-ésimo par de combinaciones lineales <span class="math inline">\(U_k\)</span> y <span class="math inline">\(V_kl\)</span> con varianzas unitarias y que maximizan la correlación entre las opciones que no estén correlacionadas con las anteriores, se les llama <em><span class="math inline">\(k\)</span>-ésimo par de variables canónicas</em>.</p>
<p class="espacio3">
</p>

<div class="nota">
<p>Suponemos que <span class="math inline">\(\Sigma_{12}\)</span> es de rango completo, entonces</p>
<p><span class="math display">\[
\max_{u,v}\mbox{Corr}(U,V) = \rho_1^*,
\]</span></p>
<p>se alcanza en las combinaciones lineales (primer par canónico):</p>
<p><span class="math display">\[
U_{1}=\underbrace{e_{1}^{T}\Sigma_{11}^{-1}}_{a_{1}^{T}}X^{(1)}, \qquad \mbox{ y } \qquad V_{1}=\underbrace{f_{1}^{T}\Sigma_{22}^{-1}}_{b_{1}^{T}}X^{(2)} 
\]</span></p>
<p>donde <span class="math inline">\(\mbox{Var}\left(X_i^{(1)}\right) = \sigma_{ii}\)</span> para <span class="math inline">\(i=1,2,\ldots,p\)</span>.</p>
<p>El <span class="math inline">\(k\)</span>-ésimo par de variables canónicas <span class="math inline">\(k=2,3,\ldots,p\)</span>,</p>
<p><span class="math display">\[
U_k = e_k^T\Sigma_{11}^{-1/2}X^{(1)},\qquad V_k = f_k^T\Sigma_{22}^{-1/2}X^{(2)}
\]</span></p>
<p>maximiza</p>
<p><span class="math display">\[
\mbox{Corr}(U_k,V_k)=\rho_k^*
\]</span></p>
entre las combinaciones lineales que no están correlacionadas con las variables canónicas precedentes de <span class="math inline">\(1,2,\ldots,k-1\)</span>.
</div>

<p class="espacio3">
</p>
<p>Aquí <span class="math inline">\({\rho_1^*}^2 \geq {\rho_2^*}^2 \geq \cdots \geq {\rho_p^*}^2\)</span> son los eigenvalores de</p>
<p><span class="math display">\[
\Sigma_{11}^{-1/2} \Sigma_{12} \Sigma_{22}^{-1} \Sigma_{21} \Sigma_{11}^{-1/2},
\]</span></p>
<p>y <span class="math inline">\(e_1,e_2,\ldots,e_p\)</span> son los eigenvectores asociados.</p>
<p>De la misma forma <span class="math inline">\({\rho_1^*}^2,{\rho_2^*}^2,\ldots,{\rho_p^*}^2\)</span> son los eigenvalores asociados a los <span class="math inline">\(p\)</span> eigenvectores de dimensión <span class="math inline">\(q\)</span>, <span class="math inline">\(f_1,f_2,\ldots,f_p\)</span>, de la matriz</p>
<p><span class="math display">\[
\Sigma_{22}^{-1/2} \Sigma_{21} \Sigma_{11}^{-1} \Sigma_{12} \Sigma_{22}^{-1/2}.
\]</span></p>
<p class="espacio">
</p>

<div class="information">
<p><strong>Propiedades:</strong> Para <span class="math inline">\(k,\,l = 1,2,\ldots,p\)</span>:</p>
<p class="espacio">
</p>
<ul>
<li><p><span class="math inline">\(\mbox{Var}(U_k) = \mbox{Var}(V_k)\)</span> = 1</p></li>
<li><p><span class="math inline">\(\mbox{Cov}(U_k,U_l) = \mbox{Corr}(U_k,U_l) = 0 \quad k\neq l\)</span></p></li>
<li><p><span class="math inline">\(\mbox{Cov}(V_k,V_l) = \mbox{Corr}(V_k,V_l) = 0 \quad k\neq l\)</span></p></li>
<li><span class="math inline">\(\mbox{Cov}(U_k,V_l) = \mbox{Corr}(U_k,V_l) = 0 \quad k\neq l\)</span>
</div>
</li>
</ul>
<p><br></p>
<p>Si las variables originales están estandarizadas <span class="math inline">\(Z^{(1)}=\left(Z^{(1)}_1,\ldots,Z^{(1)}_p\right)\)</span> entonces</p>
<p><span class="math display">\[
U_k = a_k^T Z^{(1)} = e_k^T \rho_{11}^{-1} Z^{(1)}
\]</span> <span class="math display">\[
V_k = b_k^T Z^{(2)} = f_k^T \rho_{22}^{-1} Z^{(2)}
\]</span></p>
<p>Aquí sucede que <span class="math inline">\(\mbox{Cov}(Z^{(1)}) = \rho_{11}\)</span>, es decir, la covarianza de <span class="math inline">\(Z^{(1)}\)</span> la representamos como matriz de correlaciones utilizando la letra <span class="math inline">\(\rho\)</span>, y de forma similar, <span class="math inline">\(\mbox{Cov}(Z^{(2)}) = \rho_{22}\)</span>.</p>
<p>Además se puede ver que:</p>
<p><span class="math display">\[
\mbox{Corr}(U_k,V_k) = \rho_k^*, \quad k=1,2,\ldots,p
\]</span></p>
<p>donde <span class="math inline">\({\rho_1^*}^2\geq{\rho_2^*}^2\geq\ldots\geq{\rho_p^*}^2\)</span> son los eigenvalores de la matriz</p>
<p><span class="math display">\[
\rho_{11}^{-1/2}\rho_{12}\rho_{22}^{-1}\rho_{21}\rho_{11}^{-1/2}
\]</span></p>
<p><br></p>
<hr />
<p>Notemos que:</p>
<p><span class="math display">\[
\begin{eqnarray*}
a_k^T(X^{(1)}-\mu^{(1)}) &amp;=&amp; a_{k1}(X_1^{(1)}-\mu_1^{(1)}) + \cdots+a_{kp}(X_p^{(1)}-\mu_p^{(1)})\\
&amp;=&amp; a_{k1}\sqrt{\sigma_{11}}\dfrac{(X_1^{(1)}-\mu_1^{(1)})}{\sqrt{\sigma_{11}}} + \cdots+a_{kp}\sqrt{\sigma_{pp}}\dfrac{(X_p^{(1)}-\mu_p^{(1)})}{\sqrt{\sigma_{pp}}}.
\end{eqnarray*}
\]</span></p>
<p>Por lo tanto, los coeficientes canónicos de las variables estandarizadas</p>
<p><span class="math display">\[
Z_i ^{(1)} = \dfrac{X_i^{(1)}- \mu_i^{(1)}}{\sqrt{\sigma_{ii}}}
\]</span></p>
<p>están relacionados simplemente con los coeficientes canónicos de la variable original <span class="math inline">\(X_i^{(1)}\)</span>. Más específicamente, si <span class="math inline">\(a_k\)</span> es el vector de coeficientes de la <span class="math inline">\(k\)</span>-ésima variable canónica <span class="math inline">\(U_k\)</span>, entonces</p>
<p><span class="math display">\[
a_k^TV_{11}^{1/2}
\]</span></p>
<p>es el vector de coeficientes de la <span class="math inline">\(k\)</span>-ésima variable canónica de las variables estandarizadas <span class="math inline">\(Z^{(1)}\)</span>. Aquí <span class="math inline">\(V_{11}^{1/2}\)</span> es la matriz diagonal con <span class="math inline">\(i\)</span>-ésimo elemento <span class="math inline">\(\sqrt{\sigma_{ii}}\)</span>.</p>
<p class="espacio3">
</p>
</div>
<p><br></p>
<img src="figuras/manicule2.jpg" />
<div class="centered">
<p class="espacio">
</p>
<p>Al estandarizar las variables <span class="math inline">\(X^{(1)}\)</span> y <span class="math inline">\(X^{(2)}\)</span> y realizar análisis de correlación canónica sobre <span class="math inline">\(Z^{(1)}\)</span> y <span class="math inline">\(Z^{(2)}\)</span>, las correlaciones canónicas</p>
<ol style="list-style-type: lower-alpha">
<li><p>Se multiplican por un factor de <span class="math inline">\(\sqrt{\sigma_{ii}}\)</span>.</p></li>
<li><p>No cambian.</p></li>
<li><p>Deben sumar <span class="math inline">\(1\)</span>.</p></li>
<li><p>Ninguna de las anteriores.</p></li>
</ol>
<p class="espacio3">
</p>
</div>
<p><br></p>
<hr />
</div>
<div id="ejemplo-simple" class="section level3">
<h3><span class="header-section-number">15.2.2</span> Ejemplo simple</h3>
<p><span class="math display">\[
X=\begin{pmatrix}
1 &amp; 1 &amp; 3 \\
2 &amp; 3 &amp; 2 \\
1 &amp; 1 &amp; 1 \\
1 &amp; 1 &amp; 2 \\
2 &amp; 2 &amp; 3 \\
3 &amp; 3 &amp; 2 \\
1 &amp; 3 &amp; 2 \\
4 &amp; 3 &amp; 5 \\
5 &amp; 5 &amp; 5 
\end{pmatrix}, \qquad Y= \left(\begin{array}{rrr}
4 &amp; 4 &amp; −1.07846 \\
3 &amp; 3 &amp; 1.214359 \\
2 &amp; 2 &amp; 0.307180 \\
2 &amp; 3 &amp; −0.385641 \\
2 &amp; 1 &amp; −0.078461 \\
1 &amp; 1 &amp; 1.61436 \\
1 &amp; 2 &amp; 0.814359 \\
2 &amp; 1 &amp; -0.0641016 \\
1 &amp; 2 &amp; 1.5359 \\
\end{array}\right)
\]</span></p>
<p>En este ejemplo, construimos la tercera columna de <span class="math inline">\(Y\)</span> de las columnas de <span class="math inline">\(X\)</span> con los pesos lineales <span class="math inline">\(a\)</span> = <span class="math inline">\((0.4, 0.6, -\sqrt{0.48})\)</span>.</p>
<p>Algunas preguntas:</p>
<ul>
<li><p>¿Cuál debería ser el primer vector de pesos canónicos para las variables <span class="math inline">\(Y\)</span>?</p></li>
<li><p>¿Cuál debería ser la primera correlación canónica?</p></li>
</ul>
<p>Respuestas:</p>
<ul>
<li><p>El propósito del análisis de correlación canónica es (a) buscar y (b) caracterizar la redundancia lineal entre ambos conjuntos de variables.</p></li>
<li><p>En nuestro ejemplo simple, una de las variables en <span class="math inline">\(Y\)</span> se puede reproducir exactamente como una combinación lineal de las tres variables en X.</p></li>
<li><p>El análisis de correlación canónica (si funciona correctamente) simplemente seleccionará <span class="math inline">\(y_3\)</span> como la primera variable canónica en el conjunto <span class="math inline">\(Y\)</span>, con pesos canónicos <span class="math inline">\(b = (0,0,1)\)</span>, y recupera la combinación lineal de las variables del primer grupo utilizada para generar <span class="math inline">\(y_3\)</span>, generando <span class="math inline">\(a = (0.4, 0.6, -\sqrt{0.48})\)</span> como los pesos canónicos para el conjunto <span class="math inline">\(X\)</span>.</p></li>
<li><p>La primera correlación canónica será, por supuesto, 1.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>( <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,
    <span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">2</span>,
    <span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">5</span>),<span class="dv">9</span>,<span class="dv">3</span>,<span class="dt">byrow=</span>T)

Y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>( <span class="dv">4</span>,<span class="dv">4</span>,<span class="op">-</span><span class="fl">1.07846</span>,
               <span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">1.214359</span>,
               <span class="dv">2</span>,<span class="dv">2</span>,<span class="fl">0.307180</span>,
               <span class="dv">2</span>,<span class="dv">3</span>,<span class="op">-</span><span class="fl">0.385641</span>,
               <span class="dv">2</span>,<span class="dv">1</span>,<span class="op">-</span><span class="fl">0.078461</span>,
               <span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">1.61436</span>,
               <span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">0.814359</span>,
               <span class="dv">2</span>,<span class="dv">1</span>,<span class="op">-</span><span class="fl">0.0641016</span>,
       <span class="dv">1</span>,<span class="dv">2</span>,<span class="fl">1.535900</span>),<span class="dv">9</span>,<span class="dv">3</span>,<span class="dt">byrow=</span>T)</code></pre></div>
<p>Para calcular los pesos completamente, necesitamos las matrices de varianzas y covarianzas para <span class="math inline">\(X\)</span> e <span class="math inline">\(Y\)</span>, así como las matrices de covarianza cruzada.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">S_xy &lt;-<span class="st"> </span><span class="kw">cov</span>(X, Y)
S_xx &lt;-<span class="st"> </span><span class="kw">var</span>(X)
S_yx &lt;-<span class="st"> </span><span class="kw">cov</span>(Y, X)
S_yy &lt;-<span class="st"> </span><span class="kw">var</span>(Y)
S_xy
<span class="co">#&gt;        [,1]   [,2]     [,3]</span>
<span class="co">#&gt; [1,] -0.625 -0.778  0.69679</span>
<span class="co">#&gt; [2,] -0.750 -0.556  0.95242</span>
<span class="co">#&gt; [3,] -0.125 -0.347 -0.00826</span></code></pre></div>
<p>Ahora que tenemos estas matrices, es fácil calcular los pesos canónicos y las correlaciones canónicas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">solve</span>(S_xx) <span class="op">%*%</span><span class="st"> </span>S_xy <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(S_yy) <span class="op">%*%</span><span class="st"> </span>S_yx)<span class="op">$</span>vectors
B &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">solve</span>(S_yy) <span class="op">%*%</span><span class="st"> </span>S_yx <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(S_xx) <span class="op">%*%</span><span class="st"> </span>S_xy)<span class="op">$</span>vectors
R &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">eigen</span>(<span class="kw">solve</span>(S_yy) <span class="op">%*%</span><span class="st"> </span>S_yx <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(S_xx) <span class="op">%*%</span><span class="st"> </span>S_xy)<span class="op">$</span>values)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">A
<span class="co">#&gt;        [,1]   [,2]   [,3]</span>
<span class="co">#&gt; [1,]  0.400  0.796 -0.578</span>
<span class="co">#&gt; [2,]  0.600 -0.584  0.429</span>
<span class="co">#&gt; [3,] -0.693 -0.160  0.695</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">B
<span class="co">#&gt;           [,1]    [,2]   [,3]</span>
<span class="co">#&gt; [1,]  1.94e-07 -0.5365 -0.835</span>
<span class="co">#&gt; [2,] -4.34e-07  0.8438  0.139</span>
<span class="co">#&gt; [3,]  1.00e+00  0.0136 -0.533</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R
<span class="co">#&gt; [1] 1.000 0.519 0.091</span></code></pre></div>
</div>
</div>
<div id="ejemplo-test-psicologico" class="section level2">
<h2><span class="header-section-number">15.3</span> Ejemplo: test psicológico</h2>
<p>Supongamos que se desea investigar asociaciones entre mediciones psicológicas y medidas de desempeño académico y contamos con datos con 600 observaciones de ocho variables. Las variables psicológicas son <code>locus_of_control</code>, <code>self_concept</code> y <code>motivation</code>. Las variables académicas son pruebas estandarizadas en lectura (<code>read</code>), redacción (<code>write</code>), matemáticas (<code>math</code>) y ciencia (<code>science</code>). Además, la variable <code>female</code> es una variable indicadora de que una estudiante es mujer.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(GGally)
<span class="kw">library</span>(CCA)

psychademic <span class="op">%&gt;%</span><span class="st"> </span>head <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">locus_of_control</th>
<th align="right">self_concept</th>
<th align="left">motivation</th>
<th align="right">read</th>
<th align="right">write</th>
<th align="right">math</th>
<th align="right">science</th>
<th align="left">sex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">-0.84</td>
<td align="right">-0.24</td>
<td align="left">4</td>
<td align="right">54.8</td>
<td align="right">64.5</td>
<td align="right">44.5</td>
<td align="right">52.6</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">-0.38</td>
<td align="right">-0.47</td>
<td align="left">3</td>
<td align="right">62.7</td>
<td align="right">43.7</td>
<td align="right">44.7</td>
<td align="right">52.6</td>
<td align="left">female</td>
</tr>
<tr class="odd">
<td align="right">0.89</td>
<td align="right">0.59</td>
<td align="left">3</td>
<td align="right">60.6</td>
<td align="right">56.7</td>
<td align="right">70.5</td>
<td align="right">58.0</td>
<td align="left">male</td>
</tr>
<tr class="even">
<td align="right">0.71</td>
<td align="right">0.28</td>
<td align="left">3</td>
<td align="right">62.7</td>
<td align="right">56.7</td>
<td align="right">54.7</td>
<td align="right">58.0</td>
<td align="left">male</td>
</tr>
<tr class="odd">
<td align="right">-0.64</td>
<td align="right">0.03</td>
<td align="left">4</td>
<td align="right">41.6</td>
<td align="right">46.3</td>
<td align="right">38.4</td>
<td align="right">36.3</td>
<td align="left">female</td>
</tr>
<tr class="even">
<td align="right">1.11</td>
<td align="right">0.90</td>
<td align="left">2</td>
<td align="right">62.7</td>
<td align="right">64.5</td>
<td align="right">61.4</td>
<td align="right">58.0</td>
<td align="left">female</td>
</tr>
</tbody>
</table>
<p>Las variables psicológicas son:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(psych_variables &lt;-<span class="st"> </span><span class="kw">attr</span>(psychademic, <span class="st">&quot;psychology&quot;</span>))
<span class="co">#&gt; [1] &quot;locus_of_control&quot; &quot;self_concept&quot;     &quot;motivation&quot;</span></code></pre></div>
<p>Las variables académicas son:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(academic_variables &lt;-<span class="st"> </span><span class="kw">attr</span>(psychademic, <span class="st">&quot;academic&quot;</span>))
<span class="co">#&gt; [1] &quot;read&quot;    &quot;write&quot;   &quot;math&quot;    &quot;science&quot; &quot;sex&quot;</span></code></pre></div>
<p>Veamos las correlaciones entre las variables psicológicas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggpairs</span>(psychademic, psych_variables, <span class="dt">title =</span> <span class="st">&quot;Within Psychological Variables&quot;</span>)</code></pre></div>
<p><img src="15-cca_files/figure-html/unnamed-chunk-16-1.png" width="90%" height="400cm" style="display: block; margin: auto;" /></p>
<p>Y entre las académicas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggpairs</span>(psychademic, academic_variables, <span class="dt">title =</span> <span class="st">&quot;Within Academic Variables&quot;</span>)</code></pre></div>
<p><img src="15-cca_files/figure-html/unnamed-chunk-17-1.png" width="90%" height="400cm" style="display: block; margin: auto;" /></p>
<p>Veamos las correlaciones entre pares de ambos grupos de variables:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggduo</span>(
  psychademic, psych_variables, academic_variables,
  <span class="dt">types =</span> <span class="kw">list</span>(<span class="dt">continuous =</span> <span class="st">&quot;smooth_lm&quot;</span>),
  <span class="dt">title =</span> <span class="st">&quot;Between Academic and Psychological Variable Correlation&quot;</span>,
  <span class="dt">xlab =</span> <span class="st">&quot;Psychological&quot;</span>,
  <span class="dt">ylab =</span> <span class="st">&quot;Academic&quot;</span>
)</code></pre></div>
<p><img src="15-cca_files/figure-html/unnamed-chunk-18-1.png" width="100%" height="480cm" style="display: block; margin: auto;" /></p>
<p>También podemos analizar las correlaciones numéricamente:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">datos &lt;-<span class="st"> </span>psychademic <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.funs =</span> as.numeric, <span class="dt">.vars =</span> <span class="kw">vars</span>(<span class="op">-</span>sex)) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">sex =</span> <span class="kw">ifelse</span>(sex <span class="op">==</span><span class="st"> &#39;female&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>))
<span class="kw">matcor</span>(datos[,psych_variables], datos[,academic_variables])
<span class="co">#&gt; $Xcor</span>
<span class="co">#&gt;                  locus_of_control self_concept motivation</span>
<span class="co">#&gt; locus_of_control            1.000        0.171      0.245</span>
<span class="co">#&gt; self_concept                0.171        1.000      0.289</span>
<span class="co">#&gt; motivation                  0.245        0.289      1.000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Ycor</span>
<span class="co">#&gt;            read write    math science     sex</span>
<span class="co">#&gt; read     1.0000 0.629  0.6793   0.691 -0.0417</span>
<span class="co">#&gt; write    0.6286 1.000  0.6327   0.569  0.2443</span>
<span class="co">#&gt; math     0.6793 0.633  1.0000   0.650 -0.0482</span>
<span class="co">#&gt; science  0.6907 0.569  0.6495   1.000 -0.1382</span>
<span class="co">#&gt; sex     -0.0417 0.244 -0.0482  -0.138  1.0000</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $XYcor</span>
<span class="co">#&gt;                  locus_of_control self_concept motivation    read  write</span>
<span class="co">#&gt; locus_of_control            1.000       0.1712     0.2450  0.3736 0.3589</span>
<span class="co">#&gt; self_concept                0.171       1.0000     0.2890  0.0607 0.0194</span>
<span class="co">#&gt; motivation                  0.245       0.2890     1.0000  0.2105 0.2541</span>
<span class="co">#&gt; read                        0.374       0.0607     0.2105  1.0000 0.6286</span>
<span class="co">#&gt; write                       0.359       0.0194     0.2541  0.6286 1.0000</span>
<span class="co">#&gt; math                        0.337       0.0536     0.1949  0.6793 0.6327</span>
<span class="co">#&gt; science                     0.325       0.0698     0.1159  0.6907 0.5691</span>
<span class="co">#&gt; sex                         0.113      -0.1260     0.0979 -0.0417 0.2443</span>
<span class="co">#&gt;                     math science     sex</span>
<span class="co">#&gt; locus_of_control  0.3373  0.3246  0.1134</span>
<span class="co">#&gt; self_concept      0.0536  0.0698 -0.1260</span>
<span class="co">#&gt; motivation        0.1949  0.1159  0.0979</span>
<span class="co">#&gt; read              0.6793  0.6907 -0.0417</span>
<span class="co">#&gt; write             0.6327  0.5691  0.2443</span>
<span class="co">#&gt; math              1.0000  0.6495 -0.0482</span>
<span class="co">#&gt; science           0.6495  1.0000 -0.1382</span>
<span class="co">#&gt; sex              -0.0482 -0.1382  1.0000</span></code></pre></div>
<p>LLevamos a cabo CCA:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cc1 &lt;-<span class="st"> </span><span class="kw">cc</span>(datos[,psych_variables], datos[,academic_variables])

<span class="co"># correlaciones canónicas</span>
cc1<span class="op">$</span>cor
<span class="co">#&gt; [1] 0.464 0.167 0.104</span></code></pre></div>
<p>Coeficientes canónicos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cc1[<span class="dv">3</span><span class="op">:</span><span class="dv">4</span>]
<span class="co">#&gt; $xcoef</span>
<span class="co">#&gt;                    [,1]   [,2]   [,3]</span>
<span class="co">#&gt; locus_of_control -1.254 -0.619 -0.663</span>
<span class="co">#&gt; self_concept      0.351 -1.191  0.823</span>
<span class="co">#&gt; motivation       -0.421  0.675  0.670</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ycoef</span>
<span class="co">#&gt;            [,1]     [,2]     [,3]</span>
<span class="co">#&gt; read    -0.0446 -0.00504  0.02123</span>
<span class="co">#&gt; write   -0.0359  0.04198  0.09164</span>
<span class="co">#&gt; math    -0.0234  0.00410  0.00923</span>
<span class="co">#&gt; science -0.0051 -0.08479 -0.10992</span>
<span class="co">#&gt; sex     -0.6321  1.08910 -1.79242</span></code></pre></div>
<p class="espacio">
</p>

<div class="information">
<p><strong>Nota:</strong></p>
<p class="espacio">
</p>
<ul>
<li><p>Las correlaciones anteriores son entre las variables observadas y las variables canónicas, a estas se les conoce como <em>cargas canónicas</em>.</p></li>
<li><p>Las variables canónicas son en realidad un tipo de variable latente.</p></li>
<li>En general, el número de dimensiones canónicas es igual al número de variables en el conjunto más pequeño; sin embargo, la cantidad de dimensiones significativas puede ser aún menor. Las dimensiones canónicas, también conocidas como variables canónicas, son variables latentes que son análogas a los factores obtenidos en el análisis de factores.
</div>
</li>
</ul>
<p><br></p>
<p>En este ejemplo particular, hay tres dimensiones canónicas, de las cuales solo las dos primeras son estadísticamente significativas.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ev &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>cc1<span class="op">$</span>cor<span class="op">^</span><span class="dv">2</span>)

n &lt;-<span class="st"> </span><span class="kw">dim</span>(datos)[<span class="dv">1</span>]
p &lt;-<span class="st"> </span><span class="kw">length</span>(datos[,psych_variables])
q &lt;-<span class="st"> </span><span class="kw">length</span>(datos[,academic_variables])
k &lt;-<span class="st"> </span><span class="kw">min</span>(p, q)
m &lt;-<span class="st"> </span>n <span class="op">-</span><span class="st"> </span><span class="dv">3</span><span class="op">/</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span>(p <span class="op">+</span><span class="st"> </span>q)<span class="op">/</span><span class="dv">2</span>

w &lt;-<span class="st"> </span><span class="kw">rev</span>(<span class="kw">cumprod</span>(<span class="kw">rev</span>(ev)))

d1 &lt;-<span class="st"> </span>d2 &lt;-<span class="st"> </span>f &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;numeric&quot;</span>, k)

<span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {
    s &lt;-<span class="st"> </span><span class="kw">sqrt</span>((p<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>q<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">4</span>)<span class="op">/</span>(p<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>q<span class="op">^</span><span class="dv">2</span> <span class="op">-</span><span class="st"> </span><span class="dv">5</span>))
    si &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>s
    d1[i] &lt;-<span class="st"> </span>p <span class="op">*</span><span class="st"> </span>q
    d2[i] &lt;-<span class="st"> </span>m <span class="op">*</span><span class="st"> </span>s <span class="op">-</span><span class="st"> </span>p <span class="op">*</span><span class="st"> </span>q<span class="op">/</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    r &lt;-<span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>w[i]<span class="op">^</span>si)<span class="op">/</span>w[i]<span class="op">^</span>si
    f[i] &lt;-<span class="st"> </span>r <span class="op">*</span><span class="st"> </span>d2[i]<span class="op">/</span>d1[i]
    p &lt;-<span class="st"> </span>p <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
    q &lt;-<span class="st"> </span>q <span class="op">-</span><span class="st"> </span><span class="dv">1</span>
}

pv &lt;-<span class="st"> </span><span class="kw">pf</span>(f, d1, d2, <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)
(dmat &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">WilksL =</span> w, <span class="dt">F =</span> f, <span class="dt">df1 =</span> d1, <span class="dt">df2 =</span> d2, <span class="dt">p =</span> pv))
<span class="co">#&gt;      WilksL     F df1  df2        p</span>
<span class="co">#&gt; [1,]  0.754 11.71  15 1635 7.79e-28</span>
<span class="co">#&gt; [2,]  0.962  2.94   8 1186 2.97e-03</span>
<span class="co">#&gt; [3,]  0.989  2.16   3  594 9.19e-02</span></code></pre></div>
<p>Cuando las variables en el modelo tienen desviaciones estándar muy diferentes, los coeficientes estandarizados permiten una comparación más fácil entre las variables.</p>
<p>Coeficientes canónicos estandarizados para variables psicológicas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s1 &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">cov</span>(datos[,psych_variables]))))
s1 <span class="op">%*%</span><span class="st"> </span>cc1<span class="op">$</span>xcoef
<span class="co">#&gt;        [,1]   [,2]   [,3]</span>
<span class="co">#&gt; [1,] -0.841 -0.415 -0.444</span>
<span class="co">#&gt; [2,]  0.248 -0.840  0.581</span>
<span class="co">#&gt; [3,] -0.432  0.693  0.688</span></code></pre></div>
<p>Coeficientes canónicos estandarizados para variables académicas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">s2 &lt;-<span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(<span class="kw">diag</span>(<span class="kw">cov</span>(datos[,academic_variables]))))
s2 <span class="op">%*%</span><span class="st"> </span>cc1<span class="op">$</span>ycoef
<span class="co">#&gt;         [,1]    [,2]    [,3]</span>
<span class="co">#&gt; [1,] -0.4506 -0.0509  0.2145</span>
<span class="co">#&gt; [2,] -0.3489  0.4083  0.8914</span>
<span class="co">#&gt; [3,] -0.2202  0.0386  0.0869</span>
<span class="co">#&gt; [4,] -0.0495 -0.8229 -1.0669</span>
<span class="co">#&gt; [5,] -0.3150  0.5428 -0.8933</span></code></pre></div>
<p>Los coeficientes canónicos estandarizados se interpretan de manera análoga a la interpretación de los coeficientes de regresión estandarizados. Por ejemplo, para la variable de lectura, un aumento de la desviación estándar en lectura se refleja en una disminución de 0.45 desviaciones estándar de en la primera variable canónica del conjunto 2 cuando las otras variables en el modelo se mantienen constantes.</p>
</div>
<div id="ejemplo-fenomenos-meteorologicos" class="section level2">
<h2><span class="header-section-number">15.4</span> Ejemplo: fenómenos meteorológicos</h2>
<p>Ejemplo de (Marc MeNugget)[<a href="https://menugget.blogspot.mx/2012/03/canonical-correlation-analysis-for.html" class="uri">https://menugget.blogspot.mx/2012/03/canonical-correlation-analysis-for.html</a>].</p>
<p>Veamos ahora el uso del Análisis de Correlación Canónica (CCA) para encontrar patrones entre pares de observaciones en campos climáticos. El método produce resultados similares a los de componentes principales, pero los patrones reflejan la <em>correlación</em> máxima en vez de la <em>covarianza</em> máxima. Además, el resultado del modelo es una combinación de modelos lineales que se pueden usar para un modelo de predicción de un campo climático.</p>
<p>Descargamos los campos de anomalías mensuales de presión superficial del mar (SLP) y temperatura de la superficie del mar (TSM) para la región del Pacífico ecuatorial de la <a href="https://www.esrl.noaa.gov/">NOAA</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(curl)

url_pres &lt;-<span class="st"> &quot;ftp://ftp.cdc.noaa.gov/Datasets.other/hadslp/slp.mnmean.nc&quot;</span>
<span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(<span class="st">&quot;datos/slp.mnmean.nc&quot;</span>)){
  <span class="kw">curl_fetch_disk</span>(url_pres, <span class="dt">path =</span> <span class="st">&quot;datos/slp.mnmean.nc&quot;</span>, <span class="dt">handle =</span> <span class="kw">new_handle</span>(<span class="dt">CONNECTTIMEOUT =</span> <span class="dv">60</span>))
}

url_temp &lt;-<span class="st"> &quot;http://www.esrl.noaa.gov/psd/thredds/fileServer/Datasets/kaplan_sst/sst.mon.anom.nc&quot;</span>
<span class="cf">if</span>(<span class="op">!</span><span class="kw">file.exists</span>(<span class="st">&quot;datos/sst.mon.anom.nc&quot;</span>)){
  <span class="kw">curl_fetch_disk</span>(<span class="dt">url =</span> url_temp, <span class="dt">path =</span> <span class="st">&quot;datos/sst.mon.anom.nc&quot;</span>, <span class="dt">handle =</span> <span class="kw">new_handle</span>(<span class="dt">CONNECTTIMEOUT =</span> <span class="dv">60</span>))
}</code></pre></div>
<p>Leemos los datos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(maps)
<span class="kw">library</span>(mapproj)
<span class="kw">library</span>(ncdf4)
<span class="kw">library</span>(CCP)
<span class="kw">library</span>(irlba)
nc &lt;-<span class="st"> </span><span class="kw">nc_open</span>(<span class="dt">filename =</span> <span class="st">&quot;datos/slp.mnmean.nc&quot;</span>)
slp.lon &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(nc, <span class="st">&quot;lon&quot;</span>)
slp.lat &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(nc, <span class="st">&quot;lat&quot;</span>)
slp.t &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(nc, <span class="st">&quot;time&quot;</span>)
slp.raw &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(nc, <span class="st">&quot;slp&quot;</span>)
<span class="kw">nc_close</span>(nc)
slp.t &lt;-<span class="st"> </span><span class="kw">as.Date</span>(slp.t, <span class="dt">origin=</span><span class="st">&quot;1800-01-01&quot;</span>)
temp &lt;-<span class="st"> </span><span class="kw">which</span>(slp.lon <span class="op">&gt;</span><span class="st"> </span><span class="dv">180</span>)
slp.lon[temp] &lt;-<span class="st"> </span>slp.lon[temp] <span class="op">-</span><span class="st"> </span><span class="dv">360</span>
slp.grd &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(slp.lon, slp.lat)
<span class="kw">colnames</span>(slp.grd) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)
slp &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(slp.raw), <span class="dt">nrow=</span><span class="kw">length</span>(slp.t), ncol&lt;-<span class="kw">length</span>(slp.lon)<span class="op">*</span><span class="kw">length</span>(slp.lat), <span class="dt">byrow=</span><span class="ot">TRUE</span>)
<span class="kw">row.names</span>(slp) &lt;-<span class="st"> </span><span class="kw">as.character</span>(slp.t)</code></pre></div>
<p>Calculamos anomalías en la presión superficial del mar:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">anomaly &lt;-<span class="st"> </span><span class="cf">function</span>(y, x, <span class="dt">level=</span><span class="st">&quot;daily&quot;</span>){ 
 y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y)
 
 <span class="cf">if</span>(level<span class="op">==</span><span class="st">&quot;monthly&quot;</span>){levs=<span class="kw">unique</span>(x<span class="op">$</span>mon)}
 <span class="cf">if</span>(level<span class="op">==</span><span class="st">&quot;daily&quot;</span>){levs=<span class="kw">unique</span>(x<span class="op">$</span>yday)}
 
 levs_lookup=<span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(levs))
 <span class="kw">names</span>(levs_lookup)&lt;-levs
 <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(levs)){
  <span class="cf">if</span>(level<span class="op">==</span><span class="st">&quot;monthly&quot;</span>){levs_lookup[[i]]&lt;-<span class="kw">which</span>(x<span class="op">$</span>mon <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(levs_lookup[i]))}
  <span class="cf">if</span>(level<span class="op">==</span><span class="st">&quot;daily&quot;</span>){levs_lookup[[i]]&lt;-<span class="kw">which</span>(x<span class="op">$</span>yday <span class="op">==</span><span class="st"> </span><span class="kw">names</span>(levs_lookup[i]))}
 }
 
 <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(levs)){
  y[levs_lookup[[j]],] &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">t</span>(<span class="kw">as.matrix</span>(y[levs_lookup[[j]],])) <span class="op">-</span><span class="st"> </span><span class="kw">apply</span>(<span class="kw">as.matrix</span>(y[levs_lookup[[j]],]), <span class="dv">2</span>, mean, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))
 }
 
 y
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">slp &lt;-<span class="st"> </span><span class="kw">anomaly</span>(slp, <span class="kw">as.POSIXlt</span>(slp.t), <span class="dt">level=</span><span class="st">&quot;monthly&quot;</span>)</code></pre></div>
<p>Leemos los datos de temperaturas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nc &lt;-<span class="st"> </span><span class="kw">nc_open</span>(<span class="dt">filename =</span> <span class="st">&quot;datos/sst.mon.anom.nc&quot;</span>)
sst.lon &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(nc, <span class="st">&quot;lon&quot;</span>)
sst.lat &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(nc, <span class="st">&quot;lat&quot;</span>)
sst.t &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(nc, <span class="st">&quot;time&quot;</span>)
sst.raw &lt;-<span class="st"> </span><span class="kw">ncvar_get</span>(nc, <span class="st">&quot;sst&quot;</span>)
<span class="kw">nc_close</span>(nc)
sst.t &lt;-<span class="st"> </span><span class="kw">as.Date</span>(sst.t, <span class="dt">origin=</span><span class="st">&quot;1800-01-01&quot;</span>)
temp &lt;-<span class="st"> </span><span class="kw">which</span>(sst.lon <span class="op">&gt;</span><span class="st"> </span><span class="dv">180</span>)
sst.lon[temp] &lt;-<span class="st"> </span>sst.lon[temp] <span class="op">-</span><span class="st"> </span><span class="dv">360</span>
sst.grd &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(sst.lon, sst.lat)
<span class="kw">colnames</span>(sst.grd) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;lon&quot;</span>, <span class="st">&quot;lat&quot;</span>)
sst &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(sst.raw), <span class="dt">nrow=</span><span class="kw">length</span>(sst.t), ncol&lt;-<span class="kw">length</span>(sst.lon)<span class="op">*</span><span class="kw">length</span>(sst.lat), <span class="dt">byrow=</span><span class="ot">TRUE</span>)
<span class="kw">row.names</span>(sst) &lt;-<span class="st"> </span><span class="kw">as.character</span>(sst.t)</code></pre></div>
<p>Tomamos un subconjunto de los datos de acuerdo a fechas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">t.min &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;1980-01-01&quot;</span>)
t.max1 &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;1998-12-01&quot;</span>)
t.max2 &lt;-<span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2018-04-01&quot;</span>)
slp.t.incl &lt;-<span class="st"> </span><span class="kw">which</span>(slp.t <span class="op">&gt;=</span><span class="st"> </span>t.min <span class="op">&amp;</span><span class="st"> </span>slp.t <span class="op">&lt;=</span><span class="st"> </span>t.max2)
sst.t.incl &lt;-<span class="st"> </span><span class="kw">which</span>(sst.t <span class="op">&gt;=</span><span class="st"> </span>t.min <span class="op">&amp;</span><span class="st"> </span>sst.t <span class="op">&lt;=</span><span class="st"> </span>t.max2)</code></pre></div>
<p>Nos concentramos primero en la región del pacífico:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lon.lim &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="op">-</span><span class="dv">70</span>)
lat.lim &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">30</span>, <span class="dv">30</span>)

slp.grd.incl &lt;-<span class="st"> </span><span class="kw">which</span>(slp.grd[,<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span><span class="dv">70</span> <span class="op">&amp;</span><span class="st"> </span>slp.grd[,<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="dv">180</span> <span class="op">&amp;</span><span class="st"> </span>slp.grd[,<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>slp.grd[,<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="dv">30</span>)
sst.grd.incl &lt;-<span class="st"> </span><span class="kw">which</span>(sst.grd[,<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span><span class="op">-</span><span class="dv">70</span> <span class="op">&amp;</span><span class="st"> </span>sst.grd[,<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="dv">180</span> <span class="op">&amp;</span><span class="st"> </span>sst.grd[,<span class="dv">2</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span> <span class="op">&amp;</span><span class="st"> </span>sst.grd[,<span class="dv">2</span>] <span class="op">&gt;</span><span class="st"> </span><span class="op">-</span><span class="dv">30</span>)</code></pre></div>
<p>Centramos cada una de las matrices:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X &lt;-<span class="st"> </span>slp[slp.t.incl, slp.grd.incl]
Y &lt;-<span class="st"> </span>sst[sst.t.incl, sst.grd.incl]
Y[<span class="kw">is.na</span>(Y)] &lt;-<span class="st"> </span><span class="dv">0</span>
X_c &lt;-<span class="st"> </span><span class="kw">scale</span>(X, <span class="dt">center=</span><span class="ot">TRUE</span>, <span class="dt">scale=</span><span class="ot">FALSE</span>)
Y_c &lt;-<span class="st"> </span><span class="kw">scale</span>(Y, <span class="dt">center=</span><span class="ot">TRUE</span>, <span class="dt">scale=</span><span class="ot">FALSE</span>)</code></pre></div>
<p>Analicemos en las medias de ambas variables a través del tiempo:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">X_m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">apply</span>(X,<span class="dv">1</span>,mean),<span class="dt">nrow=</span><span class="kw">nrow</span>(X_c), <span class="dt">ncol=</span><span class="dv">1</span>)
<span class="kw">rownames</span>(X_m) &lt;-<span class="st"> </span><span class="kw">rownames</span>(X)
Y_m &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">apply</span>(Y,<span class="dv">1</span>,mean),<span class="dt">nrow=</span><span class="kw">nrow</span>(Y_c), <span class="dt">ncol=</span><span class="dv">1</span>)
<span class="kw">rownames</span>(Y_m) &lt;-<span class="st"> </span><span class="kw">rownames</span>(Y)
zran &lt;-<span class="st"> </span><span class="kw">range</span>(X_m, Y_m)
zlim &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="kw">max</span>(<span class="kw">abs</span>(zran)), <span class="kw">max</span>(<span class="kw">abs</span>(zran)))
pal &lt;-<span class="st"> </span><span class="kw">color.palette</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>))
colorvalues1 &lt;-<span class="st"> </span><span class="kw">val2col</span>(X_m, zlim, <span class="dt">col=</span><span class="kw">pal</span>(ncol))
colorvalues2 &lt;-<span class="st"> </span><span class="kw">val2col</span>(Y_m, zlim, <span class="dt">col=</span><span class="kw">pal</span>(ncol))</code></pre></div>
<p>Creamos polígonos para graficar:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#slp</span>
spacing &lt;-<span class="st"> </span><span class="dv">5</span>
slp.poly &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&quot;list&quot;</span>, <span class="kw">dim</span>(slp.grd)[<span class="dv">1</span>])
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(slp.poly)){
 x=<span class="kw">c</span>(slp.grd[i,<span class="dv">1</span>]<span class="op">-</span>spacing<span class="op">/</span><span class="dv">2</span>, slp.grd[i,<span class="dv">1</span>]<span class="op">+</span>spacing<span class="op">/</span><span class="dv">2</span>, slp.grd[i,<span class="dv">1</span>]<span class="op">+</span>spacing<span class="op">/</span><span class="dv">2</span>, slp.grd[i,<span class="dv">1</span>]<span class="op">-</span>spacing<span class="op">/</span><span class="dv">2</span>)
 y=<span class="kw">c</span>(slp.grd[i,<span class="dv">2</span>]<span class="op">-</span>spacing<span class="op">/</span><span class="dv">2</span>, slp.grd[i,<span class="dv">2</span>]<span class="op">-</span>spacing<span class="op">/</span><span class="dv">2</span>, slp.grd[i,<span class="dv">2</span>]<span class="op">+</span>spacing<span class="op">/</span><span class="dv">2</span>, slp.grd[i,<span class="dv">2</span>]<span class="op">+</span>spacing<span class="op">/</span><span class="dv">2</span>)
 slp.poly[[i]] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)
}
 
<span class="co">#sst</span>
spacing &lt;-<span class="st"> </span><span class="dv">5</span>
sst.poly &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&quot;list&quot;</span>, <span class="kw">dim</span>(sst.grd)[<span class="dv">1</span>])
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(sst.poly)){
 x=<span class="kw">c</span>(sst.grd[i,<span class="dv">1</span>]<span class="op">-</span>spacing<span class="op">/</span><span class="dv">2</span>, sst.grd[i,<span class="dv">1</span>]<span class="op">+</span>spacing<span class="op">/</span><span class="dv">2</span>, sst.grd[i,<span class="dv">1</span>]<span class="op">+</span>spacing<span class="op">/</span><span class="dv">2</span>, sst.grd[i,<span class="dv">1</span>]<span class="op">-</span>spacing<span class="op">/</span><span class="dv">2</span>)
 y=<span class="kw">c</span>(sst.grd[i,<span class="dv">2</span>]<span class="op">-</span>spacing<span class="op">/</span><span class="dv">2</span>, sst.grd[i,<span class="dv">2</span>]<span class="op">-</span>spacing<span class="op">/</span><span class="dv">2</span>, sst.grd[i,<span class="dv">2</span>]<span class="op">+</span>spacing<span class="op">/</span><span class="dv">2</span>, sst.grd[i,<span class="dv">2</span>]<span class="op">+</span>spacing<span class="op">/</span><span class="dv">2</span>)
 sst.poly[[i]] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)
}</code></pre></div>
<p>Gráfica de anomalías de presión a nivel del mar:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#mapproj settings</span>
project=<span class="st">&quot;fisheye&quot;</span>
orientation=<span class="kw">c</span>(<span class="kw">mean</span>(lat.lim), <span class="kw">mean</span>(lon.lim), <span class="dv">0</span>)
PAR=<span class="dv">1</span>
<span class="kw">par</span>(<span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))
<span class="kw">map</span>(<span class="st">&quot;world&quot;</span>,<span class="dt">project=</span>project, <span class="dt">orientation=</span>orientation, <span class="dt">par=</span>PAR, <span class="dt">ylim=</span>lat.lim, <span class="dt">xlim=</span>lon.lim)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(slp.grd.incl)){
  <span class="kw">polygon</span>(<span class="kw">mapproject</span>(<span class="dt">x=</span>slp.poly[[slp.grd.incl[i]]][,<span class="dv">1</span>], <span class="dt">y=</span>slp.poly[[slp.grd.incl[i]]][,<span class="dv">2</span>]), <span class="dt">col=</span>colorvalues1[i], <span class="dt">border=</span>colorvalues1[i], <span class="dt">lwd=</span><span class="fl">0.3</span>)
}
<span class="kw">map</span>(<span class="st">&quot;world&quot;</span>,<span class="dt">project=</span>project, <span class="dt">orientation=</span>orientation, <span class="dt">par=</span>PAR, <span class="dt">fill=</span><span class="ot">FALSE</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)
<span class="kw">map.grid</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">180</span>, <span class="op">-</span><span class="dv">90</span>, <span class="dv">90</span>), <span class="dt">nx=</span><span class="dv">36</span>, <span class="dt">ny=</span><span class="dv">18</span>, <span class="dt">labels=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)
<span class="kw">box</span>()</code></pre></div>
<p><img src="15-cca_files/figure-html/unnamed-chunk-37-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Mapa de anomalías</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))
<span class="kw">map</span>(<span class="st">&quot;world&quot;</span>,<span class="dt">project=</span>project, <span class="dt">orientation=</span>orientation, <span class="dt">par=</span>PAR, <span class="dt">ylim=</span>lat.lim, <span class="dt">xlim=</span>lon.lim, <span class="dt">xaxs=</span><span class="st">&quot;i&quot;</span>, <span class="dt">yaxs=</span><span class="st">&quot;i&quot;</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(sst.grd.incl)){
  <span class="kw">polygon</span>(<span class="kw">mapproject</span>(<span class="dt">x=</span>sst.poly[[sst.grd.incl[i]]][,<span class="dv">1</span>], <span class="dt">y=</span>sst.poly[[sst.grd.incl[i]]][,<span class="dv">2</span>]), <span class="dt">col=</span>colorvalues2[i], <span class="dt">border=</span>colorvalues2[i], <span class="dt">lwd=</span><span class="fl">0.3</span>)
}
<span class="kw">map</span>(<span class="st">&quot;world&quot;</span>,<span class="dt">project=</span>project, <span class="dt">orientation=</span>orientation, <span class="dt">par=</span>PAR, <span class="dt">fill=</span><span class="ot">FALSE</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)
<span class="kw">map.grid</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">180</span>, <span class="op">-</span><span class="dv">90</span>, <span class="dv">90</span>), <span class="dt">nx=</span><span class="dv">36</span>, <span class="dt">ny=</span><span class="dv">18</span>, <span class="dt">labels=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)
<span class="kw">box</span>()</code></pre></div>
<p><img src="15-cca_files/figure-html/unnamed-chunk-38-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Ahora hacemos el análisis de correlación canónica. Primero calculamos la covarianza entre <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cov4gappy &lt;-<span class="st"> </span><span class="cf">function</span>(F1, <span class="dt">F2=</span><span class="ot">NULL</span>){
    <span class="cf">if</span>(<span class="kw">is.null</span>(F2)){
        F1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(F1)
        F1_val&lt;-<span class="kw">replace</span>(F1, <span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(F1)), <span class="dv">1</span>)
        F1_val&lt;-<span class="kw">replace</span>(F1_val, <span class="kw">which</span>(<span class="kw">is.na</span>(F1_val)), <span class="dv">0</span>) 
        n_pairs=(<span class="kw">t</span>(F1_val)<span class="op">%*%</span>F1_val)
 
        F1&lt;-<span class="kw">replace</span>(F1, <span class="kw">which</span>(<span class="kw">is.na</span>(F1)), <span class="dv">0</span>)
        cov_mat &lt;-<span class="st"> </span>(<span class="kw">t</span>(F1)<span class="op">%*%</span>F1)<span class="op">/</span>n_pairs
        cov_mat &lt;-<span class="st"> </span><span class="kw">replace</span>(cov_mat, <span class="kw">which</span>(<span class="kw">is.na</span>(cov_mat)), <span class="dv">0</span>)
    }
 
    <span class="cf">if</span>(<span class="op">!</span><span class="kw">is.null</span>(F2)){
        <span class="cf">if</span>(<span class="kw">dim</span>(F1)[<span class="dv">1</span>] <span class="op">==</span><span class="st"> </span><span class="kw">dim</span>(F2)[<span class="dv">1</span>]){
            F1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(F1)
            F2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(F2)
 
            F1_val&lt;-<span class="kw">replace</span>(F1, <span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(F1)), <span class="dv">1</span>)
            F1_val&lt;-<span class="kw">replace</span>(F1_val, <span class="kw">which</span>(<span class="kw">is.na</span>(F1_val)), <span class="dv">0</span>) 
            F2_val&lt;-<span class="kw">replace</span>(F2, <span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(F2)), <span class="dv">1</span>)
            F2_val&lt;-<span class="kw">replace</span>(F2_val, <span class="kw">which</span>(<span class="kw">is.na</span>(F2_val)), <span class="dv">0</span>) 
            n_pairs=(<span class="kw">t</span>(F1_val)<span class="op">%*%</span>F2_val)
 
            F1&lt;-<span class="kw">replace</span>(F1, <span class="kw">which</span>(<span class="kw">is.na</span>(F1)), <span class="dv">0</span>)
            F2&lt;-<span class="kw">replace</span>(F2, <span class="kw">which</span>(<span class="kw">is.na</span>(F2)), <span class="dv">0</span>)
            cov_mat &lt;-<span class="st"> </span>(<span class="kw">t</span>(F1)<span class="op">%*%</span>F2)<span class="op">/</span>n_pairs
            cov_mat &lt;-<span class="st"> </span><span class="kw">replace</span>(cov_mat, <span class="kw">which</span>(<span class="kw">is.na</span>(cov_mat)), <span class="dv">0</span>)
 
        } <span class="cf">else</span> {
            <span class="kw">print</span>(<span class="st">&quot;ERROR; matrices columns not of the same lengths&quot;</span>)
        }
    }
 
    cov_mat
}

exp.mat&lt;-<span class="cf">function</span>(MAT, EXP, <span class="dt">tol=</span><span class="ot">NULL</span>){
 MAT &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(MAT)
 matdim &lt;-<span class="st"> </span><span class="kw">dim</span>(MAT)
 <span class="cf">if</span>(<span class="kw">is.null</span>(tol)){
  tol=<span class="kw">min</span>(<span class="fl">1e-7</span>, .Machine<span class="op">$</span>double.eps<span class="op">*</span><span class="kw">max</span>(matdim)<span class="op">*</span><span class="kw">max</span>(MAT))
 }
 <span class="cf">if</span>(matdim[<span class="dv">1</span>]<span class="op">&gt;=</span>matdim[<span class="dv">2</span>]){ 
  svd1 &lt;-<span class="st"> </span><span class="kw">svd</span>(MAT)
  keep &lt;-<span class="st"> </span><span class="kw">which</span>(svd1<span class="op">$</span>d <span class="op">&gt;</span><span class="st"> </span>tol)
  res &lt;-<span class="st"> </span><span class="kw">t</span>(svd1<span class="op">$</span>u[,keep]<span class="op">%*%</span><span class="kw">diag</span>(svd1<span class="op">$</span>d[keep]<span class="op">^</span>EXP, <span class="dt">nrow=</span><span class="kw">length</span>(keep))<span class="op">%*%</span><span class="kw">t</span>(svd1<span class="op">$</span>v[,keep]))
 }
 <span class="cf">if</span>(matdim[<span class="dv">1</span>]<span class="op">&lt;</span>matdim[<span class="dv">2</span>]){ 
  svd1 &lt;-<span class="st"> </span><span class="kw">svd</span>(<span class="kw">t</span>(MAT))
  keep &lt;-<span class="st"> </span><span class="kw">which</span>(svd1<span class="op">$</span>d <span class="op">&gt;</span><span class="st"> </span>tol)
  res &lt;-<span class="st"> </span>svd1<span class="op">$</span>u[,keep]<span class="op">%*%</span><span class="kw">diag</span>(svd1<span class="op">$</span>d[keep]<span class="op">^</span>EXP, <span class="dt">nrow=</span><span class="kw">length</span>(keep))<span class="op">%*%</span><span class="kw">t</span>(svd1<span class="op">$</span>v[,keep])
 }
 <span class="kw">return</span>(res)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">F1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(X_c)
F2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(Y_c)

F1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(F1)
F1_val&lt;-<span class="kw">replace</span>(F1, <span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(F1)), <span class="dv">1</span>)
F1_val&lt;-<span class="kw">replace</span>(F1_val, <span class="kw">which</span>(<span class="kw">is.na</span>(F1_val)), <span class="dv">0</span>) 
n_pairs=(<span class="kw">t</span>(F1_val)<span class="op">%*%</span>F1_val)
 
F1&lt;-<span class="kw">replace</span>(F1, <span class="kw">which</span>(<span class="kw">is.na</span>(F1)), <span class="dv">0</span>)
cov_mat1 &lt;-<span class="st"> </span>(<span class="kw">t</span>(F1)<span class="op">%*%</span>F1)<span class="op">/</span>n_pairs
cov_mat1 &lt;-<span class="st"> </span><span class="kw">replace</span>(cov_mat1, <span class="kw">which</span>(<span class="kw">is.na</span>(cov_mat1)), <span class="dv">0</span>)

F2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(F2)
F2_val&lt;-<span class="kw">replace</span>(F2, <span class="kw">which</span>(<span class="op">!</span><span class="kw">is.na</span>(F2)), <span class="dv">1</span>)
F2_val&lt;-<span class="kw">replace</span>(F2_val, <span class="kw">which</span>(<span class="kw">is.na</span>(F2_val)), <span class="dv">0</span>) 
n_pairs=(<span class="kw">t</span>(F2_val)<span class="op">%*%</span>F2_val)
 
F2&lt;-<span class="kw">replace</span>(F2, <span class="kw">which</span>(<span class="kw">is.na</span>(F2)), <span class="dv">0</span>)
cov_mat2 &lt;-<span class="st"> </span>(<span class="kw">t</span>(F2)<span class="op">%*%</span>F2)<span class="op">/</span>n_pairs
cov_mat2 &lt;-<span class="st"> </span><span class="kw">replace</span>(cov_mat2, <span class="kw">which</span>(<span class="kw">is.na</span>(cov_mat2)), <span class="dv">0</span>)

L1 &lt;-<span class="st"> </span><span class="kw">irlba</span>(cov_mat1, <span class="dt">nu=</span><span class="dv">5</span>, <span class="dt">nv=</span><span class="dv">5</span>)
L2 &lt;-<span class="st"> </span><span class="kw">irlba</span>(cov_mat2, <span class="dt">nu=</span><span class="dv">5</span>, <span class="dt">nv=</span><span class="dv">5</span>)

A1_coeff &lt;-<span class="st"> </span><span class="kw">replace</span>(F1, <span class="kw">which</span>(<span class="kw">is.na</span>(F1)), <span class="dv">0</span>)<span class="op">%*%</span>L1<span class="op">$</span>u[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
A1_norm &lt;-<span class="st"> </span>F1_val<span class="op">%*%</span>(L1<span class="op">$</span>u[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]<span class="op">^</span><span class="dv">2</span>)
A1=A1_coeff<span class="op">/</span>A1_norm

A2_coeff &lt;-<span class="st"> </span><span class="kw">replace</span>(F2, <span class="kw">which</span>(<span class="kw">is.na</span>(F2)), <span class="dv">0</span>)<span class="op">%*%</span>L2<span class="op">$</span>u[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]
A2_norm &lt;-<span class="st"> </span>F2_val<span class="op">%*%</span>(L2<span class="op">$</span>u[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]<span class="op">^</span><span class="dv">2</span>)
A2=A2_coeff<span class="op">/</span>A2_norm

x &lt;-<span class="st"> </span>A1[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="op">%*%</span><span class="st"> </span><span class="kw">exp.mat</span>(<span class="kw">diag</span>(L1<span class="op">$</span>d[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]), <span class="op">-</span><span class="fl">0.5</span>)
y &lt;-<span class="st"> </span>A2[,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="op">%*%</span><span class="st"> </span><span class="kw">exp.mat</span>(<span class="kw">diag</span>(L2<span class="op">$</span>d[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]), <span class="op">-</span><span class="fl">0.5</span>)</code></pre></div>
<p>Hacemos descomposición en valores singulares:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">
xdim &lt;-<span class="st"> </span><span class="kw">dim</span>(<span class="kw">t</span>(x))
ydim &lt;-<span class="st"> </span><span class="kw">dim</span>(<span class="kw">t</span>(y))
 
mindim=<span class="kw">min</span>(xdim[<span class="dv">2</span>], ydim[<span class="dv">2</span>])
xcols &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>xdim[<span class="dv">2</span>]
ycols &lt;-<span class="st"> </span>(xdim[<span class="dv">2</span>]<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(xdim[<span class="dv">2</span>]<span class="op">+</span>ydim[<span class="dv">2</span>])
 
Sxx &lt;-<span class="st"> </span><span class="kw">cov4gappy</span>(<span class="kw">t</span>(x))
Sxy &lt;-<span class="st"> </span><span class="kw">cov4gappy</span>(<span class="kw">t</span>(x),<span class="kw">t</span>(y))
Syy &lt;-<span class="st"> </span><span class="kw">cov4gappy</span>(<span class="kw">t</span>(y))

svd1 &lt;-<span class="st"> </span><span class="kw">svd</span>(<span class="kw">exp.mat</span>(Syy, <span class="op">-</span><span class="fl">0.5</span>) <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(Sxy) <span class="op">%*%</span><span class="st"> </span><span class="kw">exp.mat</span>(Sxx, <span class="op">-</span><span class="fl">0.5</span>))
A &lt;-<span class="st"> </span><span class="kw">exp.mat</span>(Sxx, <span class="op">-</span><span class="fl">0.5</span>) <span class="op">%*%</span><span class="st"> </span>svd1<span class="op">$</span>v
B &lt;-<span class="st"> </span><span class="kw">exp.mat</span>(Syy, <span class="op">-</span><span class="fl">0.5</span>) <span class="op">%*%</span><span class="st"> </span>svd1<span class="op">$</span>u</code></pre></div>
<p>Veamos las variables canónicas:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">V &lt;-<span class="st"> </span><span class="kw">t</span>(x) <span class="op">%*%</span><span class="st"> </span>A
W &lt;-<span class="st"> </span><span class="kw">t</span>(y) <span class="op">%*%</span><span class="st"> </span>B

rho=<span class="ot">NA</span><span class="op">*</span><span class="dv">1</span><span class="op">:</span>mindim
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>mindim){
  rho[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(<span class="kw">as.vector</span>(W[,i]), <span class="kw">as.vector</span>(V[,i]), <span class="dt">use=</span><span class="st">&quot;pairwise&quot;</span>)
}
 
<span class="co"># A test of CCA significance</span>
<span class="co"># cca.sig  &lt;- p.asym(rho, xdim[1], xdim[2], ydim[2], tstat = &quot;Pillai&quot;)</span></code></pre></div>
<p>Repetimos los mapas de las variables canónicas (primer par):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eof.slp &lt;-<span class="st"> </span><span class="kw">eof.mca</span>(slp[slp.t.incl, slp.grd.incl], <span class="dt">centered=</span><span class="ot">TRUE</span>, <span class="dt">nu=</span><span class="dv">20</span>)
eof.sst &lt;-<span class="st"> </span><span class="kw">eof.mca</span>(sst[sst.t.incl, sst.grd.incl], <span class="dt">centered=</span><span class="ot">TRUE</span>, <span class="dt">nu=</span><span class="dv">20</span>)
<span class="kw">dim</span>(eof.slp<span class="op">$</span>A)
<span class="co">#&gt; [1] 228  20</span>
<span class="kw">dim</span>(eof.sst<span class="op">$</span>A)
<span class="co">#&gt; [1] 460  20</span>

<span class="co">#CCA model will be built on a smaller time subset of the PCs (eof$A)</span>
eof.slp.match &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">as.Date</span>(<span class="kw">rownames</span>(eof.slp<span class="op">$</span>A)) <span class="op">&gt;=</span><span class="st"> </span>t.min <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">rownames</span>(eof.slp<span class="op">$</span>A)) <span class="op">&lt;=</span><span class="st"> </span>t.max1)
eof.sst.match &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">as.Date</span>(<span class="kw">rownames</span>(eof.sst<span class="op">$</span>A)) <span class="op">&gt;=</span><span class="st"> </span>t.min <span class="op">&amp;</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="kw">rownames</span>(eof.sst<span class="op">$</span>A)) <span class="op">&lt;=</span><span class="st"> </span>t.max1)
 
<span class="co">#The BPCCA model based on SLP and SST EOFS</span>
bpcca &lt;-<span class="st"> </span><span class="kw">bp.cca</span>(eof.slp, eof.sst,
<span class="dt">n_pcx_incl=</span>eof.slp<span class="op">$</span>n_sig, <span class="dt">n_pcy_incl=</span>eof.sst<span class="op">$</span>n_sig, 
<span class="dt">rowx_incl=</span>eof.slp.match, <span class="dt">rowy_incl=</span>eof.sst.match)
<span class="co">#&gt;  Pillai-Bartlett Trace, using F-approximation:</span>
<span class="co">#&gt;             stat approx df1  df2  p.value</span>
<span class="co">#&gt; 1 to 5:  1.08708  12.34  25 1110 0.00e+00</span>
<span class="co">#&gt; 2 to 5:  0.44913   6.91  16 1120 2.44e-15</span>
<span class="co">#&gt; 3 to 5:  0.16898   4.39   9 1130 1.17e-05</span>
<span class="co">#&gt; 4 to 5:  0.03486   2.00   4 1140 9.22e-02</span>
<span class="co">#&gt; 5 to 5:  0.00922   2.12   1 1150 1.45e-01</span>
 
 
###Map of CCA
slp.cca.modes &lt;-<span class="st"> </span>eof.slp<span class="op">$</span>u[,<span class="dv">1</span><span class="op">:</span>bpcca<span class="op">$</span>n_pcx_incl] <span class="op">%*%</span><span class="st"> </span>bpcca<span class="op">$</span>A
sst.cca.modes &lt;-<span class="st"> </span>eof.sst<span class="op">$</span>u[,<span class="dv">1</span><span class="op">:</span>bpcca<span class="op">$</span>n_pcy_incl] <span class="op">%*%</span><span class="st"> </span>bpcca<span class="op">$</span>B

MODE=<span class="dv">1</span>
zran &lt;-<span class="st"> </span><span class="kw">range</span>(slp.cca.modes[,MODE], sst.cca.modes[,MODE])
zlim &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="kw">max</span>(<span class="kw">abs</span>(zran)), <span class="kw">max</span>(<span class="kw">abs</span>(zran)))
 
heights=<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)
widths=<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.5</span>)
pal=<span class="kw">color.palette</span>(<span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;white&quot;</span>, <span class="st">&quot;cyan&quot;</span>, <span class="st">&quot;blue&quot;</span>), <span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">10</span>))
ncol=<span class="dv">100</span>
res=<span class="dv">200</span>
colorvalues1 &lt;-<span class="st"> </span><span class="kw">val2col</span>(slp.cca.modes[,MODE], zlim, <span class="dt">col=</span><span class="kw">pal</span>(ncol)) <span class="co">#color levels for the polygons</span>
colorvalues2 &lt;-<span class="st"> </span><span class="kw">val2col</span>(sst.cca.modes[,MODE], zlim, <span class="dt">col=</span><span class="kw">pal</span>(ncol)) <span class="co">#color levels for the polygons</span>
 
<span class="co">#mapproj settings</span>
project=<span class="st">&quot;fisheye&quot;</span>
orientation=<span class="kw">c</span>(<span class="kw">mean</span>(lat.lim), <span class="kw">mean</span>(lon.lim), <span class="dv">0</span>)
PAR=<span class="dv">1</span>
 
<span class="kw">par</span>(<span class="dt">omi=</span><span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">ps=</span><span class="dv">12</span>)
<span class="kw">par</span>(<span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))
<span class="kw">map</span>(<span class="st">&quot;world&quot;</span>,<span class="dt">project=</span>project, <span class="dt">orientation=</span>orientation, <span class="dt">par=</span>PAR, <span class="dt">ylim=</span>lat.lim, <span class="dt">xlim=</span>lon.lim)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(slp.grd.incl)){
 <span class="kw">polygon</span>(<span class="kw">mapproject</span>(<span class="dt">x=</span>slp.poly[[slp.grd.incl[i]]][,<span class="dv">1</span>], <span class="dt">y=</span>slp.poly[[slp.grd.incl[i]]][,<span class="dv">2</span>]), <span class="dt">col=</span>colorvalues1[i], <span class="dt">border=</span>colorvalues1[i], <span class="dt">lwd=</span><span class="fl">0.3</span>)
}
<span class="kw">map</span>(<span class="st">&quot;world&quot;</span>,<span class="dt">project=</span>project, <span class="dt">orientation=</span>orientation, <span class="dt">par=</span>PAR, <span class="dt">fill=</span><span class="ot">FALSE</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)
<span class="kw">map.grid</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">180</span>, <span class="op">-</span><span class="dv">90</span>, <span class="dv">90</span>), <span class="dt">nx=</span><span class="dv">36</span>, <span class="dt">ny=</span><span class="dv">18</span>, <span class="dt">labels=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)

<span class="kw">par</span>(<span class="dt">mai=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))
<span class="kw">map</span>(<span class="st">&quot;world&quot;</span>,<span class="dt">project=</span>project, <span class="dt">orientation=</span>orientation, <span class="dt">par=</span>PAR, <span class="dt">ylim=</span>lat.lim, <span class="dt">xlim=</span>lon.lim, <span class="dt">xaxs=</span><span class="st">&quot;i&quot;</span>, <span class="dt">yaxs=</span><span class="st">&quot;i&quot;</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq</span>(sst.grd.incl)){
 <span class="kw">polygon</span>(<span class="kw">mapproject</span>(<span class="dt">x=</span>sst.poly[[sst.grd.incl[i]]][,<span class="dv">1</span>], <span class="dt">y=</span>sst.poly[[sst.grd.incl[i]]][,<span class="dv">2</span>]), <span class="dt">col=</span>colorvalues2[i], <span class="dt">border=</span>colorvalues2[i], <span class="dt">lwd=</span><span class="fl">0.3</span>)
}
<span class="kw">map</span>(<span class="st">&quot;world&quot;</span>,<span class="dt">project=</span>project, <span class="dt">orientation=</span>orientation, <span class="dt">par=</span>PAR, <span class="dt">fill=</span><span class="ot">FALSE</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)
<span class="kw">map.grid</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">180</span>, <span class="dv">180</span>, <span class="op">-</span><span class="dv">90</span>, <span class="dv">90</span>), <span class="dt">nx=</span><span class="dv">36</span>, <span class="dt">ny=</span><span class="dv">18</span>, <span class="dt">labels=</span><span class="ot">FALSE</span>, <span class="dt">col=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">lwd=</span><span class="dv">1</span>)</code></pre></div>
<p><img src="15-cca_files/figure-html/unnamed-chunk-44-1.png" width="70%" style="display: block; margin: auto;" /><img src="15-cca_files/figure-html/unnamed-chunk-44-2.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="tarea-13" class="section level2">
<h2><span class="header-section-number">15.5</span> Tarea</h2>
<p>Como parte de un estudio más amplio de los efectos de la estructura organizacional en la “satisfacción laboral”, Dunham investigó en qué medida las medidas de satisfacción laboral están relacionadas con las características del trabajo. Utilizando un instrumento de encuesta, Dunham obtuvo medidas de <span class="math inline">\(p = 5\)</span> características del trabajo y <span class="math inline">\(q = 7\)</span> variables de satisfacción laboral para <span class="math inline">\(n = 784\)</span> ejecutivos de la rama corporativa de una gran corporación comercial minorista. ¿Las medidas de satisfacción laboral están asociadas con las características del trabajo? La respuesta puede tener implicaciones para el diseño del trabajo.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyverse)
worksat &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;datos/worksat.csv&quot;</span>)
worksat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">str</span>() 
<span class="co">#&gt; Classes &#39;tbl_df&#39;, &#39;tbl&#39; and &#39;data.frame&#39;:    784 obs. of  13 variables:</span>
<span class="co">#&gt;  $ ID                          : int  1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="co">#&gt;  $ SupervisorSatisfaction(Y1)  : num  -0.1529 -1.2486 0.8356 0.0264 0.4826 ...</span>
<span class="co">#&gt;  $ CareerFutureSatisfaction(Y2): num  -2.04 -1.083 1.439 0.441 0.652 ...</span>
<span class="co">#&gt;  $ FinancialSatisfaction(Y3)   : num  -2.083 -1.295 0.392 -0.591 0.872 ...</span>
<span class="co">#&gt;  $ WorkloadSatisfaction(Y4)    : num  -0.553 -0.633 0.488 0.986 -1.424 ...</span>
<span class="co">#&gt;  $ CompanyIdentification(Y5)   : num  -1.7599 0.0725 0.4898 -0.0888 -0.7677 ...</span>
<span class="co">#&gt;  $ WorkTypeSatisfaction(Y6)    : num  -2.027 -0.38 -1.992 1.477 -0.404 ...</span>
<span class="co">#&gt;  $ GeneralSatisfaction(Y7)     : num  -2.304 1.19 1.591 0.793 -0.772 ...</span>
<span class="co">#&gt;  $ FeedbackQuality(X1)         : num  -0.347 -0.737 -0.382 0.432 -1.029 ...</span>
<span class="co">#&gt;  $ TaskSignificance(X2)        : num  -0.75 -1.038 -1.557 0.187 -0.627 ...</span>
<span class="co">#&gt;  $ TaskVariety(X3)             : num  -1.33 0.626 0.604 0.833 0.229 ...</span>
<span class="co">#&gt;  $ TaskIdentity(X4)            : num  -2.706 0.2 -1.308 1.335 0.177 ...</span>
<span class="co">#&gt;  $ Autonomy(X5)                : num  -1.815 0.673 -0.994 0.138 -0.508 ...</span>
<span class="co">#&gt;  - attr(*, &quot;spec&quot;)=List of 2</span>
<span class="co">#&gt;   ..$ cols   :List of 13</span>
<span class="co">#&gt;   .. ..$ ID                          : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_integer&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ SupervisorSatisfaction(Y1)  : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ CareerFutureSatisfaction(Y2): list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ FinancialSatisfaction(Y3)   : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ WorkloadSatisfaction(Y4)    : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ CompanyIdentification(Y5)   : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ WorkTypeSatisfaction(Y6)    : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ GeneralSatisfaction(Y7)     : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ FeedbackQuality(X1)         : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ TaskSignificance(X2)        : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ TaskVariety(X3)             : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ TaskIdentity(X4)            : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   .. ..$ Autonomy(X5)                : list()</span>
<span class="co">#&gt;   .. .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_double&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   ..$ default: list()</span>
<span class="co">#&gt;   .. ..- attr(*, &quot;class&quot;)= chr  &quot;collector_guess&quot; &quot;collector&quot;</span>
<span class="co">#&gt;   ..- attr(*, &quot;class&quot;)= chr &quot;col_spec&quot;</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Calcula la matriz de correlaciones muestrales basada en las 784 observaciones.</p></li>
<li><p>Encuentra los eigenvalores de <span class="math inline">\(\Sigma_{11}^{-1/2} \Sigma_{12} \Sigma_{22}^{-1} \Sigma_{21} \Sigma_{11}^{-1/2}\)</span> y verifica que estos eigenvalores son los mismos eigenvalores de <span class="math inline">\(\Sigma_{22}^{-1/2} \Sigma_{21} \Sigma_{11}^{-1} \Sigma_{12} \Sigma_{22}^{-1/2}\)</span>.</p></li>
<li><p>Calcula todas las correlaciones canónicas y las variables canónicas.</p></li>
<li><p>Reporta los coeficientes de las variables canónicas e interpreta el primer par de variables canónicas. Primero analiza qué variables contribuyen más a cada variable canónica. Para proporcionar interpretaciones de <span class="math inline">\(U_1\)</span> y <span class="math inline">\(V_1\)</span>, calcula las correlaciones muestrales entre <span class="math inline">\(U_1\)</span> y las variables que la componen y entre <span class="math inline">\(V_1\)</span> y sus variables respectivas. Además, haz una tabla que muestre las correlaciones entre las variables de un conjunto y la primera variable canónica del otro conjunto.</p></li>
<li><p>Sean <span class="math inline">\(Z^{(l)}\)</span> y <span class="math inline">\(Z^{(2)}\)</span> las variables estandarizadas correspondientes a <span class="math inline">\(X^{(1)}\)</span> y <span class="math inline">\(X^{(2)}\)</span>, respectivamente. ¿Qué proporción de la varianza muestral total de <span class="math inline">\(Z^{(1)}\)</span> se explica por la variable canónica <span class="math inline">\(U_1\)</span>? ¿Qué proporción de la varianza muestral total de <span class="math inline">\(Z^{(2)}\)</span> se explica por la variable canónica <span class="math inline">\(V_1\)</span>? Discute tus respuestas.</p></li>
</ol>
<div id="referencias--" class="section level4">
<h4><span class="header-section-number">15.5.0.1</span> Referencias {-}+</h4>
<ul>
<li>Dunham, R. B. (1977). Reactions to job characteristics: Moderating effects of the organization. Academy of Management Journal, 20(1), 42-65.</li>
</ul>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="componentes-principales-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="conglomerados-clustering-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
