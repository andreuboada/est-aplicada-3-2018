<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Estadística Aplicada III</title>
  <meta name="description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)">
  <meta name="generator" content="bookdown 0.7.1 and GitBook 2.6.7">

  <meta property="og:title" content="Estadística Aplicada III" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)" />
  <meta name="github-repo" content="andreuboada/est-aplicada-3-2018" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Estadística Aplicada III" />
  
  <meta name="twitter:description" content="Notas y material para el curso de Estadística Aplicada III, 2018 (ITAM)" />
  

<meta name="author" content="Andreu Boada de Atela">


<meta name="date" content="2018-02-22">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="manipulacion-y-visualizacion-de-datos.html">
<link rel="next" href="analisis-de-datos-categoricos.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="font-awesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Estadística Aplicada III</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Temario y referencias</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluacion"><i class="fa fa-check"></i>Evaluación</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-r-y-rstudio"><i class="fa fa-check"></i>Software: R y Rstudio</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#referencias-principales"><i class="fa fa-check"></i>Referencias principales</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#otras-referencias"><i class="fa fa-check"></i>Otras referencias</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#tareas"><i class="fa fa-check"></i>Tareas</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#por-que-un-analisis-multivariado"><i class="fa fa-check"></i><b>1.1</b> ¿Por qué un análisis multivariado?</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#la-paradoja-de-simpson"><i class="fa fa-check"></i><b>1.2</b> La paradoja de Simpson</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#modelos-log-lineales"><i class="fa fa-check"></i><b>1.3</b> Modelos log-lineales</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#interpretacion-de-parametros"><i class="fa fa-check"></i><b>1.4</b> Interpretación de parámetros</a><ul>
<li class="chapter" data-level="1.4.1" data-path="intro.html"><a href="intro.html#ejemplo-dos-monedas"><i class="fa fa-check"></i><b>1.4.1</b> Ejemplo: dos monedas</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#otros-ejemplos"><i class="fa fa-check"></i><b>1.5</b> Otros ejemplos</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#discriminacion-de-residentes-hispanos-con-discapacidades"><i class="fa fa-check"></i><b>1.5.1</b> Discriminación de residentes hispanos con discapacidades</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#consumo-de-chocolate-y-premios-nobel"><i class="fa fa-check"></i><b>1.5.2</b> Consumo de chocolate y premios Nobel</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#tarea"><i class="fa fa-check"></i><b>1.6</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Rintro.html"><a href="Rintro.html"><i class="fa fa-check"></i><b>2</b> Temas selectos de R</a><ul>
<li class="chapter" data-level="2.1" data-path="Rintro.html"><a href="Rintro.html#que-ventajas-tiene-r"><i class="fa fa-check"></i><b>2.1</b> ¿Qué ventajas tiene R?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="Rintro.html"><a href="Rintro.html#r-es-gratuito-y-de-codigo-abierto"><i class="fa fa-check"></i><b>2.1.1</b> R es gratuito y de código abierto</a></li>
<li class="chapter" data-level="2.1.2" data-path="Rintro.html"><a href="Rintro.html#r-tiene-una-comunidad-comprometida"><i class="fa fa-check"></i><b>2.1.2</b> R tiene una comunidad comprometida</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="Rintro.html"><a href="Rintro.html#flujo-basico-de-trabajo-para-el-analisis-de-datos-en-r."><i class="fa fa-check"></i><b>2.2</b> Flujo básico de trabajo para el análisis de datos en R.</a></li>
<li class="chapter" data-level="2.3" data-path="Rintro.html"><a href="Rintro.html#introduccion-a-r-como-lenguaje-de-programacion-y-la-plataforma-interactiva-de-rstudio."><i class="fa fa-check"></i><b>2.3</b> Introducción a R como lenguaje de programación, y la plataforma interactiva de RStudio.</a><ul>
<li class="chapter" data-level="2.3.1" data-path="Rintro.html"><a href="Rintro.html#como-entender-r"><i class="fa fa-check"></i><b>2.3.1</b> ¿Cómo entender R?</a></li>
<li class="chapter" data-level="2.3.2" data-path="Rintro.html"><a href="Rintro.html#por-que-r"><i class="fa fa-check"></i><b>2.3.2</b> ¿Por qué R?</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Rintro.html"><a href="Rintro.html#estructuras-de-datos"><i class="fa fa-check"></i><b>2.4</b> Estructuras de datos</a><ul>
<li class="chapter" data-level="2.4.1" data-path="Rintro.html"><a href="Rintro.html#vectores"><i class="fa fa-check"></i><b>2.4.1</b> Vectores</a></li>
<li class="chapter" data-level="2.4.2" data-path="Rintro.html"><a href="Rintro.html#data-frames"><i class="fa fa-check"></i><b>2.4.2</b> Data Frames</a></li>
<li class="chapter" data-level="2.4.3" data-path="Rintro.html"><a href="Rintro.html#listas"><i class="fa fa-check"></i><b>2.4.3</b> Listas</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="Rintro.html"><a href="Rintro.html#r-markdown"><i class="fa fa-check"></i><b>2.5</b> R Markdown</a><ul>
<li class="chapter" data-level="2.5.1" data-path="Rintro.html"><a href="Rintro.html#que-es-r-markdown"><i class="fa fa-check"></i><b>2.5.1</b> ¿Qué es R Markdown?</a></li>
<li class="chapter" data-level="2.5.2" data-path="Rintro.html"><a href="Rintro.html#estructura-basica-de-r-markdown"><i class="fa fa-check"></i><b>2.5.2</b> Estructura básica de R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="Rintro.html"><a href="Rintro.html#proyectos-de-rstudio"><i class="fa fa-check"></i><b>2.6</b> Proyectos de RStudio</a></li>
<li class="chapter" data-level="2.7" data-path="Rintro.html"><a href="Rintro.html#otros-aspectos-importantes-de-r"><i class="fa fa-check"></i><b>2.7</b> Otros aspectos importantes de R</a><ul>
<li class="chapter" data-level="2.7.1" data-path="Rintro.html"><a href="Rintro.html#valores-faltantes"><i class="fa fa-check"></i><b>2.7.1</b> Valores faltantes</a></li>
<li class="chapter" data-level="2.7.2" data-path="Rintro.html"><a href="Rintro.html#funciones"><i class="fa fa-check"></i><b>2.7.2</b> Funciones</a></li>
<li class="chapter" data-level="2.7.3" data-path="Rintro.html"><a href="Rintro.html#funcionales"><i class="fa fa-check"></i><b>2.7.3</b> Funcionales</a></li>
<li class="chapter" data-level="2.7.4" data-path="Rintro.html"><a href="Rintro.html#rendimiento-en-r"><i class="fa fa-check"></i><b>2.7.4</b> Rendimiento en R</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="Rintro.html"><a href="Rintro.html#tarea-1"><i class="fa fa-check"></i><b>2.8</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html"><i class="fa fa-check"></i><b>3</b> Manipulación y visualización de datos</a><ul>
<li class="chapter" data-level="3.1" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#el-principio-de-datos-limpios"><i class="fa fa-check"></i><b>3.1</b> El principio de datos limpios</a><ul>
<li class="chapter" data-level="" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#ejemplo"><i class="fa fa-check"></i>Ejemplo:</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#limpieza-de-datos"><i class="fa fa-check"></i><b>3.2</b> Limpieza de datos</a></li>
<li class="chapter" data-level="3.3" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#separa-aplica-combina"><i class="fa fa-check"></i><b>3.3</b> <em>Separa-aplica-combina</em></a></li>
<li class="chapter" data-level="3.4" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#muertes-por-armas-de-fuego-en-eua"><i class="fa fa-check"></i><b>3.4</b> Muertes por armas de fuego en EUA</a></li>
<li class="chapter" data-level="3.5" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#el-cuarteto-de-anscombe"><i class="fa fa-check"></i><b>3.5</b> El Cuarteto de Anscombe</a></li>
<li class="chapter" data-level="3.6" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#the-grammar-of-graphics-de-leland-wilkinson"><i class="fa fa-check"></i><b>3.6</b> The <em>Grammar of Graphics</em> de Leland Wilkinson</a></li>
<li class="chapter" data-level="3.7" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#ggplot"><i class="fa fa-check"></i><b>3.7</b> ggplot</a></li>
<li class="chapter" data-level="3.8" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#un-histograma-de-las-muertes-en-iraq"><i class="fa fa-check"></i><b>3.8</b> Un histograma de las muertes en Iraq</a></li>
<li class="chapter" data-level="3.9" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#inglehartwelzel-un-mapa-cultural-del-mundo"><i class="fa fa-check"></i><b>3.9</b> Inglehart–Welzel: un mapa cultural del mundo</a><ul>
<li class="chapter" data-level="3.9.1" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#creando-un-ggplot"><i class="fa fa-check"></i><b>3.9.1</b> Creando un ggplot</a></li>
<li class="chapter" data-level="3.9.2" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#mapeos-aesthetics"><i class="fa fa-check"></i><b>3.9.2</b> Mapeos: Aesthetics</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#poniendo-todo-junto"><i class="fa fa-check"></i><b>3.10</b> Poniendo todo junto</a></li>
<li class="chapter" data-level="3.11" data-path="manipulacion-y-visualizacion-de-datos.html"><a href="manipulacion-y-visualizacion-de-datos.html#tarea-2"><i class="fa fa-check"></i><b>3.11</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html"><i class="fa fa-check"></i><b>4</b> Teorema del Límite Central</a><ul>
<li class="chapter" data-level="4.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#la-distribucion-de-la-media"><i class="fa fa-check"></i><b>4.1</b> La distribución de la media</a></li>
<li class="chapter" data-level="4.2" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#de-donde-proviene-la-distribucion-normal"><i class="fa fa-check"></i><b>4.2</b> ¿De dónde proviene la distribución normal?</a><ul>
<li class="chapter" data-level="4.2.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#que-signo-tiene-c"><i class="fa fa-check"></i><b>4.2.1</b> ¿Qué signo tiene c?</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#otras-observaciones"><i class="fa fa-check"></i><b>4.3</b> Otras observaciones</a></li>
<li class="chapter" data-level="4.4" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#diagramas-de-caja-y-brazos"><i class="fa fa-check"></i><b>4.4</b> Diagramas de caja y brazos</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-de-cuantiles-teoricos"><i class="fa fa-check"></i><b>4.5</b> Gráficas de cuantiles teóricos</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-normal"><i class="fa fa-check"></i>Ejemplo: normal</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-de-cuantiles-para-un-conjunto-de-datos"><i class="fa fa-check"></i><b>4.6</b> Gráficas de cuantiles para un conjunto de datos</a><ul>
<li class="chapter" data-level="4.6.1" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#que-buscar-en-una-grafica-de-cuantiles"><i class="fa fa-check"></i><b>4.6.1</b> ¿Qué buscar en una gráfica de cuantiles?</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#graficas-qq-normales"><i class="fa fa-check"></i><b>4.7</b> Gráficas qq-normales</a><ul>
<li class="chapter" data-level="" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-cantantes"><i class="fa fa-check"></i>Ejemplo: cantantes</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#el-tlc-y-errores-estandar"><i class="fa fa-check"></i><b>4.8</b> El TLC y errores estándar</a></li>
<li class="chapter" data-level="4.9" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#ejemplo-2"><i class="fa fa-check"></i><b>4.9</b> Ejemplo</a></li>
<li class="chapter" data-level="4.10" data-path="teorema-del-limite-central.html"><a href="teorema-del-limite-central.html#tarea-3"><i class="fa fa-check"></i><b>4.10</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html"><i class="fa fa-check"></i><b>5</b> Análisis de datos categóricos</a><ul>
<li class="chapter" data-level="5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#repaso-y-algunos-conceptos"><i class="fa fa-check"></i><b>5.1</b> Repaso y algunos conceptos</a><ul>
<li class="chapter" data-level="5.1.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#caso-binomial"><i class="fa fa-check"></i><b>5.1.1</b> Caso binomial</a></li>
<li class="chapter" data-level="" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#estimacion-de-parametros-multinomiales"><i class="fa fa-check"></i>Estimación de parámetros multinomiales</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-chi2-de-pearson-de-una-multinomial"><i class="fa fa-check"></i><b>5.2</b> La <span class="math inline">\(\chi^2\)</span> de Pearson de una multinomial</a><ul>
<li class="chapter" data-level="5.2.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#cociente-de-verosimilitud-de-una-multinomial"><i class="fa fa-check"></i><b>5.2.1</b> Cociente de verosimilitud de una multinomial</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#definiciones"><i class="fa fa-check"></i><b>5.3</b> Definiciones</a><ul>
<li class="chapter" data-level="5.3.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#notacion"><i class="fa fa-check"></i><b>5.3.1</b> Notación</a></li>
<li class="chapter" data-level="5.3.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#razon-de-momios"><i class="fa fa-check"></i><b>5.3.2</b> Razón de momios</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#asociacion-en-tablas-de-tamano-itimes-j"><i class="fa fa-check"></i><b>5.4</b> Asociación en tablas de tamaño <span class="math inline">\(I\times J\)</span></a><ul>
<li class="chapter" data-level="5.4.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#razones-de-momios-en-tablas-itimes-j"><i class="fa fa-check"></i><b>5.4.1</b> Razones de momios en tablas <span class="math inline">\(I\times J\)</span></a></li>
<li class="chapter" data-level="5.4.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-mushrooms"><i class="fa fa-check"></i><b>5.4.2</b> Ejemplo: mushrooms</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#intervalos-de-confianza-para-los-parametros-de-asociacion"><i class="fa fa-check"></i><b>5.5</b> Intervalos de confianza para los parámetros de asociación</a><ul>
<li class="chapter" data-level="5.5.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#error-estandar-de-la-razon-de-momios"><i class="fa fa-check"></i><b>5.5.1</b> Error estándar de la razón de momios</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#prueba-de-independencia"><i class="fa fa-check"></i><b>5.6</b> Prueba de independencia</a><ul>
<li class="chapter" data-level="5.6.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-prueba-chi2-de-pearson"><i class="fa fa-check"></i><b>5.6.1</b> La prueba <span class="math inline">\(\chi^2\)</span> de Pearson</a></li>
<li class="chapter" data-level="5.6.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-brecha-de-genero"><i class="fa fa-check"></i><b>5.6.2</b> Ejemplo: brecha de género</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#general-social-survey-1972---2016"><i class="fa fa-check"></i><b>5.7</b> General Social Survey 1972 - 2016</a></li>
<li class="chapter" data-level="5.8" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#la-catadora-de-te"><i class="fa fa-check"></i><b>5.8</b> La catadora de té</a></li>
<li class="chapter" data-level="5.9" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-multinomiales-para-conteos"><i class="fa fa-check"></i><b>5.9</b> Modelos multinomiales para conteos</a></li>
<li class="chapter" data-level="5.10" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#modelos-log-lineales-con-tres-variables-categoricas"><i class="fa fa-check"></i><b>5.10</b> Modelos log lineales con tres variables categóricas</a><ul>
<li class="chapter" data-level="5.10.1" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tipos-de-independencia"><i class="fa fa-check"></i><b>5.10.1</b> Tipos de independencia</a></li>
<li class="chapter" data-level="5.10.2" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#asociacion-homogenea-e-interacciones-de-3-factores"><i class="fa fa-check"></i><b>5.10.2</b> Asociación homogénea e interacciones de 3 factores</a></li>
</ul></li>
<li class="chapter" data-level="5.11" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-sensitividad-y-especificidad"><i class="fa fa-check"></i><b>5.11</b> Ejemplo: sensitividad y especificidad</a></li>
<li class="chapter" data-level="5.12" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#ejemplo-horoscopos"><i class="fa fa-check"></i><b>5.12</b> Ejemplo: horóscopos</a></li>
<li class="chapter" data-level="5.13" data-path="analisis-de-datos-categoricos.html"><a href="analisis-de-datos-categoricos.html#tarea-opcional"><i class="fa fa-check"></i><b>5.13</b> Tarea (opcional)</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regresion-logistica.html"><a href="regresion-logistica.html"><i class="fa fa-check"></i><b>6</b> Regresión logística</a><ul>
<li class="chapter" data-level="6.1" data-path="regresion-logistica.html"><a href="regresion-logistica.html#regresion-logistica-con-un-solo-predictor"><i class="fa fa-check"></i><b>6.1</b> Regresión logística con un solo predictor</a></li>
<li class="chapter" data-level="6.2" data-path="regresion-logistica.html"><a href="regresion-logistica.html#el-modelo-de-regresion-logistica"><i class="fa fa-check"></i><b>6.2</b> El modelo de regresión logística</a><ul>
<li class="chapter" data-level="6.2.1" data-path="regresion-logistica.html"><a href="regresion-logistica.html#funcion-logistica"><i class="fa fa-check"></i><b>6.2.1</b> Función logística</a></li>
<li class="chapter" data-level="" data-path="regresion-logistica.html"><a href="regresion-logistica.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="regresion-logistica.html"><a href="regresion-logistica.html#tarea-4"><i class="fa fa-check"></i><b>6.3</b> Tarea</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Estadística Aplicada III</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="teorema-del-limite-central" class="section level1">
<h1><span class="header-section-number">Clase 4</span> Teorema del Límite Central</h1>
<style>
  .espacio {
     margin-bottom: 1cm;
  }
</style>
<style>
  .espacio3 {
     margin-bottom: 3cm;
  }
</style>
<p>A continuación discutiremos el Teorema del Límite Central (CLT), el cual nos ayuda a realizar cálculos importantes relacionados con la probabilidad de las cosas. Se utiliza con frecuencia en la ciencia para probar hipótesis estadísticas.</p>
<p>Para utilizarlo, tenemos que hacer diferentes supuestos. Sin embargo, si los supuestos son verdaderos, entonces podemos calcular probabilidades exactas de eventos mediante el uso de una fórmula matemática muy sencilla.</p>
<div id="la-distribucion-de-la-media" class="section level2">
<h2><span class="header-section-number">4.1</span> La distribución de la media</h2>

<div class="nota">
<p><strong><em>El Teorema del Límite Central</em></strong></p>
El CLT es uno de los resultados matemáticos más utilizados en la ciencia. Nos dice que cuando el tamaño de la muestra es grande, la media <span class="math inline">\(\bar{Y}\)</span> de una muestra aleatoria sigue una distribución normal con centro en la media poblacional <span class="math inline">\(\mu_Y\)</span> y con desviación estándar igual a la desviación estándar de la población <span class="math inline">\(\sigma_Y\)</span> <strong>dividida por la raíz cuadrada del tamaño de la muestra</strong> <span class="math inline">\(\sqrt{N}\)</span>. Nos referimos a la desviación estándar de la distribución de una variable aleatoria como el error estándar de la variable aleatoria.
</div>

<p><br></p>
<p>Si tomamos muchas muestras de tamaño <span class="math inline">\(N\)</span>, entonces la cantidad:</p>
<p><span class="math display">\[
\frac{\bar{Y} - \mu}{\sigma_Y/\sqrt{N}}
\]</span></p>
<p>se aproxima con una distribución normal con centro en 0 y con desviación estándar 1.</p>
<p>Ahora nos interesa la diferencia entre dos medias muestrales. Aquí, de nuevo, un resultado matemático nos puede ayudar. Si tenemos dos variables aleatorias <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> con medias <span class="math inline">\(\mu_X\)</span> y <span class="math inline">\(\mu_Y\)</span> y varianzas <span class="math inline">\(\sigma_X\)</span> y <span class="math inline">\(\sigma_Y\)</span> respectivamente, entonces tenemos el siguiente resultado: la media de la suma <span class="math inline">\(Y + X\)</span> es la suma de las medias <span class="math inline">\(\mu_Y + \mu_X\)</span>. Esto implica que la media de <span class="math inline">\(Y - X = Y + aX\)</span> con <span class="math inline">\(a = -1\)</span>, es <span class="math inline">\(\mu_Y - \mu_X\)</span>.</p>
<p>Sin embargo, el siguiente resultado quizás no sea tan intuitivo. Si <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> son independientes entre sí, entonces la varianza de <span class="math inline">\(Y + X\)</span> es la suma de las varianzas <span class="math inline">\(\sigma_Y^2 + \sigma_X^2\)</span>. Esto implica que la varianza de la diferencia <span class="math inline">\(Y - X\)</span> es la varianza de <span class="math inline">\(Y + aX\)</span> con <span class="math inline">\(a = -1\)</span> que es <span class="math inline">\(\sigma^2_Y + a^2\sigma_X^2 = \sigma ^ 2_Y + \sigma_X ^ 2\)</span>. Así que la varianza de la diferencia es también la suma de las varianzas. Si esto parece un resultado contraintuitivo, recordemos que si <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> son independientes entre sí, el signo realmente no importa. Finalmente, otro resultado útil es que la suma de variables normales (mutuamente independientes) es otra vez normal.</p>
<p>El cociente</p>
<p><span class="math display">\[
\frac{(\bar{Y}-\bar{X}) - (\mu_Y - \mu_X)}{\sqrt{\frac{\sigma_X^2}{M} + \frac{\sigma_Y^2}{N}}}
\]</span></p>
<p>se aproxima por una distribución normal centrada en 0 y con desviación estándar 1. Usando esta aproximación, el cálculo de probabilidades es simples porque conocemos la proporción de la distribución bajo cualquier valor. Por ejemplo, sólo el 5% de estos valores son mayores que 2 (en valor absoluto):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pnorm</span>(<span class="op">-</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">2</span>))
<span class="co">#&gt; [1] 0.0455</span></code></pre></div>
<hr />
<p><br></p>
</div>
<div id="de-donde-proviene-la-distribucion-normal" class="section level2">
<h2><span class="header-section-number">4.2</span> ¿De dónde proviene la distribución normal?</h2>
<p>En 1894, Francis Galton inventó lo que ahora conocemos como <strong>tablero de Galton</strong>, para ilustrar el Teorema del Límite Central, y en particular, que la distribución binomial es una aproximación a la distribución normal. El tablero consta de una tablero vertical con varias filas de clavos acomodados en forma de arreglo triangular. En la parte inferior hay varias cubetas para cada posible camino que forman los clavos en el tablero. Se deja caer canicas desde la parte superior, las cuales van botando, rebotando y saltando, aleatoriamente, y van depositándose, a medida que caen, en las cubetas de la parte inferior.</p>
<p>Las canicas chocarán con el primer clavo teniendo una probabilidad de <span class="math inline">\(1/2\)</span> de ir a la izquierda o la derecha. A medida que caen, cada canica tiene más caminos a donde ir, es decir más posibilidades para desviarse a la izquiera o a la derecha. A lo largo de esta estructura, las canicas toman caminos aleatorios hasta caer en alguna de las cubetas. Es consecuencia de las leyes del universo que está sostenido por una tela sobre la cual subyace lo aleatorio, que las canicas caen con mayor probabilidad en las cubetas que están al centro, mientras que la probabilidad de que caigan en cubetas más alejadas es cada vez menor cuando la canica se aleja más y más de la cubeta del centro.</p>
<p class="espacio">
</p>
<p><img src="figuras/galton.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
<p><img src="figuras/galton_70.gif" width="40%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>

<div class="information">
<strong>Nota:</strong> Puedes ver el script para hacer la simulación del tablero de Galton <a href="https://github.com/andreuboada/est-aplicada-3-2018/blob/master/recursos/tablero_galton.r">aquí</a>.
</div>

<p><br></p>
<p>La primera versión de este teorema fue postulada por el matemático francés Abraham De Moivre que, en un notable artículo publicado en 1733, usó la distribución normal para aproximar la distribución del número de soles resultante de muchos lanzamientos de una moneda justa. Este hallazgo estaba muy por delante de su tiempo y permaneció en el olvido hasta que el famoso matemático francés Pierre-Simon Laplace lo rescató de la oscuridad en su monumental obra <strong>Théorie analytique des probabilités</strong>, publicada en 1812. Laplace extendió el hallazgo de De Moivre al aproximar la distribución binomial en general con la distribución normal. El teorema en su forma más general fue demostrado por primera vez por el príncipe de las matemáticas, Carl Friedrich Gauss, en 1813. Hoy en día es conocida en su honor como <strong>distribución Gaussiana</strong>, cuando en su tiempo no era más que la <strong>ley del error</strong>.</p>
<p>Supongamos que <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span> son errores <strong>independientes</strong> cometidos al azar cuando se han hecho dos mediciones <strong>independientemente</strong> una de la otra.</p>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-8-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p><br></p>
De tal forma que se cumple que <span class="math display">\[
g(r) \Delta x \Delta y = f(x) \Delta x f(y) \Delta y,
\]</span> por lo cual <span class="math display">\[
g(r) = f(x)f(y).
\]</span> Esto significa nada más que la magnitud del error <span class="math inline">\(g(r)\)</span> es el producto de las magnitudes de los errores en <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span> <strong>de forma independiente</strong>. Las coordenadas <span class="math inline">\(x\)</span>,<span class="math inline">\(y\)</span> son tales que <span class="math display">\[
x = r \cos(\theta), \; \;\; y = r\mbox{sen}(\theta).
\]</span> Sabemos que
<span class="math display">\[\begin{eqnarray*}
\dfrac{dx}{d\theta} &amp;=&amp; -r\mbox{sen}(\theta)\\
\dfrac{dy}{d\theta} &amp;=&amp; r \cos{(\theta)}
\end{eqnarray*}\]</span>
Derivando con respecto a <span class="math inline">\(\theta\)</span>: 
<span class="math display">\[\begin{eqnarray*}
0 &amp;=&amp; \dfrac{d f(x)}{d \theta} f(y) + \dfrac{d f(y)}{d \theta} f(x)\\
&amp;=&amp; \dfrac{df}{dx}\cdot \dfrac{d x}{d \theta}\cdot f(y) + \dfrac{d f}{d y}\cdot\dfrac{d y}{d\theta} \cdot f(x) \\
&amp;=&amp; -r f^\prime(x) \mbox{sen}(\theta)f(y) + f^\prime(y)\cdot r \cos(\theta) f(x)\\
&amp;=&amp; -y f^\prime(x)f(y) + xf^\prime(y)f(x).
\end{eqnarray*}\]</span>
<p>Por lo tanto, <span class="math display">\[
yf^\prime(x)f(y) = x f^\prime(y)f(x).
\]</span> Se tiene que <span class="math display">\[
\dfrac{f^\prime(x)}{f(x)x} = \dfrac{f^\prime(y)}{f(y)y},
\]</span> para toda <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span>. Como <span class="math inline">\(x\)</span> y <span class="math inline">\(y\)</span> son mediciones arbitrarias, esto implica que <span class="math display">\[
\dfrac{f^\prime(x)}{f(x)x}
\]</span> debe ser constante. Por lo tanto, <span class="math display">\[
\displaystyle{\int{\dfrac{f^\prime(x)}{f(x)x}}\,dx = \int{c \,dx}}. 
\]</span> Multiplicando por <span class="math inline">\(x\)</span>, <span class="math display">\[
\displaystyle{\int{\dfrac{f^\prime(x)}{f(x)}}\,dx = \int{cx\, dx}}. 
\]</span> Por lo cual, <span class="math display">\[
\mbox{ln}f(x) = c\cdot \dfrac{x^2}{2} + c^\prime.
\]</span></p>
<div id="que-signo-tiene-c" class="section level3">
<h3><span class="header-section-number">4.2.1</span> ¿Qué signo tiene c?</h3>
Vemos que <span class="math display">\[
f(x) = Ae^{c\frac{x^2}{2}},
\]</span> donde <span class="math inline">\(A=e^{c^\prime}\)</span>. Como <span class="math inline">\(f(x)\)</span> es la función de densidad de este fenómeno de errores independientes entonces se debe cumplir que: <span class="math display">\[
1 = \displaystyle{\int f(x)\, dx},
\]</span> y podemos concluir que <span class="math inline">\(c&lt;0\)</span>, para que <span class="math inline">\(f(x)\)</span> pueda ser función de densidad. Integramos: <span class="math display">\[
A \displaystyle{\int{e^{c\cdot \frac{x^2}{2}}}\, dx}.
\]</span> Sea <span class="math inline">\(u=\sqrt{-\dfrac{c}{2}}x\)</span>, entonces <span class="math inline">\(du = \sqrt{-\dfrac{c}{2}}\,dx\)</span>. Por lo cual, <span class="math display">\[
1 = A\sqrt{-\dfrac{2}{c}} \displaystyle{\int_{-\infty}^{\infty}{e^{-u^2}}\,du = A \sqrt{-\dfrac{2}{c}} \cdot \sqrt{\pi}}.
\]</span> Para obtener lo anterior, se desea demostrar que <span class="math display">\[
\boxed{\int_0^\infty{e^{-x^2}dx} = \dfrac{\sqrt{\pi}}{2}.}
\]</span> Sea <span class="math display">\[
I = \int_{-\infty}^\infty{e^{-x^2}dx}, 
\]</span> entonces <span class="math display">\[
I^2=\left(\int_{-\infty}^\infty{e^{-x^2}dx}\right)\left(\int_{-\infty}^\infty{e^{-y^2}dy}\right)=\int_{-\infty}^\infty{\int_{-\infty}^{\infty}{e^{-(x^2+y^2)}dxdy}}.
\]</span> Si <span class="math inline">\(x=r\mbox{cos}(\theta)\)</span> y <span class="math inline">\(y=r\mbox{sen}(\theta)\)</span> entonces <span class="math inline">\(x^2+y^2=r^2\)</span> y se puede demostrar que <span class="math inline">\(dxdy=rd\theta dr\)</span>. Por lo tanto,
<span class="math display">\[\begin{eqnarray*}
I^2&amp;=&amp;\int_{-\infty}^\infty{\int_{-\infty}^{\infty}{e^{-(x^2+y^2)}dxdy}}\\
&amp;=&amp;\int_{0}^\infty{\int_{0}^{2\pi}{re^{-r^2}d\theta dr}}\\
&amp;=&amp;-\pi\int_{0}^{\infty}{-2re^{-r^2}dr}\\
&amp;=&amp;-\pi e^{-r^2}{\biggr\rvert_{0}^{\infty}}\\
&amp;=&amp;\pi.
\end{eqnarray*}\]</span>
<p>Por lo cual, <span class="math inline">\(I=\sqrt{\pi}\)</span>. Como <span class="math inline">\(e^{-x^2}\)</span> es una función simétrica alrededor de <span class="math inline">\(0\)</span>, entonces se tiene, finalmente, que <span class="math display">\[
\int_{0}^{\infty}{e^{-x^2}dx}=\dfrac{1}{2}\int_{-\infty}^{\infty}{e^{-x^2}dx}=\dfrac{\sqrt{\pi}}{2}.
\]</span></p>
<p>Finalmente, <span class="math display">\[
1 =A \sqrt{-\dfrac{2}{c}} \cdot \sqrt{\pi},
\]</span> y despejando <span class="math inline">\(A\)</span>, obtenemos que <span class="math display">\[
A = \sqrt{-\dfrac{c}{2\pi}}.
\]</span></p>
Sean <span class="math inline">\(\mu\)</span>, el valor esperado de <span class="math inline">\(X\)</span>, y <span class="math inline">\(\sigma^2\)</span> la varianza de <span class="math inline">\(X\)</span>, <span class="math inline">\(E(X)\)</span> y <span class="math inline">\(V(X)\)</span>, respectivamente. Vemos que 
<span class="math display">\[\begin{eqnarray*}
E(X) &amp;=&amp; \displaystyle{\int_{-\infty}^{\infty}{Ax e^{c\frac{x^2}{2}}}\, dx}\\
&amp;=&amp; \sqrt{-\dfrac{c}{2\pi}}\displaystyle{\int_{-\infty}^\infty{xe^{c\frac{x^2}{2}}}\,dx}.
\end{eqnarray*}\]</span>
Por lo tanto, <span class="math display">\[
E(X) = -\dfrac{1}{c} \sqrt{-\dfrac{c}{2\pi}}\,e^{c\frac{x^2}{2}}{\biggr\rvert_{-\infty}^{\infty}}=0.
\]</span> Ahora bien, <span class="math display">\[
E(X^2) = V(X).
\]</span> Tenemos que <span class="math display">\[
E(X^2) = \sqrt{-\dfrac{c}{2\pi}} \displaystyle{\int_{-\infty}^\infty{x^2e^{c\frac{x^2}{2}}}\,dx}.
\]</span> Integrando por partes (con <span class="math inline">\(u=x\)</span> y <span class="math inline">\(dv = xe^{c\frac{x^2}{2}}\,dx\)</span>) ahora obtenemos
<span class="math display">\[\begin{eqnarray*}
\sigma^2 = V(X) &amp;=&amp; \sqrt{-\dfrac{c}{2\pi}} \left(\dfrac{1}{c}xe^{cx^2/2}{\biggr\rvert_{-\infty}^{\infty}} - \dfrac{1}{c}\displaystyle{\int_{-\infty}^{\infty}{e^{c{x^2/2}}\,dx}}\right) \\
&amp;=&amp; \sqrt{-\dfrac{c}{2\pi}} \left(-\dfrac{1}{c}\displaystyle{\int_{-\infty}^{\infty}{e^{cx^2/2}}\,dx}\right) \\
&amp;=&amp; \sqrt{-\dfrac{c}{2\pi}} \cdot \left(\dfrac{1}{c}\right) \cdot \sqrt{-\dfrac{2\pi}{c}}.
\end{eqnarray*}\]</span>
<p>Por lo cual, <span class="math display">\[
c = - \dfrac{1}{\sigma^2}.
\]</span> Finalmente, la distribución de <span class="math inline">\(X\)</span> con media <span class="math inline">\(0\)</span> y varianza <span class="math inline">\(\sigma^2\)</span> es <span class="math display">\[
f(x) = \dfrac{1}{\sqrt{2\pi\sigma^2}}\,e^{-\frac{1}{2\sigma^2}x^2}.
\]</span> Si ahora la media es <span class="math inline">\(\mu\)</span>, entonces <span class="math display">\[
f(x) = \dfrac{1}{\sqrt{2\pi\sigma^2}}\,e^{-\frac{1}{2\sigma^2}(x-\mu)^2}.
\]</span></p>
</div>
</div>
<div id="otras-observaciones" class="section level2">
<h2><span class="header-section-number">4.3</span> Otras observaciones</h2>
Otras propiedades de esta distribución se pueden obtener buscando los puntos críticos de su función de densidad <span class="math display">\[
f(x) = Ae^{cx^2/2}.
\]</span> La primera derivada es <span class="math display">\[
f^\prime(x) = A e^{cx^2/2}\cdot cx.
\]</span> Por lo que <span class="math inline">\(f^\prime(x)=0\)</span> cuando <span class="math inline">\(x=0\)</span>. La segunda derivada es <span class="math display">\[
f^{\prime\prime}(x) = cA\left(e^{cx^2/2}+xe^{cx^2/2}\cdot cx\right).
\]</span> Por lo tanto,
<span class="math display">\[\begin{eqnarray*}
f^{\prime\prime}(0) &amp;=&amp; cA \\
&amp;=&amp; c\sqrt{-\dfrac{c}{2\pi}} \\
&amp;=&amp; \sqrt{\dfrac{1}{2\pi\sigma^2}} &gt; 0.
\end{eqnarray*}\]</span>
<p>Por lo tanto, si <span class="math inline">\(\sigma^2 = 1\)</span>, entonces el máximo de <span class="math inline">\(f(x)\)</span> se alcanza en <span class="math inline">\(x=0\)</span>, que coincide con la media, y el valor de <span class="math inline">\(f\)</span> en <span class="math inline">\(x=0\)</span> es <span class="math display">\[
\sqrt{\dfrac{1}{2\pi}} \approx 0.3989.
\]</span> Ahora bien, <span class="math inline">\(f^{\prime\prime}(0) = 0\)</span> si y sólo si <span class="math display">\[
e^{cx^2/2} = -cx^2 e^{cx^2/2},
\]</span> que ocurre si y sólo si <span class="math display">\[
x = \pm \sigma.
\]</span> Esto quiere decir que <span class="math inline">\(f(x)\)</span> tiene puntos de inflexión en <span class="math inline">\(-\sigma\)</span> y <span class="math inline">\(\sigma\)</span>.</p>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-9-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="diagramas-de-caja-y-brazos" class="section level2">
<h2><span class="header-section-number">4.4</span> Diagramas de caja y brazos</h2>
<p>Los diagramas de caja y brazos son muy populares, e intentan mostrar gráficamente algo similar al resumen de cinco números de Tukey:</p>
</br> <a href="https://upload.wikimedia.org/wikipedia/commons/thumb/2/25/Boxplot.svg/457px-Boxplot.svg.png"> <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/2/25/Boxplot.svg/457px-Boxplot.svg.png" width="300px">
<p>
Imagen de Wikipedia.
</p>
<p></a> </br></p>
<p>Como vemos en la imagen superior el método muestra la mediana como una línea horizontal (medida de tendencia central), los bordes de la caja indican los cuartiles inferior y superior (o cuantiles 0.25 y 0.75). La distancia entre estos dos se conoce como rango intercuartílico o <em>IQR</em> por sus siglas en inglés, el IQR es una medida de dispersión. Alrededor del 50% de los datos están entre los cuartiles inferior y superior, es así que si el rango intercuartílico es chico los datos de enmedio están muy cercanos alrededor de la mediana, si el rango intercunatílico es grande los datos de enmedio están dispersos alrededor de la mediana. Adicionalmente, las distancias relativas de los cuartiles a lamediana nos dan información de la forma de la distribución, si una es mayor a la otra la distribucción está sesgada.</p>
<p>Las líneas punteadas del diagrama superior indican los <em>valores adyacentes</em>, el valor adyacente superior se calcula de la siguiente forma: se toma el dato más grande que está a no más de <span class="math inline">\(1.5IQR\)</span> del cuartil superior. Los valores adyacentes también nos dan un resumen de la forma y dispersión, pero lo hacen para los valores extremos, o colas de la distribución.</p>
<p>Finalmente, los datos mayores (o menores) a los valores adyacentes se grafican de manera individual como puntos. Si hay datos atípicos suelen aparecer como estos puntos graficados individualmente.</p>
<div id="ejemplo-1" class="section level3 unnumbered">
<h3>Ejemplo</h3>
<p>En el caso de los cantantes obtenemos la siguiente gráfica:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(lattice)
<span class="kw">library</span>(tidyverse)
<span class="co"># calculamos la estatura en centímetros</span>
singer<span class="op">$</span>estatura.m &lt;-<span class="st"> </span>singer<span class="op">$</span>height <span class="op">*</span><span class="st"> </span><span class="fl">2.54</span></code></pre></div>
<p>Veamos la estructura de los datos:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">singer <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">height</th>
<th align="left">voice.part</th>
<th align="right">estatura.m</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>19</td>
<td align="right">62</td>
<td align="left">Soprano 1</td>
<td align="right">157</td>
</tr>
<tr class="even">
<td>196</td>
<td align="right">75</td>
<td align="left">Bass 1</td>
<td align="right">190</td>
</tr>
<tr class="odd">
<td>140</td>
<td align="right">65</td>
<td align="left">Tenor 1</td>
<td align="right">165</td>
</tr>
<tr class="even">
<td>37</td>
<td align="right">63</td>
<td align="left">Soprano 2</td>
<td align="right">160</td>
</tr>
<tr class="odd">
<td>2</td>
<td align="right">62</td>
<td align="left">Soprano 1</td>
<td align="right">157</td>
</tr>
<tr class="even">
<td>108</td>
<td align="right">64</td>
<td align="left">Alto 2</td>
<td align="right">163</td>
</tr>
<tr class="odd">
<td>114</td>
<td align="right">67</td>
<td align="left">Alto 2</td>
<td align="right">170</td>
</tr>
<tr class="even">
<td>67</td>
<td align="right">65</td>
<td align="left">Alto 1</td>
<td align="right">165</td>
</tr>
<tr class="odd">
<td>167</td>
<td align="right">68</td>
<td align="left">Tenor 2</td>
<td align="right">173</td>
</tr>
<tr class="even">
<td>175</td>
<td align="right">73</td>
<td align="left">Bass 1</td>
<td align="right">185</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">singer.medians &lt;-<span class="st"> </span>singer <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(voice.part) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mediana =</span> <span class="kw">median</span>(estatura.m),
         <span class="dt">media =</span> <span class="kw">mean</span>(estatura.m))

<span class="kw">library</span>(forcats)
singer.medians<span class="op">$</span>voice.part.<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">fct_reorder</span>(<span class="dt">.f =</span> singer.medians<span class="op">$</span>voice.part, <span class="dt">.x =</span> singer.medians<span class="op">$</span>mediana, <span class="dt">.fun =</span> median)

<span class="kw">ggplot</span>(singer.medians, <span class="kw">aes</span>(<span class="dt">x =</span> voice.part.<span class="dv">2</span>, <span class="dt">y =</span> estatura.m)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">height =</span> <span class="fl">0.8</span>, <span class="dt">width =</span> <span class="fl">0.3</span>), 
    <span class="dt">color =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> media), <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">coord_flip</span>()</code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-12-1.png" width="70%" style="display: block; margin: auto;" /></p>
<hr />
<p><br></p>
<p>Consideramos las siguientes mediciones de ozono en el aire, producidas por la red automática de monitoreo ambiental (<a href="http://www.aire.df.gob.mx/default.php?opc=&#39;aKBhnmI=&#39;&amp;opcion=Zg==">SIMA</a>). Las mediciones son concentración de ozono (en ppb o partes por billón) para las estaciones de Tlalnepantla e Iztapalapa, tomadas a las 2 pm, durante 2014.</p>
<p><strong>Una exposición de 110 ppb durante una hora se considera aguda.</strong></p>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-13-1.png" width="70%" style="display: block; margin: auto;" /></p>
<img src="figuras/manicule2.jpg" />
<div class="centered">
<p class="espacio">
</p>
<p>La distribución de ozono (en cualquier estación) es…</p>
<ol style="list-style-type: lower-alpha">
<li><p>Simétrica.</p></li>
<li><p>Tiene sesgo a la derecha.</p></li>
<li><p>Tiene sesgo a la izquierda.</p></li>
</ol>
<p class="espacio3">
</p>
</div>
<p><br></p>
<hr />
<p><br></p>
</div>
</div>
<div id="graficas-de-cuantiles-teoricos" class="section level2">
<h2><span class="header-section-number">4.5</span> Gráficas de cuantiles teóricos</h2>

<div class="nota">
Supongamos que <span class="math inline">\(G\)</span> es la función de distribución de una variable aleatoria continua, tal que <span class="math inline">\(G\)</span> es diferenciable y tiene derivada positiva (por ejemplo, si la variable aleatoria tiene densidad positiva y continua en todos los reales). Entonces podemos construir la función <span class="math inline">\(q:(0,1) \to (\infty, \infty)\)</span> dada por: <span class="math display">\[q(f)=G^{-1}(f)\]</span> para cualquier <span class="math inline">\(f \in (0,1)\)</span>. Decimos que <span class="math inline">\(q\)</span> es la <strong>función de cuantiles</strong> de la variable aleatoria con distribución <span class="math inline">\(G\)</span>. Bajo esta definición, es claro que si <span class="math inline">\(X\)</span> tiene distribución <span class="math inline">\(G\)</span>, entonces <span class="math inline">\(P(X&lt;q(f))=G(q(f))=f\)</span>.
</div>

<div id="ejemplo-normal" class="section level3 unnumbered">
<h3>Ejemplo: normal</h3>
<p>Abajo vemos cómo se ve la gráfica de cuantiles de una variable aleatoria normal estándar. A esta función la denotamos como <span class="math inline">\(q_{0,1}(f)\)</span>, y en general, a la función de cuantiles de una distribución <span class="math inline">\(Normal(\mu, \sigma^2)\)</span> la denotamos por <span class="math inline">\(q_{\mu, \sigma}(f)\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="dv">0</span>), <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> qnorm) <span class="op">+</span><span class="st"> </span><span class="kw">xlim</span>(<span class="fl">0.001</span>,<span class="fl">0.999</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Cuantil (f)&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&#39;q&#39;</span>)</code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-15-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Notemos que <span class="math inline">\(q_{\mu, \sigma}(f) \to \infty\)</span> cunado <span class="math inline">\(f \to 1\)</span>, y el cuantil <span class="math inline">\(1\)</span> no esta definido. Análogamente el cuantil <span class="math inline">\(0\)</span> tampoco está definido.</p>
<p class="espacio">
</p>
<img src="figuras/manicule2.jpg" />
<div class="centered">
<p class="espacio">
</p>
<p>¿Cómo se ve la gráfica de cuantiles de una variable aleatoria uniforme?</p>
<ol style="list-style-type: lower-alpha">
<li><p>Similar al caso normal (una curva).</p></li>
<li><p>Como una recta horizontal.</p></li>
<li><p>Como una recta vertical.</p></li>
<li><p>Como una diagonal.</p></li>
</ol>
<p class="espacio3">
</p>
</div>
<p><br></p>
</div>
</div>
<div id="graficas-de-cuantiles-para-un-conjunto-de-datos" class="section level2">
<h2><span class="header-section-number">4.6</span> Gráficas de cuantiles para un conjunto de datos</h2>
<p>Hay varias maneras razonables de definir los cuantiles de un conjunto de datos, (ver Hyndman y Fan 1996 para una resumen de lo que usan los paquetes estadísticos). Nosotros adoptamos la siguiente construcción:</p>
<p class="espacio3">
</p>

<div class="nota">
<strong>Cuantiles de un conjunto de datos.</strong> Si <span class="math inline">\(x_1,...,x_n\)</span> es el conjunto de datos, los ordenamos de manera creciente para obtener <span class="math inline">\(x_{(1)},...,x_{(n)}\)</span>, donde <span class="math inline">\(x_{(1)}\)</span> es la observación más chica y <span class="math inline">\(x_{(n)}\)</span> la más grande. Definimos <span class="math display">\[f_i=\frac{i-0.5}{n}\]</span> y decimos que <span class="math inline">\(x_{(i)}\)</span> es el cuantil <span class="math inline">\(f_i\)</span>. Si se deseara calcular otros cuantiles <span class="math inline">\(f\)</span>, se podría interpolar o extrapolar con los puntos <span class="math inline">\(x_{(1)},...,x_{(n)}\)</span> y <span class="math inline">\(f_1,...,f_n\)</span>, pero esto no tiene tanto sentido.
</div>

<p class="espacio">
</p>
<p>Podemos hacer gráficas de la función de cuantiles de manera fácil. Estas gráficas se hacen, aproximadamente, como sigue: se ordenan los datos del más chico al más grande, se enumeran como índice, y graficamos los pares resultantes con el índice en el eje horizontal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(reshape2) <span class="co"># aquí están los datos de propinas</span>
n &lt;-<span class="st"> </span><span class="kw">length</span>(tips<span class="op">$</span>total_bill)
tips<span class="op">$</span>probs &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span>n <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span>n
tips<span class="op">$</span>cuantiles &lt;-<span class="st"> </span><span class="kw">quantile</span>(tips<span class="op">$</span>total_bill, <span class="dt">probs =</span> tips<span class="op">$</span>probs, <span class="dt">type =</span> <span class="dv">5</span>) 
<span class="kw">ggplot</span>(tips, <span class="kw">aes</span>(<span class="dt">x=</span>probs, <span class="dt">y =</span> cuantiles)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Cuantil (f)&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Dólares&#39;) + </span>
<span class="st">  geom_point()</span></code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-17-1.png" width="70%" style="display: block; margin: auto;" /></p>
<div id="que-buscar-en-una-grafica-de-cuantiles" class="section level3">
<h3><span class="header-section-number">4.6.1</span> ¿Qué buscar en una gráfica de cuantiles?</h3>
<p>Las gráficas de cuantiles son conceptualmente simples; sin embargo, su interpretación efectiva requiere práctica. Algunas guías son:</p>
<ol style="list-style-type: decimal">
<li><p>Podemos leer fácilmente la mediana y los cuartos.</p></li>
<li><p>Regiones en la escala de medición de los datos (dimensión vertical) con densidades de datos más altas se ven como pendientes bajas en la gráfica. Mientras que pendientes altas indican densidades de datos relativamente más bajas.</p></li>
<li><p>Una mayor pendiente en la forma general de la gráfica (por ejemplo, en la recta que une los cuartos) indica dispersiones más grandes.</p></li>
<li><p>Si el conjunto de datos se distribuye aproximadamente uniforme, entonces la gráfica debe parecerse a una recta (diagonal).</p></li>
<li><p>De manera más general: en las regiones donde el histograma crece conforme aumentan los valores en el conjunto de datos, la pendiente de la gráfica de cuantiles es decreciente (así que la gráfica de cuantiles es cóncava hacia abajo). Cuando el histograma decrece conforme aumentan los valores en el conjunto de datos, la pendiente de la gráfica de cuantiles es creciente (así que observamos concavidad hacia arriba).</p></li>
<li><p>Si la distribución tiene más dispersión hacia la derecha, la figura general de la gráfica es cóncava hacia arriba. Si tiene más dispersión a la izquierda, es cóncava hacia abajo.</p></li>
<li><p>¿Cómo se ve una distribución que parece tener grupos definidos donde se acumulan los datos?</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">num_sim &lt;-<span class="st"> </span><span class="dv">300</span>
grupos &lt;-<span class="st"> </span><span class="kw">data.frame</span>(
  <span class="dt">gpo =</span> <span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">size =</span> <span class="dv">300</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>)))
grupos<span class="op">$</span>x &lt;-<span class="st"> </span><span class="kw">ifelse</span>(grupos<span class="op">$</span>gpo <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="kw">rnorm</span>(num_sim, <span class="dt">mean =</span> <span class="dv">0</span>), 
  <span class="kw">ifelse</span>(grupos<span class="op">$</span>gpo <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, <span class="kw">rnorm</span>(num_sim, <span class="dv">10</span>, <span class="dv">2</span>), <span class="kw">rnorm</span>(num_sim, <span class="dt">mean =</span> <span class="dv">20</span>, <span class="dv">2</span>)))
<span class="kw">hist</span>(grupos<span class="op">$</span>x)
n &lt;-<span class="st"> </span><span class="kw">length</span>(grupos<span class="op">$</span>x)
grupos<span class="op">$</span>probs &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">:</span>n <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>) <span class="op">/</span><span class="st"> </span>n
grupos<span class="op">$</span>cuantiles &lt;-<span class="st"> </span><span class="kw">quantile</span>(grupos<span class="op">$</span>x, <span class="dt">probs =</span> grupos<span class="op">$</span>probs, <span class="dt">type =</span> <span class="dv">5</span>) 
<span class="kw">ggplot</span>(grupos, <span class="kw">aes</span>(<span class="dt">x=</span>probs, <span class="dt">y =</span> cuantiles)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Cuantil (f)&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Dólares&#39;) + </span>
<span class="st">  geom_point()</span></code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-18-1.png" width="70%" style="display: block; margin: auto;" /><img src="04-tlc_files/figure-html/unnamed-chunk-18-2.png" width="70%" style="display: block; margin: auto;" /></p>
<p class="espacio">
</p>
<hr />
<p><br></p>
</div>
</div>
<div id="graficas-qq-normales" class="section level2">
<h2><span class="header-section-number">4.7</span> Gráficas qq-normales</h2>
<p>En las secciones anteriores hemos usado gráficas de cuantiles para graficar cuantiles de un conjunto de datos y cuantiles teóricos dada una función de distribución. También es posible hacer gráficas de conjuntos de datos contra cuantiles teóricos de una distribución, de manera que podamos visualizar el grado de concordancia entre estas dos.</p>
<p>La más popular de estas gráficas son las <em>cuantil-cuantil normales</em> (<em>q-q normales</em>). Una manera de hacer estas gráficas para el conjunto de datos <span class="math inline">\(x_1,...,x_n\)</span> es calcular:</p>
<p><span class="math display">\[\bar{x}=\frac{1}{n}\sum_{i=1}^n x_i, s=\sqrt{\frac{1}{n-1}\sum_{i=1}^n(x_i-\mu)^2}\]</span></p>
<p>y calcular los cuantiles <span class="math inline">\(q_{\bar{x},s}(f)\)</span> de la distribución <span class="math inline">\(Normal(\bar{x},s)\)</span>. Entonces calculamos <span class="math inline">\(q_{\bar{x},s}(f)\)</span> donde <span class="math inline">\(f_1,f_2,...,f_n\)</span> son los cuantiles de los datos y graficamos <span class="math inline">\((x_{i},q_{\bar{x},s}(f_i))\)</span>. Si los puntos no se desvían mucho de la recta <span class="math inline">\(x=y\)</span>, entonces el conjunto de datos se distribuye, aproximadamente, de manera normal. Las desviaciones de la recta se interpretan como arriba hicimos con la gráfica cuantil cuantil.</p>
<p>Cuando queremos evaluar si la forma de la distribución de los datos es cercana a la normal, no es necesario calcular <span class="math inline">\(\bar{x}\)</span> y <span class="math inline">\(s\)</span>, pues para cualquier <span class="math inline">\(\mu\)</span> y <span class="math inline">\(\sigma\)</span> tenemos que:</p>
<p><span class="math display">\[q_{\mu, \sigma}(f) = \sigma q_{0,1}(f)+\mu,\]</span></p>
<p>lo que implica que si graficamos los cuantiles <span class="math inline">\(q_{0,1}(f_i)\)</span> contra los del conjunto de datos, los datos se distribuyen aproximadamente normal cuando están dispuestos cerca de una recta.</p>
<p class="espacio3">
</p>

<div class="nota">
<strong>Construcción de una gráfica normal de cuantiles.</strong> Si los datos ordenados están dados por <span class="math inline">\(x_{1},x_{2},...,x_{n}\)</span>, con valores <span class="math inline">\(f\)</span> correspondientes <span class="math inline">\(f_1,f_2,...,f_n\)</span>, entonces graficamos los puntos <span class="math inline">\((q_{0,1},x_{i})\)</span>.
</div>

<p class="espacio3">
</p>
<div id="ejemplo-cantantes" class="section level3 unnumbered">
<h3>Ejemplo: cantantes</h3>
<p>En estas gráficas podemos ver:</p>
<ol style="list-style-type: decimal">
<li><p>Cada conjunto de datos es razonablemente bien aproximado por una distribución normal. Muchas de las desviaciones que observamos se deben a redondeo.</p></li>
<li><p>Aunque las medianas varían de grupo a grupo, las pendientes no varían mucho, esto quiere decir que las dispersiones (por ejemplo, desviaciones estándar) son similares a lo largo de todos los grupos.</p></li>
<li><p>La variación en la dispersión de cada conjunto de datos no está asociado a la mediana de cada uno.</p></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(lattice)
<span class="kw">library</span>(dplyr)
<span class="co"># calculamos la estatura en centímetros</span>
singer<span class="op">$</span>estatura.m &lt;-<span class="st"> </span>singer<span class="op">$</span>height <span class="op">*</span><span class="st"> </span><span class="fl">2.54</span>

<span class="co"># calculamos el valor f dentro de cada grupo</span>
singer_ord &lt;-<span class="st"> </span><span class="kw">arrange</span>(<span class="kw">group_by</span>(singer, voice.part), estatura.m)
singer_cuant &lt;-<span class="st"> </span><span class="kw">mutate</span>(singer_ord, 
  <span class="dt">n =</span> <span class="kw">n</span>(), 
  <span class="dt">valor.f =</span> (<span class="dv">1</span><span class="op">:</span>n[<span class="dv">1</span>] <span class="op">-</span><span class="st"> </span><span class="fl">0.5</span>)<span class="op">/</span>n[<span class="dv">1</span>],
  <span class="dt">q.norm =</span> <span class="kw">qnorm</span>(valor.f)
  )

<span class="kw">ggplot</span>(singer_cuant, <span class="kw">aes</span>(<span class="dt">x =</span> q.norm, <span class="dt">y =</span> estatura.m)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>voice.part, <span class="dt">nrow =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-20-1.png" width="70%" style="display: block; margin: auto;" /></p>
<hr />
<p><br></p>
<p><br></p>
</div>
</div>
<div id="el-tlc-y-errores-estandar" class="section level2">
<h2><span class="header-section-number">4.8</span> El TLC y errores estándar</h2>
<p>En Noviembre del 2017 El Financiero <a href="http://www.elfinanciero.com.mx/nacional/reprueban-entidades-estados-en-atencion-a-diabetes-ssa.html">publicó</a> una noticia que afirmab que los estados de Oaxaca, Michoacán, Morelos y Tamaulipas tenían la peor atención a pacientes diabéticos.</p>
<p>El índice <a href="http://oment.uanl.mx/tablero-de-control-de-enfermedades/">ICAD</a> (Secretaría de Salud) mide el cuidado que se les da a los pacientes en las unidades de primer nivel, en todas sus jurisdicciones sanitarias. Además toma en cuenta tres aspectos principales: que se pueda retener al paciente, que se tenga acceso a pruebas diagnósticas y si tiene su diabetes controlada.</p>
<p>Se cuenta con datos del ICAD de Noviembre del 2016:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">icad &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;datos/icad.csv&quot;</span>)
icad <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">fecha</th>
<th align="right">cve_edo</th>
<th align="left">cve_clues</th>
<th align="left">nombre</th>
<th align="right">calificacion</th>
<th align="right">pac_act</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">20161125</td>
<td align="right">12</td>
<td align="left">GRSSA012004</td>
<td align="left">CSR EL POTRERILLO</td>
<td align="right">53.5</td>
<td align="right">33</td>
</tr>
<tr class="even">
<td align="right">20161125</td>
<td align="right">28</td>
<td align="left">TSSSA000034</td>
<td align="left">CSR GUÍA DEL PORVENIR</td>
<td align="right">68.6</td>
<td align="right">21</td>
</tr>
<tr class="odd">
<td align="right">20161125</td>
<td align="right">25</td>
<td align="left">SLSSA000806</td>
<td align="left">CULIACÁNCITO</td>
<td align="right">60.2</td>
<td align="right">35</td>
</tr>
<tr class="even">
<td align="right">20161125</td>
<td align="right">8</td>
<td align="left">CHSSA002356</td>
<td align="left">CS BENITO JUÁREZ</td>
<td align="right">45.3</td>
<td align="right">39</td>
</tr>
<tr class="odd">
<td align="right">20161125</td>
<td align="right">21</td>
<td align="left">PLSSA008563</td>
<td align="left">PLSSA008563</td>
<td align="right">68.4</td>
<td align="right">224</td>
</tr>
<tr class="even">
<td align="right">20161125</td>
<td align="right">30</td>
<td align="left">VZSSA016081</td>
<td align="left">FCO I MADERO</td>
<td align="right">51.4</td>
<td align="right">19</td>
</tr>
<tr class="odd">
<td align="right">20161125</td>
<td align="right">4</td>
<td align="left">CCSSA000346</td>
<td align="left">CS TIKINMUL</td>
<td align="right">57.8</td>
<td align="right">13</td>
</tr>
<tr class="even">
<td align="right">20161125</td>
<td align="right">15</td>
<td align="left">MCSSA000813</td>
<td align="left">S MARTÍN</td>
<td align="right">68.4</td>
<td align="right">24</td>
</tr>
<tr class="odd">
<td align="right">20161125</td>
<td align="right">15</td>
<td align="left">MCSSA009954</td>
<td align="left">S AGUSTÍN ATLAPULCO</td>
<td align="right">62.0</td>
<td align="right">63</td>
</tr>
<tr class="even">
<td align="right">20161125</td>
<td align="right">28</td>
<td align="left">TSSSA000256</td>
<td align="left">CSR FORTINES</td>
<td align="right">66.9</td>
<td align="right">34</td>
</tr>
</tbody>
</table>
<p>Cada unidad de salud o <em>CLUES</em> recibe una calificación <strong>promedio</strong> y tiene cierto número de pacientes diabéticos activos.</p>
<p>Un efecto interesante es que si vemos el promedio de calificación contra el número de pacientes activos vemos el siguiente fenómeno:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(icad, <span class="kw">aes</span>(<span class="dt">x=</span>pac_act, <span class="dt">y=</span>calificacion)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">width =</span> <span class="fl">0.1</span>, <span class="dt">height =</span> <span class="fl">0.1</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">400</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(icad<span class="op">$</span>calificacion), <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-22-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>La línea roja representa la media nacional de la calificación promedio de todas las unidades del país. Podemos ver que conforme aumenta el número de pacientes en el hospital las observaciones tienden a acercarse más a la media poblacional.</p>
<p>Podemos simular la media para diferentes tamaños de muestra y ver cómo se comporta la media para varios tamaños de muestra. En los datos del ICAD la media nacional es de 58.867:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">123456</span>)
sim_media_normal &lt;-<span class="st"> </span><span class="cf">function</span>(n){
  media &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">rnorm</span>(<span class="dt">n =</span> n, <span class="dt">mean =</span> <span class="fl">58.86661</span>, <span class="dt">sd =</span> <span class="fl">11.12385</span>))
  <span class="kw">tibble</span>(<span class="dt">n=</span>n, <span class="dt">media=</span>media)
}
sim_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">500</span>, <span class="dv">1000</span>, <span class="dt">replace =</span> T), sim_media_normal)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(sim_<span class="dv">1</span>, <span class="kw">aes</span>(<span class="dt">x =</span> n, <span class="dt">y =</span> media)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="kw">mean</span>(icad<span class="op">$</span>calificacion), <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>)</code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-24-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Nuevamente se observa un fenómeno similar. Este fenómeno del error estándar generalmente se observa en la práctica y una buena estrategia para el modelado sería considerar el número de observaciones (pacientes, alumnos, escuelas) utilizados para calcular la media.</p>
<p class="espacio">
</p>

<div class="comentario">
Alguien nos podría preguntar: ¿por qué debería el promedio acercarse a la media general cuando aumentamos el tamaño de la muestra?.
</div>

<p class="espacio">
</p>
<p>Debemos interpretar esta pregunta como preguntando por qué el error estándar de la media se reduce a medida que <span class="math inline">\(n\)</span> aumenta. El teorema del límite central muestra que (bajo ciertas condiciones, por supuesto) el error estándar debe hacer esto, y que la media se aproxima a una distribución normal. Pero la pregunta es ¿por qué?</p>
<p>La mejor justificación simple puede ser que hay más formas de obtener valores <em>medios</em> que valores extremos; por ejemplo, la media de un lanzamiento de un dado (distribución discreta uniforme en <span class="math inline">\(1, 2, ..., 6\)</span>) es <span class="math inline">\(3.5\)</span>.</p>
<ul>
<li><p>Con un dado, es igualmente probable que obtengas un “promedio” de 3 o de 1.</p></li>
<li><p>Pero con dos dados hay cinco formas de obtener un promedio de 3, y solo una forma de obtener un promedio de 1.</p></li>
<li><p>Hay 5 veces más probabilidades de obtener el valor que está más cerca de la media que el que está más lejos.</p></li>
</ul>
<p>Veamos esto con un ejercicio de simulación:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">110265</span>)
tira_dado &lt;-<span class="st"> </span><span class="cf">function</span>(i){
  res &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">6</span>, <span class="dt">size =</span> <span class="dv">1</span>)
  <span class="kw">tibble</span>(<span class="dt">lanzamiento=</span>i, <span class="dt">resultado=</span>res)
}</code></pre></div>
<p>Lanzamos el dado mil veces y calculamos el promedio en cada lanzamiento.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>, tira_dado) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">media =</span> <span class="kw">cummean</span>(resultado))
sim_<span class="dv">2</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">lanzamiento</th>
<th align="right">resultado</th>
<th align="right">media</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">3</td>
<td align="right">3.00</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2.50</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">5</td>
<td align="right">3.33</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">1</td>
<td align="right">2.75</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">5</td>
<td align="right">3.20</td>
</tr>
</tbody>
</table>
<p>Esto ocurre debido a la <strong>Ley de los Grandes Números</strong>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(sim_<span class="dv">2</span>, <span class="kw">aes</span>(<span class="dt">x =</span> lanzamiento, <span class="dt">y =</span> media)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="fl">3.5</span>, <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1000</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="fl">3.3</span>,<span class="fl">3.8</span>))</code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-28-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>La idea es ver como se aproxima la distribución muestral de la media (cuando las observaciones provienen de distintas distribuciones) a una Normal conforme aumenta el tamaño de muestra. Para esto, aproximamos la distribución muestral de la media usando simulación.</p>
<p>Vale la pena observar que hay distribuciones que requieren un mayor tamaño de muestra <span class="math inline">\(n\)</span> para lograr una buena aproximación (por ejemplo la log-normal), ¿a qué se debe esto?</p>
<p>¿Por qué tanto énfasis en el TLC? El <strong>error estándar</strong> es la manera más común para describir la precisión de una estadística. En términos generales, esperamos que <span class="math inline">\(\bar{x}\)</span> este a una distancia de <span class="math inline">\(\mu_P\)</span> menor a un error estándar el 68% del tiempo, y a menos de 2 errores estándar el 95% del tiempo. Estos porcentajes están basados el teorema central del límite que nos dice que bajo ciertas condiciones (bastante generales) de <span class="math inline">\(P\)</span> la distribución de <span class="math inline">\(\bar{x}\)</span> se aproximará a una distribución normal: <span class="math display">\[\bar{x} \overset{\cdot}{\sim} N(\mu_P,\sigma_P^2/n)\]</span></p>
<hr />
<p>Con la siguiente aplicación podemos simular muestras de cualquier distribución y visualizar la distribución de <span class="math inline">\(\bar{X}\)</span>:</p>
<iframe src="https://andreuboada.shinyapps.io/tlc-shiny/?showcase=0" width="103%" height="800px">
</iframe>
<hr />
<p><br></p>
</div>
<div id="ejemplo-2" class="section level2">
<h2><span class="header-section-number">4.9</span> Ejemplo</h2>
<p>La corporación ALFA vende bicicletas. Basada en su experiencia siente que en los meses de verano es  probable que venda 0, 1, 2, 3 ó 4 bicicletas en un día (la firma nunca ha vendido más de 4 bicicletas por día).</p>
<p>Sea <span class="math inline">\(X\)</span> el número de bicicletas vendidas en un día. <span class="math inline">\(X\)</span> sigue una distribución uniforme y toma los valores <span class="math inline">\(-2,-1,0,1,2\)</span>, es decir, <span class="math display">\[
X=\left\{ \begin{array}{cl}
-2 &amp; \text{con probabilidad 1/5}\\
-1 &amp; \text{con probabilidad 1/5}\\
0 &amp; \text{con probabilidad 1/5}\\
1 &amp; \text{con probabilidad 1/5}\\
2 &amp; \text{con probabilidad 1/5.}
\end{array}\right.
\]</span></p>
<p>Suponga que el número de bicicletas vendidas el siguiente día es independiente del número vendido el día anterior. Sea <span class="math inline">\(S\)</span> el número de bicicletas vendidas en un periodo de <em>cinco días</em>.</p>
<p>Si <span class="math inline">\(X_1,X_2,\ldots,X_{5}\)</span> son variables aleatorias independientes con la misma distribución, entonces <span class="math display">\[
S = X_1 + X_2 + \cdots + X_{5}.
\]</span></p>
<p>Primero podemos definir el experimento como una función que reciba el número de realización del experimento y regrese el número de bicicletas vendidas en los 5 días:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100888</span>)
experimento &lt;-<span class="st"> </span><span class="cf">function</span>(k){
  <span class="kw">tibble</span>(<span class="dt">k =</span> k, <span class="dt">x =</span> <span class="kw">as.integer</span>(<span class="kw">sum</span>(<span class="kw">sample.int</span>(<span class="dv">5</span>,<span class="dv">5</span>,<span class="dt">replace=</span>T) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)))
}</code></pre></div>
<p>Podemos ver qué regresa la función en una realización del experimento:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">experimento</span>(<span class="dv">1</span>)
<span class="co">#&gt; # A tibble: 1 x 2</span>
<span class="co">#&gt;       k     x</span>
<span class="co">#&gt;   &lt;dbl&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1  1.00    12</span></code></pre></div>
<p>Ahora utilizamos la fución <code>map_df</code> del paquete <code>purrr</code> para obtener 1000 realizaciones del experimento en un data frame:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">1000</span>
df_bicis &lt;-<span class="st"> </span><span class="kw">map_df</span>(<span class="dt">.x =</span> <span class="dv">1</span><span class="op">:</span>m, <span class="dt">.f =</span> experimento)
df_bicis <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">10</span>) <span class="op">%&gt;%</span><span class="st"> </span>knitr<span class="op">::</span><span class="kw">kable</span>()</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">k</th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">16</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">11</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">14</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">6</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">9</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">11</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="right">7</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="right">12</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">13</td>
</tr>
</tbody>
</table>
<p>Calculamos la tabla y gráfica de frecuencias:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df_bicis_frec &lt;-<span class="st"> </span>df_bicis <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(x) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">p_x =</span> <span class="kw">n</span>()<span class="op">/</span>m)
<span class="kw">ggplot</span>(df_bicis_frec, <span class="kw">aes</span>(<span class="dt">x =</span> x)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">y =</span> p_x), <span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">stat=</span><span class="st">&#39;identity&#39;</span>,<span class="kw">aes</span>(<span class="dt">y=</span>p_x,<span class="dt">label=</span><span class="kw">round</span>(p_x,<span class="dv">4</span>)),<span class="dt">vjust=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">size=</span><span class="fl">2.5</span>)</code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-33-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si comparamos con los valores que toma una distribución normal con la misma media y la misma desviación estándar vemos que las probabilidades son muy similares. Es un resultado del Teorema del Límite Central que la suma de variables uniformes independientes sigue una distribución normal. De cualquier forma es interesante cómo la suma de sólo 5 uniformes independientes da como resultado una distribución que se asemeja a la de una normal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">media_bicis &lt;-<span class="st"> </span><span class="kw">mean</span>(df_bicis<span class="op">$</span>x)
sd_bicis &lt;-<span class="st"> </span><span class="kw">sd</span>(df_bicis<span class="op">$</span>x)
<span class="kw">dnorm</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">20</span>, <span class="dt">mean =</span> media_bicis, <span class="dt">sd =</span> sd_bicis)
<span class="co">#&gt;  [1] 0.000933 0.002325 0.005270 0.010868 0.020393 0.034816 0.054083</span>
<span class="co">#&gt;  [8] 0.076440 0.098302 0.115022 0.122455 0.118619 0.104546 0.083838</span>
<span class="co">#&gt; [15] 0.061172 0.040611 0.024531 0.013482 0.006742 0.003068 0.001270</span></code></pre></div>
</div>
<div id="tarea-3" class="section level2">
<h2><span class="header-section-number">4.10</span> Tarea</h2>
<ol style="list-style-type: decimal">
<li>La Evaluación Nacional de Logros Académicos en Centros Escolares (ENLACE), es un examen que se pretende realizar cada año en México por la Secretaria de Educación Pública (SEP) a todas las escuelas públicas y privadas de nivel básico; para conocer el nivel de desempeño en las materias de español y matemáticas. Han existido importantes resistencias a la aplicación de este examen y opiniones de intelectuales respecto de las fallas que esta tiene.</li>
</ol>
<p>En este enlace la SEP publicó los resultados de la prueba ENLACE para todas las escuelas de los 32 estados de México: <a href="http://www.enlace.sep.gob.mx/content/ba/pages/base_de_datos_completa_2013/" class="uri">http://www.enlace.sep.gob.mx/content/ba/pages/base_de_datos_completa_2013/</a></p>
<ol style="list-style-type: lower-alpha">
<li><p>Descarga los datos para todas las localidades y cárgalos en R utilizando la función <code>map_df</code> del paquete <code>purrr</code>.</p></li>
<li><p>Explica si los datos cumplen los principios de datos limpios.</p></li>
<li><p>Haz la limpieza necesaria que requieran los datos.</p></li>
<li><p>Agrega los datos a nivel municipio para calcular el número de alumnos en cada grado y su promedio de puntos en español y matemáticas.</p></li>
<li><p>Haz una gráfica en la cual cada punto represente un municipio y en el eje <span class="math inline">\(x\)</span> se muestre el número de alumnos que presentaron el examen y en el eje <span class="math inline">\(y\)</span> el promedio de puntos en matemáticas.</p></li>
</ol>
<ol start="2" style="list-style-type: decimal">
<li>La siguiente función de R sirve para generar una gráfica de la función de masa de probabilidad de una variable aleatoria <span class="math inline">\(\mbox{Binomial}(n,p)\)</span>.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">genera_binoms &lt;-<span class="st"> </span><span class="cf">function</span>(p, n) {
  datos &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">x =</span> <span class="dv">0</span><span class="op">:</span>n, <span class="dt">y =</span> <span class="kw">dbinom</span>(x, n, p))
  media &lt;-<span class="st"> </span>n<span class="op">*</span>p
  sd &lt;-<span class="st"> </span><span class="kw">sqrt</span>(n<span class="op">*</span>p<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>p))
  ls &lt;-<span class="st"> </span>media <span class="op">+</span><span class="st"> </span><span class="dv">4</span><span class="op">*</span>sd
  li &lt;-<span class="st"> </span>media <span class="op">-</span><span class="st"> </span><span class="dv">4</span><span class="op">*</span>sd
  lse &lt;-<span class="st"> </span><span class="kw">as.integer</span>(ls)
  lie &lt;-<span class="st"> </span><span class="kw">as.integer</span>(li) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
  datos <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(x <span class="op">&lt;</span><span class="st"> </span>ls <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&gt;</span><span class="st"> </span>li) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(x, y)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span><span class="dv">0</span>,<span class="dt">xend=</span>x,<span class="dt">yend=</span>y), <span class="dt">color =</span> <span class="st">&#39;red&#39;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="st">&#39;k&#39;</span>,<span class="dt">breaks=</span>lie<span class="op">:</span>lse) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="st">&#39;p(k)&#39;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">y=</span>y,<span class="dt">label=</span><span class="kw">round</span>(y,<span class="dv">3</span>)),<span class="dt">stat =</span> <span class="st">&#39;identity&#39;</span>,<span class="dt">vjust=</span><span class="op">-</span><span class="dv">1</span>,<span class="dt">size=</span><span class="dv">3</span>)
}</code></pre></div>
<p>Por ejemplo, con <span class="math inline">\(p=1/3\)</span> y <span class="math inline">\(n=10\)</span> realizaciones, la gráfica se ve así:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">genera_binoms</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">3</span>, <span class="dv">10</span>)</code></pre></div>
<p><img src="04-tlc_files/figure-html/unnamed-chunk-36-1.png" width="70%" style="display: block; margin: auto;" /></p>
<p>Utiliza la función para determinar a partir de qué valor de <span class="math inline">\(n\)</span> la distribución de una variable Binomial con probabilidad de éxito <span class="math inline">\(p=1/100\)</span> se asemeja a la de una normal.</p>
<ol start="3" style="list-style-type: decimal">
<li>Regresando al ejemplo de la venta de bicicletas:</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li><p>Utiliza la función de <code>experimento</code> y la función <code>map_df</code> para obtener una simulación de 100 realizaciones del experimento. Haz una gráfica de cuantiles vs cuantiles normales y decide si el conjunto de datos está bien aproximado por una distribución normal.</p></li>
<li><p>Calcula la distribución de probabilidades del número de bicicletas vendidas en un periodo de <em>cinco días</em>. Para calcular <span class="math inline">\(p(k) = P(S=k)\)</span> considera que deberás contar el número de soluciones de la ecuación <span class="math display">\[
x_1 + x_2 + \cdots + x_5 = k,
\]</span> donde <span class="math inline">\(0 \leq x_i \leq 4\)</span>. El número de soluciones enteras es equivalente al coeficiente del término <span class="math inline">\(y^k\)</span> del polinomio <span class="math inline">\((1+y+\cdots+y^4)^5\)</span> porque cada factor del producto representa el número de bicicletas vendidas por día. Compara las probabilidades calculadas con los valores de la distribución normal obtenidos anteriormente.</p></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="manipulacion-y-visualizacion-de-datos.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analisis-de-datos-categoricos.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
